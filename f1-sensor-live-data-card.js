// Custom F1 Tyres Statistics card for Home Assistant
const getLit = async () => {
  if (window.LitElement && window.litHtml) {
    return {
      LitElement: window.LitElement,
      html: window.litHtml.html,
      css: window.litHtml.css,
    };
  }
  return import('https://unpkg.com/lit@3.1.0?module');
};

const { LitElement, html, css } = await getLit();

let f1FontsInjected = false;
const ensureF1Fonts = () => {
  if (f1FontsInjected || document.querySelector('style[data-f1-fonts]')) {
    f1FontsInjected = true;
    return;
  }
  const style = document.createElement('style');
  style.setAttribute('data-f1-fonts', 'true');
  style.textContent = `
    @font-face {
      font-family: 'Formula1 Display';
      src: url(data:font/woff2;base64,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) format('woff2');
      font-weight: 400;
      font-style: normal;
      font-display: swap;
    }
    @font-face {
      font-family: 'Formula1 Display';
      src: url(data:font/woff2;base64,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) format('woff2');
      font-weight: 700;
      font-style: normal;
      font-display: swap;
    }
    @font-face {
      font-family: 'Formula1 Wide';
      src: url(data:font/woff2;base64,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) format('woff2');
      font-weight: 600;
      font-style: normal;
      font-display: swap;
    }
  `;
  document.head.appendChild(style);
  f1FontsInjected = true;
};

const DEFAULT_COMPOUNDS = ['SOFT', 'MEDIUM', 'HARD'];
const WET_COMPOUNDS = ['INTERMEDIATE', 'WET'];
const COMPOUND_FALLBACK = {
  SOFT: '#ff3b30',
  MEDIUM: '#ffd60a',
  HARD: '#e5e5e5',
  INTERMEDIATE: '#34c759',
  WET: '#0a84ff',
};
const COMPOUND_IMAGES = {
  HARD: new URL('./hard_tyre.png', import.meta.url).href,
  SOFT: new URL('./soft_tyre.png', import.meta.url).href,
  MEDIUM: new URL('./medium_tyre.png', import.meta.url).href,
  INTERMEDIATE: new URL('./intermediate_tyre.png', import.meta.url).href,
  WET: new URL('./wet_tyre.png', import.meta.url).href,
};

const TEAM_LOGO_URLS = {
  Alpine: 'https://media.formula1.com/image/upload/c_lfill,w_48/q_auto/v1740000000/common/f1/2025/alpine/2025alpinelogowhite.webp',
  'Aston Martin': 'https://media.formula1.com/image/upload/c_lfill,w_48/q_auto/v1740000000/common/f1/2025/astonmartin/2025astonmartinlogowhite.webp',
  Audi: 'https://media.formula1.com/image/upload/c_lfill,w_48/q_auto/v1740000000/common/f1/2026/audi/2026audilogowhite.webp',
  Cadillac: 'https://media.formula1.com/image/upload/c_lfill,w_48/q_auto/v1740000000/common/f1/2026/cadillac/2026cadillaclogowhite.webp',
  Ferrari: 'https://media.formula1.com/image/upload/c_lfill,w_48/q_auto/v1740000000/common/f1/2025/ferrari/2025ferrarilogolight.webp',
  Haas: 'https://media.formula1.com/image/upload/c_lfill,w_48/q_auto/v1740000000/common/f1/2025/haas/2025haaslogowhite.webp',
  'Kick Sauber': 'https://media.formula1.com/image/upload/c_fit,h_64/q_auto/v1740000000/common/f1/2025/kicksauber/2025kicksauberlogowhite.webp',
  McLaren: 'https://media.formula1.com/image/upload/c_lfill,w_48/q_auto/v1740000000/common/f1/2025/mclaren/2025mclarenlogowhite.webp',
  Mercedes: 'https://media.formula1.com/image/upload/c_lfill,w_48/q_auto/v1740000000/common/f1/2025/mercedes/2025mercedeslogowhite.webp',
  'Racing Bulls': 'https://media.formula1.com/image/upload/c_lfill,w_48/q_auto/v1740000000/common/f1/2025/racingbulls/2025racingbullslogowhite.webp',
  'Red Bull Racing': 'https://media.formula1.com/image/upload/c_lfill,w_48/q_auto/v1740000000/common/f1/2025/redbullracing/2025redbullracinglogowhite.webp',
  Williams: 'https://media.formula1.com/image/upload/c_lfill,w_48/q_auto/v1740000000/common/f1/2025/williams/2025williamslogowhite.webp',
};

const TEAM_LOGO_ALIASES = {
  alpine: 'Alpine',
  'aston martin': 'Aston Martin',
  astonmartin: 'Aston Martin',
  audi: 'Audi',
  cadillac: 'Cadillac',
  ferrari: 'Ferrari',
  haas: 'Haas',
  mclaren: 'McLaren',
  mercedes: 'Mercedes',
  'mercedes-amg': 'Mercedes',
  'mercedes amg': 'Mercedes',
  'mercedes-amg petronas': 'Mercedes',
  'mercedes amg petronas': 'Mercedes',
  'mercedes-amg petronas f1 team': 'Mercedes',
  'mercedes amg petronas f1 team': 'Mercedes',
  'racing bulls': 'Racing Bulls',
  'visa cash app rb': 'Racing Bulls',
  'visa cash app rb f1 team': 'Racing Bulls',
  'rb f1 team': 'Racing Bulls',
  'rb': 'Racing Bulls',
  'kick sauber': 'Kick Sauber',
  'stake f1 team kick sauber': 'Kick Sauber',
  sauber: 'Kick Sauber',
  'red bull racing': 'Red Bull Racing',
  'red bull': 'Red Bull Racing',
  'oracle red bull racing': 'Red Bull Racing',
  'red bull racing honda': 'Red Bull Racing',
  'red bull racing honda rbpt': 'Red Bull Racing',
  'scuderia ferrari': 'Ferrari',
  'scuderia ferrari hp': 'Ferrari',
  'mclaren f1 team': 'McLaren',
  'aston martin aramco': 'Aston Martin',
  'aston martin aramco f1 team': 'Aston Martin',
  'bwt alpine f1 team': 'Alpine',
  'alpine f1 team': 'Alpine',
  'williams racing': 'Williams',
  'haas f1 team': 'Haas',
  'stake': 'Kick Sauber',
  'stake f1 team': 'Kick Sauber',
  'alphatauri': 'Racing Bulls',
  'scuderia alphatauri': 'Racing Bulls',
  'toro rosso': 'Racing Bulls',
  'alfa romeo': 'Kick Sauber',
  'alfa romeo f1 team': 'Kick Sauber',
  'renault': 'Alpine',
  'renault f1 team': 'Alpine',
  'force india': 'Aston Martin',
  'racing point': 'Aston Martin',
  williams: 'Williams',
};

const TEAM_LOGO_FORCE_WHITE = new Set(['Mercedes', 'Aston Martin', 'Audi', 'Cadillac']);

const toColorLogoUrl = (url) => {
  if (!url) return null;
  if (url.includes('logowhite')) return url.replace('logowhite', 'logo');
  if (url.includes('logolight')) return url.replace('logolight', 'logo');
  return url;
};

const normalizeTeamName = (team) => {
  if (!team) return null;
  const cleaned = String(team).toLowerCase().replace(/\s+/g, ' ').trim();
  if (TEAM_LOGO_ALIASES[cleaned]) return TEAM_LOGO_ALIASES[cleaned];
  const stripped = cleaned.replace(/[^a-z0-9 ]/g, '').trim();
  return TEAM_LOGO_ALIASES[stripped] || null;
};

const getTeamLogoUrl = (team, size = 28, variant = 'white') => {
  const key = normalizeTeamName(team);
  if (!key) return null;
  const base = TEAM_LOGO_URLS[key];
  if (!base) return null;
  const url = variant === 'color' ? toColorLogoUrl(base) : base;
  if (/w_\d+/.test(url)) {
    return url.replace(/w_\d+/, `w_${size}`);
  }
  if (/h_\d+/.test(url)) {
    return url.replace(/h_\d+/, `h_${Math.round(size * 1.2)}`);
  }
  return url;
};

const getTeamLogoMeta = (team, size = 28, style = 'color') => {
  const key = normalizeTeamName(team);
  const whiteUrl = getTeamLogoUrl(team, size, 'white');
  if (!whiteUrl) return null;
  if (style === 'white' || (key && TEAM_LOGO_FORCE_WHITE.has(key))) {
    return { src: whiteUrl, fallback: null };
  }
  const colorUrl = getTeamLogoUrl(team, size, 'color');
  if (colorUrl && colorUrl !== whiteUrl) {
    return { src: colorUrl, fallback: whiteUrl };
  }
  return { src: whiteUrl, fallback: null };
};

const handleTeamLogoError = (ev) => {
  const img = ev.target;
  if (!img || !img.dataset) return;
  const fallback = img.dataset.fallback;
  if (fallback && img.src !== fallback) {
    img.src = fallback;
    return;
  }
  img.style.display = 'none';
};
const DELTA_PILL = {
  HARD: 'linear-gradient(135deg, #6b1b6b, #32133e)',
  SOFT: 'linear-gradient(135deg, #1c7c2f, #0e3b1c)',
  MEDIUM: 'linear-gradient(135deg, #9a4a12, #4a2207)',
  INTERMEDIATE: 'linear-gradient(135deg, #1c7c2f, #0e3b1c)',
  WET: 'linear-gradient(135deg, #1f3a8a, #0b1e4a)',
};

const TRACK_STATUS_COLORS = {
  CLEAR: '#34c759',
  YELLOW: '#ffd60a',
  VSC: '#ff9500',
  SC: '#ff9500',
  RED: '#ff3b30',
};

const TRACK_STATUS_LABELS = {
  CLEAR: 'Track Clear',
  YELLOW: 'Yellow Flag',
  VSC: 'Virtual SC',
  SC: 'Safety Car',
  RED: 'Red Flag',
};

const F1_COUNTRY_CODES = {
  'Bahrain': 'bh', 'Saudi Arabia': 'sa', 'Australia': 'au',
  'Japan': 'jp', 'China': 'cn', 'USA': 'us', 'Monaco': 'mc',
  'Canada': 'ca', 'Spain': 'es', 'Austria': 'at', 'UK': 'gb',
  'Hungary': 'hu', 'Belgium': 'be', 'Netherlands': 'nl',
  'Italy': 'it', 'Azerbaijan': 'az', 'Singapore': 'sg',
  'Mexico': 'mx', 'Brazil': 'br', 'Qatar': 'qa', 'UAE': 'ae',
  'United States': 'us', 'United Arab Emirates': 'ae',
  'United Kingdom': 'gb', 'Great Britain': 'gb',
};

const RC_CATEGORY_ICONS = {
  SAFETYCAR: 'M21,6H3A1,1 0 0,0 2,7V17A1,1 0 0,0 3,18H21A1,1 0 0,0 22,17V7A1,1 0 0,0 21,6M5,16V8H7.5L9,10H6V14H9L7.5,16H5M12,16V14H14V16H12M14,13H12V11H14V13M14,10H12V8H14V10M19,16H16.5L15,14H18V10H15L16.5,8H19V16Z',
  VSC: 'M12,2L4,5V11.09C4,16.14 7.41,20.85 12,22C16.59,20.85 20,16.14 20,11.09V5L12,2M12,4.14L18,6.39V11.09C18,15.09 15.45,18.79 12,19.92V4.14Z',
  FLAG: 'M14.4,6L14,4H5V21H7V14H12.6L13,16H20V6H14.4Z',
  PENALTY: 'M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z',
  DEFAULT: 'M13,14H11V10H13M13,18H11V16H13M1,21H23L12,2L1,21Z',
};

class F1TyreStatisticsCard extends LitElement {
  static properties = {
    hass: {},
    config: {},
  };

  static styles = css`
    /* Animation keyframes */
    @keyframes fadeSlideIn {
      from { opacity: 0; transform: translateY(-8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    @keyframes glowPulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(var(--glow-color-rgb, 138, 43, 226), 0.4); }
      50% { box-shadow: 0 0 12px 2px rgba(var(--glow-color-rgb, 138, 43, 226), 0.6); }
    }

    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    :host {
      --ts-bg: #0b0b0d;
      --ts-bg-soft: #131315;
      --ts-border: rgba(255, 255, 255, 0.08);
      --ts-text: #f5f5f5;
      --ts-muted: rgba(255, 255, 255, 0.65);
      --ts-chip: rgba(255, 255, 255, 0.06);
      --ts-shadow: 0 16px 40px rgba(0, 0, 0, 0.35);
      display: block;
      font-family: 'Formula1 Display', 'Noto Sans', sans-serif;
    }

    ha-card {
      padding: 0;
      background: transparent;
      box-shadow: none;
      border: none;
    }

    .ts-card {
      position: relative;
      padding: clamp(12px, 2.2vw, 18px) clamp(12px, 2.2vw, 18px) clamp(12px, 2vw, 16px);
      border-radius: var(--ha-card-border-radius, 12px);
      background: radial-gradient(circle at 15% 10%, rgba(255, 255, 255, 0.08), transparent 45%),
        linear-gradient(160deg, var(--ts-bg) 0%, var(--ts-bg-soft) 60%, #0a0a0a 100%);
      border: 1px solid var(--ts-border);
      box-shadow: var(--ts-shadow);
      overflow: hidden;
      color: var(--ts-text);
      container-type: inline-size;
    }

    .ts-header {
      text-align: center;
      font-family: 'Formula1 Wide', 'Formula1 Display', 'Noto Sans', sans-serif;
      font-size: clamp(16px, 2.6vw, 22px);
      font-weight: 700;
      letter-spacing: clamp(0.03em, 0.06em, 0.08em);
      text-transform: uppercase;
      margin-bottom: clamp(6px, 1.2vw, 8px);
      text-shadow: 0 6px 16px rgba(0, 0, 0, 0.6);
      white-space: normal;
      text-wrap: balance;
      line-height: 1.1;
      padding: 0 4px;
    }

    .ts-columns {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: clamp(6px, 1.4vw, 12px);
    }

    .ts-compound {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      text-align: center;
    }

    .ts-tyre {
      width: clamp(54px, 18cqw, 110px);
      height: clamp(54px, 18cqw, 110px);
      max-width: 100%;
      display: grid;
      place-items: center;
      position: relative;
    }

    .ts-tyre::before {
      content: '';
      position: absolute;
      inset: clamp(6px, 1.2vw, 8px);
      border-radius: 50%;
      border: clamp(2px, 0.6cqw, 3px) solid color-mix(in srgb, var(--compound-color) 60%, #1a1a1a);
      box-shadow: 0 0 16px color-mix(in srgb, var(--compound-color) 50%, transparent);
    }

    .ts-tyre img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      filter: drop-shadow(0 6px 12px rgba(0, 0, 0, 0.5));
    }

    .ts-compound-name {
      font-family: 'Formula1 Display', 'Noto Sans', sans-serif;
      font-size: clamp(12px, 3.2cqw, 22px);
      font-weight: 700;
      letter-spacing: clamp(0.05em, 0.08em, 0.1em);
      text-transform: uppercase;
      color: var(--compound-color);
      margin-top: 2px;
      text-shadow: 0 6px 16px rgba(0, 0, 0, 0.6);
    }

    .ts-section-title {
      font-size: clamp(9px, 2.4cqw, 12px);
      text-transform: uppercase;
      letter-spacing: 0.12em;
      font-style: italic;
      color: var(--ts-text);
      margin-top: 6px;
    }

    .ts-times,
    .ts-stats {
      display: grid;
      gap: 6px;
      width: 100%;
    }

    .ts-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 6px 8px;
      border-radius: 10px;
      background: var(--ts-chip);
      font-size: clamp(9px, 2.2cqw, 12px);
      color: var(--ts-muted);
      animation: fadeSlideIn 0.2s ease-out backwards;
    }

    .ts-row:nth-child(1) { animation-delay: 0ms; }
    .ts-row:nth-child(2) { animation-delay: 50ms; }
    .ts-row:nth-child(3) { animation-delay: 100ms; }

    .ts-times .ts-row:first-child:not(.placeholder) {
      background: linear-gradient(90deg, rgba(138, 43, 226, 0.12), var(--ts-chip));
      border-left: 2px solid #8b5cf6;
    }

    .ts-row .ts-name {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-weight: 600;
      letter-spacing: 0.06em;
      color: var(--driver-color, var(--ts-text));
    }

    .ts-team-logo {
      width: 16px;
      height: 16px;
      object-fit: contain;
      filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.4));
    }

    .ts-row .ts-value {
      font-weight: 600;
      color: var(--ts-text);
    }

    .ts-row.placeholder {
      opacity: 0.55;
    }

    .ts-delta {
      position: relative;
      margin-top: 6px;
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      background: var(--delta-bg);
      color: #fff;
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.08);
      overflow: hidden;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .ts-delta::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: var(--delta-bar-width, 0%);
      background: rgba(255, 255, 255, 0.1);
      border-radius: inherit;
      transition: width 0.5s ease-out;
    }

    .ts-empty {
      padding: 16px;
      border-radius: var(--ha-card-border-radius, 12px);
      background: var(--ts-chip);
      border: 1px dashed rgba(255, 255, 255, 0.12);
      color: var(--ts-muted);
      text-align: center;
      font-size: 13px;
    }

    @media (max-width: 720px) {
      .ts-card {
        padding: 12px 10px 12px;
      }

      .ts-header {
        font-size: 16px;
        letter-spacing: 0.03em;
      }

      .ts-columns {
        gap: 8px;
      }
    }

    @container (max-width: 360px) {
      .ts-columns {
        gap: 6px;
      }

      .ts-section-title {
        letter-spacing: 0.08em;
      }

      .ts-row {
        padding: 5px 6px;
      }
    }
  `;

  setConfig(config) {
    this.config = {
      title: 'Tyres Statistics',
      show_header: true,
      show_best_times: true,
      show_stats: true,
      show_delta: true,
      show_tyre_image: true,
      show_compound_name: true,
      show_team_logo: false,
      team_logo_style: 'color',
      drivers_entity: 'sensor.f1_drivers_driver_list',
      max_best_times: 3,
      ...config,
    };
  }

  connectedCallback() {
    super.connectedCallback();
    ensureF1Fonts();
  }

  getCardSize() {
    return 4;
  }

  getGridOptions() {
    return {
      columns: 12,
      min_columns: 4,
      max_columns: 12,
      min_rows: 2,
    };
  }

  static getStubConfig() {
    return {
      type: 'custom:f1-sensor-live-data-card',
      entity: 'sensor.f1_drivers_tyre_statistics',
      drivers_entity: 'sensor.f1_drivers_driver_list',
      title: 'Tyres Statistics',
    };
  }

  static getConfigElement() {
    return document.createElement('f1-sensor-live-data-card-editor');
  }

  render() {
    if (!this.hass || !this.config) return html``;
    if (!this.config.entity) {
      return html`
        <ha-card>
          <div class="ts-card">
            <div class="ts-empty">Select an entity in the editor</div>
          </div>
        </ha-card>
      `;
    }

    const stateObj = this.hass.states?.[this.config.entity];
    if (!stateObj) {
      return html`
        <ha-card>
          <div class="ts-card">
            <div class="ts-empty">Entity not found</div>
          </div>
        </ha-card>
      `;
    }

    const attrs = stateObj.attributes || {};
    const compoundsRaw = attrs.compounds || {};
    const deltas = attrs.deltas || {};
    const fastestCompound = stateObj.state && stateObj.state !== 'unknown' && stateObj.state !== 'unavailable'
      ? stateObj.state
      : null;
    const teamLogoLookup = this._buildTeamLogoLookup();
    const startCompounds = this._normalizeCompounds(
      attrs.start_compounds ?? attrs.start_compunds,
    );
    const compounds = this._resolveCompounds(compoundsRaw, deltas, fastestCompound, startCompounds);

    return html`
      <ha-card @click=${this._handleCardAction}>
        <div class="ts-card">
          ${this.config.show_header
            ? html`<div class="ts-header">${this.config.title || 'Tyres Statistics'}</div>`
            : null}
          <div class="ts-columns">
            ${compounds.map((item) => this._renderCompound(item, deltas, fastestCompound, teamLogoLookup))}
          </div>
        </div>
      </ha-card>
    `;
  }

  _resolveCompounds(compoundsRaw, deltas, fastestCompound, startCompounds) {
    const list = [];
    const configCompounds = this._normalizeCompounds(this.config?.compounds);
    const baseCompounds = configCompounds.length > 0
      ? configCompounds
      : DEFAULT_COMPOUNDS;
    const seen = new Set();
    let baseIndex = 0;
    for (const name of baseCompounds) {
      const key = String(name || '').toUpperCase();
      if (!key || seen.has(key)) continue;
      seen.add(key);
      list.push({
        name: key,
        data: compoundsRaw?.[key] || {},
        index: baseIndex,
      });
      baseIndex += 1;
    }
    for (const wetName of WET_COMPOUNDS) {
      if (!list.find((item) => item.name === wetName) && this._hasCompoundData(compoundsRaw?.[wetName])) {
        list.push({
          name: wetName,
          data: compoundsRaw?.[wetName] || {},
          index: baseCompounds.length + list.length,
        });
      }
    }

    const sorted = this._sortCompounds(list, deltas, fastestCompound);
    const chosen = [];
    for (const wetName of WET_COMPOUNDS) {
      if (this._hasCompoundData(compoundsRaw?.[wetName])) {
        const match = sorted.find((item) => item.name === wetName);
        if (match && !chosen.includes(match)) chosen.push(match);
      }
    }
    for (const item of sorted) {
      if (chosen.length >= 3) break;
      if (!chosen.includes(item)) chosen.push(item);
    }
    if (chosen.length < 3) {
      for (const item of list) {
        if (chosen.length >= 3) break;
        if (!chosen.includes(item)) chosen.push(item);
      }
    }

    return this._sortCompounds(chosen, deltas, fastestCompound);
  }

  _normalizeCompounds(value) {
    if (Array.isArray(value) && value.length > 0) return value.map((v) => String(v).toUpperCase());
    if (typeof value === 'string') {
      const parsed = value
        .split(',')
        .map((v) => v.trim())
        .filter((v) => v.length > 0)
        .map((v) => v.toUpperCase());
      return parsed.length > 0 ? parsed : [];
    }
    return [];
  }

  _renderCompound(item, deltas, fastestCompound, teamLogoLookup) {
    const name = item.name;
    const displayName = this._compoundDisplayName(name);
    const data = item.data || {};
    const color = data.compound_color || COMPOUND_FALLBACK[name] || '#999';
    const image = COMPOUND_IMAGES[name];
    const bestTimes = this._bestTimes(data.best_times);
    const laps = Number(data.total_laps || 0);
    const sets = Number(data.sets_used_total ?? data.sets_used ?? 0);
    const deltaValue = this._formatDelta(deltas?.[name]);
    const isFastest = fastestCompound && String(fastestCompound).toUpperCase() === name;
    const deltaText = isFastest ? 'FASTEST' : deltaValue ? `+${deltaValue}` : '--';

    const deltaBarWidth = this._calculateDeltaBarWidth(isFastest, deltaValue);

    return html`
      <div class="ts-compound" style="--compound-color: ${color}; --delta-bg: ${DELTA_PILL[name] || DELTA_PILL.HARD};">
        ${this.config.show_tyre_image
          ? html`
              <div class="ts-tyre">
                ${image ? html`<img src="${image}" alt="${name} tyre" @error=${this._hideImage} />` : null}
              </div>
            `
          : null}
        ${this.config.show_compound_name
          ? html`<div class="ts-compound-name">${displayName}</div>`
          : null}

        ${this.config.show_best_times
          ? html`
              <div class="ts-section-title">Top Times</div>
              <div class="ts-times">
                ${this._renderBestTimes(bestTimes, teamLogoLookup)}
              </div>
            `
          : null}

        ${this.config.show_delta
          ? html`
              <div class="ts-section-title">Delta</div>
              <div class="ts-delta" style="--delta-bar-width: ${deltaBarWidth}%">${deltaText}</div>
            `
          : null}

        ${this.config.show_stats
          ? html`
              <div class="ts-section-title">Stats</div>
              <div class="ts-stats">
                <div class="ts-row">
                  <span class="ts-name">Laps Driven</span>
                  <span class="ts-value">${laps}</span>
                </div>
                <div class="ts-row">
                  <span class="ts-name">Sets Used</span>
                  <span class="ts-value">${sets}</span>
                </div>
              </div>
            `
          : null}
      </div>
    `;
  }

  _bestTimes(list) {
    if (!this.config.show_best_times) return [];
    const max = this.config.max_best_times || 3;
    const output = Array.isArray(list) ? list.slice(0, max) : [];
    while (output.length < max) {
      output.push({ driver_name: '--', time: '--:--.---', _placeholder: true });
    }
    return output;
  }

  _renderBestTimes(entries, teamLogoLookup) {
    if (!Array.isArray(entries) || entries.length === 0) return null;
    const base = Number(entries[0]?.time_secs);
    return entries.map((entry, index) => {
      const label = this._driverLabel(entry);
      const logo = this.config.show_team_logo ? this._getLogoForEntry(entry, teamLogoLookup) : null;
      let value = entry?.time || '--:--.---';
      if (index > 0) {
        if (entry?._placeholder) {
          value = '+--.---';
        } else if (Number.isFinite(base)) {
          const delta = Number(entry?.time_secs);
          value = Number.isFinite(delta) ? `+${(delta - base).toFixed(3)}` : '--';
        } else {
          value = '--';
        }
      }
      const color = this._normalizeColor(entry?.team_color) || 'var(--ts-text)';
      return html`
        <div class="ts-row ${entry?._placeholder ? 'placeholder' : ''}" style="--driver-color: ${color};">
          <span class="ts-name">
            ${logo ? html`
              <img
                class="ts-team-logo"
                src="${logo.src}"
                data-fallback="${logo.fallback || ''}"
                loading="lazy"
                @error=${handleTeamLogoError}
                alt=""
              />
            ` : null}
            ${label}
          </span>
          <span class="ts-value">${value}</span>
        </div>
      `;
    });
  }

  _buildTeamLogoLookup() {
    if (!this.config.show_team_logo) return null;
    const entityId = this.config.drivers_entity || 'sensor.f1_drivers_driver_list';
    const driversState = this.hass?.states?.[entityId];
    const drivers = Array.isArray(driversState?.attributes?.drivers)
      ? driversState.attributes.drivers
      : [];
    const byRn = new Map();
    const byTla = new Map();
    drivers.forEach((driver) => {
      const team = driver?.team || driver?.team_name;
      const logo = getTeamLogoMeta(team, 28, this.config.team_logo_style);
      if (!logo) return;
      const rn = String(driver?.racing_number ?? '').trim();
      const tla = String(driver?.tla ?? '').trim();
      if (rn) byRn.set(rn, logo);
      if (tla) byTla.set(tla, logo);
    });
    return { byRn, byTla };
  }

  _getLogoForEntry(entry, lookup) {
    if (!lookup || !entry) return null;
    const team = entry?.team || entry?.team_name;
    const direct = getTeamLogoMeta(team, 28, this.config.team_logo_style);
    if (direct) return direct;
    const rn = String(entry?.racing_number ?? '').trim();
    const tla = String(entry?.driver_tla ?? '').trim();
    if (rn && lookup.byRn?.has(rn)) return lookup.byRn.get(rn);
    if (tla && lookup.byTla?.has(tla)) return lookup.byTla.get(tla);
    return null;
  }

  _driverLabel(entry) {
    if (!entry) return '--';
    const tla = entry?.driver_tla;
    if (tla) return String(tla).toUpperCase();
    const name = entry?.driver_name;
    if (name) return String(name);
    const rn = entry?.racing_number;
    if (rn) return `#${rn}`;
    return '--';
  }

  _formatDelta(value) {
    const num = Number(value);
    if (Number.isNaN(num)) return null;
    return num.toFixed(3);
  }

  _calculateDeltaBarWidth(isFastest, deltaValue) {
    if (isFastest) return 100;
    const delta = parseFloat(deltaValue);
    if (!Number.isFinite(delta)) return 0;
    // Scale: 0 delta = 100%, 2+ seconds = 10%
    const maxDelta = 2.0;
    return Math.max(10, 100 - (delta / maxDelta) * 90);
  }

  _compoundDisplayName(name) {
    const upper = String(name || '').toUpperCase();
    if (upper === 'INTERMEDIATE') return 'INTER';
    if (upper === 'FULL WET' || upper === 'FULLWET') return 'W';
    return upper;
  }

  _hasCompoundData(data) {
    if (!data) return false;
    const bestTimes = Array.isArray(data.best_times) ? data.best_times : [];
    const laps = Number(data.total_laps || 0);
    const sets = Number(data.sets_used_total ?? data.sets_used ?? 0);
    return bestTimes.length > 0 || laps > 0 || sets > 0;
  }

  _sortCompounds(list, deltas, fastestCompound) {
    const fastestName = fastestCompound ? String(fastestCompound).toUpperCase() : null;
    const withScores = list.map((item) => {
      const best = item.data?.best_times?.[0];
      const time = Number(best?.time_secs);
      const delta = Number(deltas?.[item.name]);
      return {
        ...item,
        _time: Number.isFinite(time) ? time : null,
        _delta: Number.isFinite(delta) ? delta : null,
        _isFastest: fastestName && item.name === fastestName,
      };
    });

    withScores.sort((a, b) => {
      if (a._isFastest !== b._isFastest) return a._isFastest ? -1 : 1;
      if (a._time !== null && b._time !== null) return a._time - b._time;
      if (a._delta !== null && b._delta !== null) return a._delta - b._delta;
      if (a._time !== null) return -1;
      if (b._time !== null) return 1;
      if (a._delta !== null) return -1;
      if (b._delta !== null) return 1;
      return a.index - b.index;
    });

    return withScores;
  }

  _normalizeColor(value) {
    if (!value) return null;
    const text = String(value).trim();
    if (text.startsWith('#') || text.startsWith('rgb')) return text;
    if (/^[0-9a-fA-F]{6}$/.test(text)) return `#${text}`;
    return text;
  }

  _hideImage(ev) {
    ev.target.style.display = 'none';
  }

  _handleCardAction() {
    const action = this.config?.tap_action || { action: 'more-info' };
    if (action.action === 'none') return;
    if (action.action === 'more-info') {
      this.dispatchEvent(new CustomEvent('hass-more-info', {
        bubbles: true,
        composed: true,
        detail: { entityId: this.config.entity },
      }));
    }
  }

}

class F1PitStopOverviewCard extends LitElement {
  static properties = {
    hass: {},
    config: {},
  };

  static styles = css`
    /* Animation keyframes */
    @keyframes fadeSlideIn {
      from { opacity: 0; transform: translateY(-8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    :host {
      --ts-bg: #0b0b0d;
      --ts-bg-soft: #131315;
      --ts-border: rgba(255, 255, 255, 0.08);
      --ts-text: #f5f5f5;
      --ts-muted: rgba(255, 255, 255, 0.65);
      --ts-chip: rgba(255, 255, 255, 0.06);
      --ts-shadow: 0 16px 40px rgba(0, 0, 0, 0.35);
      display: block;
      font-family: 'Formula1 Display', 'Noto Sans', sans-serif;
    }

    ha-card {
      padding: 0;
      background: transparent;
      box-shadow: none;
      border: none;
    }

    .ps-card {
      position: relative;
      padding: clamp(12px, 2.2vw, 18px) clamp(12px, 2.2vw, 18px) clamp(12px, 2vw, 16px);
      border-radius: var(--ha-card-border-radius, 12px);
      background: radial-gradient(circle at 15% 10%, rgba(255, 255, 255, 0.08), transparent 45%),
        linear-gradient(160deg, var(--ts-bg) 0%, var(--ts-bg-soft) 60%, #0a0a0a 100%);
      border: 1px solid var(--ts-border);
      box-shadow: var(--ts-shadow);
      overflow: hidden;
      color: var(--ts-text);
    }

    .ps-header {
      text-align: center;
      font-family: 'Formula1 Wide', 'Formula1 Display', 'Noto Sans', sans-serif;
      font-size: clamp(16px, 2.4vw, 20px);
      font-weight: 700;
      letter-spacing: clamp(0.03em, 0.06em, 0.08em);
      text-transform: uppercase;
      margin-bottom: clamp(8px, 1.4vw, 12px);
      text-shadow: 0 6px 16px rgba(0, 0, 0, 0.6);
      white-space: normal;
      text-wrap: balance;
      line-height: 1.1;
      padding: 0 4px;
    }

    .ps-table {
      display: grid;
      gap: 6px;
    }

    .ps-row {
      display: grid;
      grid-template-columns: var(--ps-columns);
      align-items: center;
      column-gap: 4px;
      padding: 6px 8px;
      border-radius: 10px;
      background: var(--ts-chip);
      font-size: clamp(10px, 1.6vw, 11px);
      color: var(--ts-text);
      animation: fadeSlideIn 0.3s ease-out backwards;
      transition: background 0.2s ease, border-left 0.2s ease;
    }

    .ps-row.pit-active {
      background: linear-gradient(90deg, rgba(245, 158, 11, 0.15), var(--ts-chip));
      border-left: 3px solid #f59e0b;
    }

    .ps-row.pit-out-active {
      background: linear-gradient(90deg, rgba(56, 189, 248, 0.15), var(--ts-chip));
      border-left: 3px solid #38bdf8;
    }

    .ps-row.retired {
      color: rgba(255, 255, 255, 0.45);
    }

    .ps-row.retired .ps-cell,
    .ps-row.retired .ps-tla,
    .ps-row.retired .ps-tyre,
    .ps-row.retired .ps-status {
      color: rgba(255, 255, 255, 0.45) !important;
    }

    .ps-row.header {
      background: transparent;
      padding: 4px 6px 2px;
      font-size: clamp(9px, 1.4vw, 10px);
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--ts-muted);
    }

    .ps-cell {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      min-width: 0;
      display: flex;
      align-items: center;
    }

    .ps-cell.center {
      justify-content: center;
      text-align: center;
    }

    .ps-cell.group-start {
      padding-left: 6px;
      border-left: 1px solid rgba(255, 255, 255, 0.12);
    }


    .ps-cell.numeric {
      justify-content: center;
      text-align: center;
      font-variant-numeric: tabular-nums;
    }

    .ps-tla {
      font-weight: 700;
      letter-spacing: 0.08em;
      color: var(--driver-color, var(--ts-text));
    }

    .ps-tla-wrap {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .ps-team-logo {
      width: 16px;
      height: 16px;
      object-fit: contain;
      filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.4));
    }

    .ps-status {
      font-size: 10px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--ts-muted);
    }

    .ps-status-inline {
      margin-left: 4px;
      font-weight: 600;
      display: inline-block;
      max-width: 54px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .ps-status.pit-in {
      color: #f59e0b;
      animation: pulse 1.5s ease-in-out infinite;
    }

    .ps-status.pit-out {
      color: #38bdf8;
      animation: pulse 1.5s ease-in-out infinite;
    }

    .ps-status.stopped {
      color: #fb7185;
    }

    .ps-status.retired {
      color: #a3a3a3;
    }

    .ps-tyre {
      font-weight: 700;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--compound-color, var(--ts-text));
    }

    .ps-tyre-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .ps-tyre-circle {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      border: 2px solid var(--compound-color, var(--ts-text));
      display: grid;
      place-items: center;
      font-weight: 700;
      font-size: 9px;
      line-height: 1;
      color: var(--compound-color, var(--ts-text));
      transition: box-shadow 0.2s ease, border-style 0.2s ease;
    }

    .ps-tyre-badge.old-tyre .ps-tyre-circle {
      border-style: dashed;
      opacity: 0.7;
    }

    .ps-tyre-laps {
      font-size: 9px;
      font-weight: 600;
      color: var(--ts-text);
      min-width: 2ch;
      text-align: right;
      font-variant-numeric: tabular-nums;
    }

    .ps-cell.tyre-col {
      justify-content: flex-start;
      text-align: left;
    }

    .ps-empty {
      padding: 16px;
      border-radius: var(--ha-card-border-radius, 12px);
      background: var(--ts-chip);
      border: 1px dashed rgba(255, 255, 255, 0.12);
      color: var(--ts-muted);
      text-align: center;
      font-size: 13px;
    }

    @media (max-width: 720px) {
      .ps-card {
        padding: 12px 10px 12px;
      }

      .ps-header {
        font-size: 16px;
        letter-spacing: 0.03em;
      }

      .ps-row {
        font-size: 9px;
        padding: 5px 6px;
      }
    }
  `;

  setConfig(config) {
    this.config = {
      title: 'Pit Stops & Tyres',
      show_header: true,
      show_table_header: true,
      show_tla: true,
      show_team_logo: false,
      team_logo_style: 'color',
      show_status: true,
      show_tyre: true,
      show_tyre_laps: false,
      show_pit_count: true,
      show_pit_time: true,
      show_pit_lane_time: true,
      show_pit_delta: true,
      drivers_entity: 'sensor.f1_drivers_driver_list',
      tyres_entity: 'sensor.f1_drivers_current_tyres',
      pitstops_entity: 'sensor.f1_drivers_pit_stops',
      positions_entity: 'sensor.f1_drivers_driver_positions',
      ...config,
    };
  }

  connectedCallback() {
    super.connectedCallback();
    ensureF1Fonts();
  }

  getCardSize() {
    return 8;
  }

  getGridOptions() {
    return {
      columns: 12,
      min_columns: 4,
      max_columns: 12,
      min_rows: 6,
    };
  }

  static getStubConfig() {
    return {
      type: 'custom:f1-pitstop-overview-card',
      drivers_entity: 'sensor.f1_drivers_driver_list',
      positions_entity: 'sensor.f1_drivers_driver_positions',
      tyres_entity: 'sensor.f1_drivers_current_tyres',
      pitstops_entity: 'sensor.f1_drivers_pit_stops',
      title: 'Pit Stops & Tyres',
    };
  }

  static getConfigElement() {
    return document.createElement('f1-pitstop-overview-card-editor');
  }

  render() {
    if (!this.hass || !this.config) return html``;

    if (!this.config.drivers_entity) {
      return html`
        <ha-card>
          <div class="ps-card">
            <div class="ps-empty">Select entities in the editor</div>
          </div>
        </ha-card>
      `;
    }

    const driversState = this.hass.states?.[this.config.drivers_entity];
    if (!driversState) {
      return html`
        <ha-card>
          <div class="ps-card">
            <div class="ps-empty">Drivers entity not found</div>
          </div>
        </ha-card>
      `;
    }

    const drivers = this._asList(driversState?.attributes?.drivers);
    const tyresState = this.hass.states?.[this.config.tyres_entity];
    const tyres = this._asList(tyresState?.attributes?.drivers);
    const pitState = this.hass.states?.[this.config.pitstops_entity];
    const pitCars = pitState?.attributes?.cars && typeof pitState.attributes.cars === 'object'
      ? pitState.attributes.cars
      : {};
    const positionsState = this.config.positions_entity
      ? this.hass.states?.[this.config.positions_entity]
      : null;
    const positions = positionsState?.attributes?.drivers;

    const rows = this._buildRows(drivers, tyres, pitCars, positions);
    const columns = this._columns(rows);
    const gridColumns = columns.map((col) => col.width).join(' ');

    if (rows.length === 0) {
      return html`
        <ha-card>
          <div class="ps-card">
            <div class="ps-empty">No driver data</div>
          </div>
        </ha-card>
      `;
    }

    return html`
      <ha-card @click=${this._handleCardAction}>
        <div class="ps-card">
          ${this.config.show_header
            ? html`<div class="ps-header">${this.config.title || 'Pit Stops & Tyres'}</div>`
            : null}
          <div class="ps-table" style="--ps-columns: ${gridColumns};">
            ${this.config.show_table_header ? this._renderHeader(columns) : null}
            ${rows.map((row) => this._renderRow(row, columns))}
          </div>
        </div>
      </ha-card>
    `;
  }

  _columns(rows) {
    const cols = [];
    const hasLane = Array.isArray(rows)
      ? rows.some((row) => Number.isFinite(row.pit_lane_time_num))
      : false;
    const hasDelta = Array.isArray(rows)
      ? rows.some((row) => Number.isFinite(row.pit_delta_num))
      : false;
    let pitGroupStarted = false;
    if (this.config.show_tla !== false) {
      cols.push({ key: 'tla', label: 'TLA', width: '0.8fr' });
    }
    if (this.config.show_tyre !== false) {
      cols.push({ key: 'tyre', label: 'TYRES', width: '0.3fr' });
    }
    if (this.config.show_pit_count !== false) {
      cols.push({
        key: 'pit_count',
        label: 'ST',
        width: '0.28fr',
        numeric: true,
        group: 'pit',
        groupStart: !pitGroupStarted,
      });
      pitGroupStarted = true;
    }
    if (this.config.show_pit_time !== false) {
      cols.push({
        key: 'pit_time',
        label: 'PIT',
        width: '0.42fr',
        numeric: true,
        group: 'pit',
        groupStart: !pitGroupStarted,
      });
      pitGroupStarted = true;
    }
    if (this.config.show_pit_lane_time !== false && hasLane) {
      cols.push({
        key: 'pit_lane_time',
        label: 'LN',
        width: '0.42fr',
        numeric: true,
        group: 'pit',
        groupStart: !pitGroupStarted,
      });
      pitGroupStarted = true;
    }
    if (this.config.show_pit_delta !== false && hasDelta) {
      cols.push({
        key: 'pit_delta',
        label: '',
        width: '0.38fr',
        numeric: true,
        group: 'pit',
        groupStart: !pitGroupStarted,
      });
      pitGroupStarted = true;
    }
    return cols;
  }

  _renderHeader(columns) {
    return html`
      <div class="ps-row header">
        ${columns.map((col) => html`
          <div class="ps-cell ${col.numeric ? 'numeric' : ''} ${col.key === 'tyre' ? 'tyre-col' : ''} ${col.groupStart ? 'group-start' : ''}">
            ${col.label}
          </div>
        `)}
      </div>
    `;
  }

  _renderRow(row, columns) {
    const pitClass = row.status_key === 'pit-in' ? 'pit-active' :
                     row.status_key === 'pit-out' ? 'pit-out-active' : '';
    return html`
      <div class="ps-row ${row.retired ? 'retired' : ''} ${pitClass}">
        ${columns.map((col) => this._renderCell(row, col))}
      </div>
    `;
  }

  _renderCell(row, col) {
    let value = row[col.key] ?? '--';
    if (col.key === 'status' && (row[col.key] === '' || row[col.key] == null)) value = '';
    if (col.key === 'tyre' && (row[col.key] === 'UNKNOWN' || row[col.key] === '?' || row[col.key] === null)) {
      value = '-';
    }
    const classes = ['ps-cell'];
    if (col.numeric) classes.push('numeric');
    if (col.key === 'tla') classes.push('ps-tla');
    if (col.key === 'tyre') classes.push('ps-tyre', 'tyre-col');
    if (col.key === 'tyre_laps') classes.push('center');
    if (col.groupStart) classes.push('group-start');

    let style = '';
    if (col.key === 'tla' && row.team_color) {
      style = `--driver-color: ${row.team_color};`;
    }
    if (col.key === 'tyre' && row.compound_color) {
      style = `--compound-color: ${row.compound_color};`;
    }

    if (col.key === 'tyre') {
      const letter = value === '-' ? '-' : String(value || '').trim();
      const laps = row.tyre_laps && row.tyre_laps !== '--' ? row.tyre_laps : '';
      const lapsNum = parseInt(laps, 10);
      const tyreAgeClass = lapsNum > 20 ? 'old-tyre' : '';
      return html`
        <div class="${classes.join(' ')}" style="${style}">
          <div class="ps-tyre-badge ${tyreAgeClass}">
            <div class="ps-tyre-circle">${letter}</div>
            <div class="ps-tyre-laps">${laps || '-'}</div>
          </div>
        </div>
      `;
    }

    if (col.key === 'tla' && this.config.show_status !== false && row.status) {
      const statusClasses = ['ps-status', 'ps-status-inline'];
      if (row.status_key) statusClasses.push(row.status_key);
      const logo = this.config.show_team_logo && row.team_logo
        ? html`
          <img
            class="ps-team-logo"
            src="${row.team_logo.src}"
            data-fallback="${row.team_logo.fallback || ''}"
            loading="lazy"
            @error=${handleTeamLogoError}
            alt=""
          />
        `
        : null;
      return html`
        <div class="${classes.join(' ')}" style="${style}">
          <span class="ps-tla-wrap">${logo}${value}</span>
          <span class="${statusClasses.join(' ')}">- ${row.status}</span>
        </div>
      `;
    }

    if (col.key === 'tla') {
      const logo = this.config.show_team_logo && row.team_logo
        ? html`
          <img
            class="ps-team-logo"
            src="${row.team_logo.src}"
            data-fallback="${row.team_logo.fallback || ''}"
            loading="lazy"
            @error=${handleTeamLogoError}
            alt=""
          />
        `
        : null;
      return html`
        <div class="${classes.join(' ')}" style="${style}">
          <span class="ps-tla-wrap">${logo}${value}</span>
        </div>
      `;
    }

    return html`<div class="${classes.join(' ')}" style="${style}">${value}</div>`;
  }

  _buildRows(drivers, tyres, pitCars, positions) {
    const tyreMap = new Map();
    for (const item of tyres) {
      const rn = String(item?.racing_number ?? '').trim();
      if (rn) tyreMap.set(rn, item);
    }

    const positionMap = new Map();
    if (Array.isArray(positions)) {
      for (const item of positions) {
        const rn = String(item?.racing_number ?? '').trim();
        if (rn) positionMap.set(rn, item);
      }
    } else if (positions && typeof positions === 'object') {
      for (const [key, info] of Object.entries(positions)) {
        if (!info || typeof info !== 'object') continue;
        const rnFromInfo = String(info.racing_number ?? '').trim();
        const rnFromKeyMatch = String(key).match(/\d+/);
        const rn = rnFromInfo || (rnFromKeyMatch ? rnFromKeyMatch[0] : '');
        if (rn) positionMap.set(rn, info);
      }
    }

    const pitMap = new Map();
    if (pitCars && typeof pitCars === 'object') {
      for (const [rn, info] of Object.entries(pitCars)) {
        pitMap.set(String(rn), info);
      }
    }

    const rows = drivers.map((driver) => {
      const rn = String(driver?.racing_number ?? '').trim();
      const tyre = tyreMap.get(rn) || {};
      const pos = positionMap.get(rn) || {};
      const pit = pitMap.get(rn) || {};
      const stops = Array.isArray(pit?.stops) ? pit.stops : [];
      const lastStop = stops.length > 0 ? stops[stops.length - 1] : null;

      const compoundRaw = tyre?.compound || tyre?.compound_short;
      const compoundKey = this._normalizeCompoundKey(compoundRaw);
      const compoundLabel = this._compoundDisplayName(compoundKey || compoundRaw);
      const compoundColor = this._normalizeColor(
        tyre?.compound_color || COMPOUND_FALLBACK[compoundKey],
      );
      const teamName = driver?.team || driver?.team_name || tyre?.team || pos?.team || pit?.team;
      const teamLogo = getTeamLogoMeta(teamName, 28, this.config.team_logo_style);

      const pitCount = Number.isFinite(Number(pit?.count))
        ? Number(pit.count)
        : stops.length;

      const pitStopTimeNum = Number(lastStop?.pit_stop_time);
      const pitLaneTimeNum = Number(lastStop?.pit_lane_time);
      const pitDeltaNum = Number(lastStop?.pit_delta);
      const pitStopTime = this._formatSeconds(pitStopTimeNum);
      const pitLaneTime = this._formatSeconds(pitLaneTimeNum);
      const pitDelta = this._formatSeconds(pitDeltaNum);
      const tyreLaps = this._formatLaps(tyre?.stint_laps);

      const position = this._parsePosition(
        pos?.current_position ?? pos?.grid_position ?? tyre?.position ?? driver?.position,
      );
      const statusInfo = this._statusLabel(pos);

      return {
        rn,
        position,
        tla: driver?.tla || tyre?.tla || pit?.tla || '--',
        status: statusInfo?.label || '',
        status_key: statusInfo?.key || '',
        retired: statusInfo?.retired === true,
        team_color: this._normalizeColor(driver?.team_color || tyre?.team_color),
        team_logo: teamLogo,
        compound_color: compoundColor,
        tyre: compoundLabel,
        tyre_laps: tyreLaps,
        pit_count: pitCount,
        pit_time: pitStopTime,
        pit_lane_time: pitLaneTime,
        pit_delta: pitDelta,
        pit_lane_time_num: Number.isFinite(pitLaneTimeNum) ? pitLaneTimeNum : null,
        pit_delta_num: Number.isFinite(pitDeltaNum) ? pitDeltaNum : null,
      };
    });

    rows.sort((a, b) => {
      if (a.position !== null && b.position !== null) {
        const diff = a.position - b.position;
        if (diff !== 0) return diff;
        return this._compareRacingNumber(a.rn, b.rn);
      }
      if (a.position !== null) return -1;
      if (b.position !== null) return 1;
      return this._compareRacingNumber(a.rn, b.rn);
    });

    return rows;
  }

  _compareRacingNumber(a, b) {
    const aNum = Number(a);
    const bNum = Number(b);
    if (Number.isFinite(aNum) && Number.isFinite(bNum)) return aNum - bNum;
    return String(a).localeCompare(String(b));
  }

  _asList(value) {
    return Array.isArray(value) ? value : [];
  }

  _statusLabel(info) {
    if (!info || typeof info !== 'object') return { label: '', retired: false };
    const retired = info.retired === true;
    const stopped = info.stopped === true;
    const inPit = info.in_pit === true;
    const pitOut = info.pit_out === true;
    const status = typeof info.status === 'string' ? info.status.toLowerCase() : '';

    if (retired || status === 'retired' || status === 'out') {
      return { label: 'OUT', retired: true, key: 'retired' };
    }
    if (stopped || status === 'stopped') return { label: 'STOP', retired: false, key: 'stopped' };
    if (pitOut || status === 'pit_out') return { label: 'PIT', retired: false, key: 'pit-out' };
    if (inPit || status === 'in_pit' || status === 'pit') return { label: 'PIT', retired: false, key: 'pit-in' };
    if (status && status !== 'on_track') return { label: status.replace(/_/g, ' ').toUpperCase(), retired: false, key: 'other' };
    return { label: '', retired: false, key: '' };
  }

  _parsePosition(value) {
    if (value === null || value === undefined) return null;
    const text = String(value).trim();
    if (!text) return null;
    const match = text.match(/\d+/);
    if (!match) return null;
    const num = Number(match[0]);
    return Number.isFinite(num) ? num : null;
  }

  _formatSeconds(value) {
    const num = Number(value);
    if (!Number.isFinite(num)) return '--';
    return num.toFixed(1);
  }

  _formatLaps(value) {
    if (value === null || value === undefined || value === '') return '--';
    const num = Number(value);
    if (!Number.isFinite(num)) return '--';
    return Math.max(0, Math.round(num));
  }

  _normalizeCompoundKey(value) {
    if (!value) return null;
    const upper = String(value).trim().toUpperCase();
    if (upper === 'S') return 'SOFT';
    if (upper === 'M') return 'MEDIUM';
    if (upper === 'H') return 'HARD';
    if (upper === 'I') return 'INTERMEDIATE';
    if (upper === 'INTER') return 'INTERMEDIATE';
    if (upper === 'W') return 'WET';
    if (upper === 'FULL WET' || upper === 'FULLWET') return 'WET';
    return upper;
  }

  _compoundDisplayName(name) {
    if (!name) return '--';
    const upper = String(name).trim().toUpperCase();
    if (upper === 'SOFT') return 'S';
    if (upper === 'MEDIUM') return 'M';
    if (upper === 'HARD') return 'H';
    if (upper === 'INTERMEDIATE') return 'I';
    if (upper === 'WET') return 'W';
    if (upper === 'S') return 'S';
    if (upper === 'M') return 'M';
    if (upper === 'H') return 'H';
    if (upper === 'I') return 'I';
    if (upper === 'W') return 'W';
    if (upper === 'FULL WET' || upper === 'FULLWET') return 'WET';
    return upper;
  }

  _normalizeColor(value) {
    if (!value) return null;
    const text = String(value).trim();
    if (text.startsWith('#') || text.startsWith('rgb')) return text;
    if (/^[0-9a-fA-F]{6}$/.test(text)) return `#${text}`;
    return text;
  }

  _handleCardAction() {
    const action = this.config?.tap_action || { action: 'more-info' };
    if (action.action === 'none') return;
    if (action.action === 'more-info') {
      this.dispatchEvent(new CustomEvent('hass-more-info', {
        bubbles: true,
        composed: true,
        detail: { entityId: this.config.drivers_entity },
      }));
    }
  }
}

class F1TyreStatisticsCardEditor extends LitElement {
  static properties = {
    hass: {},
    _config: {},
    _activeTab: { state: true },
  };

  static styles = css`
    .card-config {
      display: flex;
      flex-direction: column;
    }

    .tabs {
      display: flex;
      border-bottom: 1px solid var(--divider-color);
      margin-bottom: 16px;
    }

    .tabs button {
      flex: 1;
      padding: 12px;
      background: none;
      border: none;
      cursor: pointer;
      color: var(--primary-text-color);
      font-size: 14px;
      font-family: inherit;
      transition: color 0.2s;
    }

    .tabs button:hover {
      color: var(--primary-color);
    }

    .tabs button.active {
      color: var(--primary-color);
      border-bottom: 2px solid var(--primary-color);
      margin-bottom: -1px;
    }

    .section {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-bottom: 16px;
    }

    .section-header {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 0.5px;
      color: var(--secondary-text-color);
      text-transform: uppercase;
      margin-top: 8px;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .helper {
      font-size: 12px;
      color: var(--secondary-text-color);
      padding-left: 16px;
      line-height: 1.4;
    }

    .warning {
      font-size: 12px;
      color: var(--error-color);
      padding-left: 16px;
    }

    .display-section {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    ha-textfield {
      display: block;
      margin-bottom: 8px;
    }

    ha-formfield {
      display: flex;
      align-items: center;
      padding: 4px 0;
    }

    ha-select {
      width: 100%;
    }
  `;

  constructor() {
    super();
    this._activeTab = 'sources';
  }

  setConfig(config) {
    this._config = { ...config };
  }

  render() {
    if (!this.hass || !this._config) return html``;

    return html`
      <div class="card-config">
        <div class="tabs">
          <button
            class=${this._activeTab === 'sources' ? 'active' : ''}
            @click=${() => this._activeTab = 'sources'}
          >
            Data Sources
          </button>
          <button
            class=${this._activeTab === 'display' ? 'active' : ''}
            @click=${() => this._activeTab = 'display'}
          >
            Display
          </button>
        </div>

        ${this._activeTab === 'sources'
          ? this._renderDataSourcesTab()
          : this._renderDisplayTab()}
      </div>
    `;
  }

  _renderDataSourcesTab() {
    return html`
      <div class="section">
        <div class="section-header">REQUIRED SENSORS</div>
        ${this._renderEntityPicker(
          'entity',
          'Tyre Statistics Sensor',
          'Provides live tyre compound data and statistics',
          true,
          'sensor'
        )}
      </div>
      <div class="section">
        <div class="section-header">OPTIONAL SENSORS</div>
        ${this._renderEntityPicker(
          'drivers_entity',
          'Driver List Sensor',
          'Provides driver names, TLAs, and team colors. Enables team logo display.',
          false,
          'sensor'
        )}
      </div>
    `;
  }

  _renderDisplayTab() {
    return html`
      <div class="display-section">
        <ha-textfield
          .label=${'Title'}
          .value=${this._config.title || ''}
          @input=${(e) => this._valueChanged('title', e.target.value)}
        ></ha-textfield>

        ${this._renderSwitch('show_header', 'Show header')}
        ${this._renderSwitch('show_tyre_image', 'Show tyre image')}
        ${this._renderSwitch('show_compound_name', 'Show compound name')}
        ${this._renderSwitch('show_best_times', 'Show top times')}
        ${this._renderSwitch('show_stats', 'Show stats')}
        ${this._renderSwitch('show_delta', 'Show delta')}
        ${this._renderSwitch('show_team_logo', 'Show team logos')}

        <ha-select
          .label=${'Team logo style'}
          .value=${this._config.team_logo_style || 'color'}
          @selected=${(e) => this._valueChanged('team_logo_style', e.target.value)}
          @closed=${(e) => e.stopPropagation()}
        >
          <mwc-list-item value="color">Color (fallback to white)</mwc-list-item>
          <mwc-list-item value="white">White</mwc-list-item>
        </ha-select>
      </div>
    `;
  }

  _renderEntityPicker(name, label, helper, required, domain) {
    const value = this._config[name];
    const showWarning = required && !value;
    const schema = [{ name, label, required, selector: { entity: { domain } } }];

    return html`
      <div class="field">
        <ha-form
          .hass=${this.hass}
          .data=${this._config}
          .schema=${schema}
          .computeLabel=${() => label}
          @value-changed=${this._formValueChanged}
        ></ha-form>
        <div class="helper">${helper}</div>
        ${showWarning ? html`
          <div class="warning">This sensor is required for the card to function</div>
        ` : ''}
      </div>
    `;
  }

  _renderSwitch(name, label, helper = null) {
    const schema = [{ name, label, selector: { boolean: {} } }];
    return html`
      <ha-form
        .hass=${this.hass}
        .data=${this._config}
        .schema=${schema}
        .computeLabel=${() => label}
        @value-changed=${this._formValueChanged}
      ></ha-form>
      ${helper ? html`<div class="helper">${helper}</div>` : ''}
    `;
  }

  _formValueChanged(ev) {
    if (!this._config) return;
    const value = ev.detail?.value || {};
    const newConfig = { ...this._config, ...value };
    this._config = newConfig;
    this.dispatchEvent(new CustomEvent('config-changed', { detail: { config: newConfig } }));
  }

  _valueChanged(name, value) {
    if (!this._config) return;
    const newConfig = { ...this._config, [name]: value };
    this._config = newConfig;
    this.dispatchEvent(new CustomEvent('config-changed', { detail: { config: newConfig } }));
  }
}

class F1PitStopOverviewCardEditor extends LitElement {
  static properties = {
    hass: {},
    _config: {},
    _activeTab: { state: true },
  };

  static styles = css`
    .card-config {
      display: flex;
      flex-direction: column;
    }

    .tabs {
      display: flex;
      border-bottom: 1px solid var(--divider-color);
      margin-bottom: 16px;
    }

    .tabs button {
      flex: 1;
      padding: 12px;
      background: none;
      border: none;
      cursor: pointer;
      color: var(--primary-text-color);
      font-size: 14px;
      font-family: inherit;
      transition: color 0.2s;
    }

    .tabs button:hover {
      color: var(--primary-color);
    }

    .tabs button.active {
      color: var(--primary-color);
      border-bottom: 2px solid var(--primary-color);
      margin-bottom: -1px;
    }

    .section {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-bottom: 16px;
    }

    .section-header {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 0.5px;
      color: var(--secondary-text-color);
      text-transform: uppercase;
      margin-top: 8px;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .helper {
      font-size: 12px;
      color: var(--secondary-text-color);
      padding-left: 16px;
      line-height: 1.4;
    }

    .warning {
      font-size: 12px;
      color: var(--error-color);
      padding-left: 16px;
    }

    .display-section {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    ha-textfield {
      display: block;
      margin-bottom: 8px;
    }

    ha-formfield {
      display: flex;
      align-items: center;
      padding: 4px 0;
    }

    ha-select {
      width: 100%;
    }
  `;

  constructor() {
    super();
    this._activeTab = 'sources';
  }

  setConfig(config) {
    this._config = { ...config };
  }

  render() {
    if (!this.hass || !this._config) return html``;

    return html`
      <div class="card-config">
        <div class="tabs">
          <button
            class=${this._activeTab === 'sources' ? 'active' : ''}
            @click=${() => this._activeTab = 'sources'}
          >
            Data Sources
          </button>
          <button
            class=${this._activeTab === 'display' ? 'active' : ''}
            @click=${() => this._activeTab = 'display'}
          >
            Display
          </button>
        </div>

        ${this._activeTab === 'sources'
          ? this._renderDataSourcesTab()
          : this._renderDisplayTab()}
      </div>
    `;
  }

  _renderDataSourcesTab() {
    return html`
      <div class="section">
        <div class="section-header">REQUIRED SENSORS</div>
        ${this._renderEntityPicker(
          'drivers_entity',
          'Driver List Sensor',
          'Provides driver names, TLAs, and team colors',
          true,
          'sensor'
        )}
        ${this._renderEntityPicker(
          'tyres_entity',
          'Current Tyres Sensor',
          'Provides tyre compound and stint lap count',
          true,
          'sensor'
        )}
        ${this._renderEntityPicker(
          'pitstops_entity',
          'Pit Stops Sensor',
          'Provides pit stop times, lane times, and deltas',
          true,
          'sensor'
        )}
      </div>
      <div class="section">
        <div class="section-header">OPTIONAL SENSORS</div>
        ${this._renderEntityPicker(
          'positions_entity',
          'Driver Positions Sensor',
          'Provides race positions and status flags. Enables status column.',
          false,
          'sensor'
        )}
      </div>
    `;
  }

  _renderDisplayTab() {
    return html`
      <div class="display-section">
        <ha-textfield
          .label=${'Title'}
          .value=${this._config.title || ''}
          @input=${(e) => this._valueChanged('title', e.target.value)}
        ></ha-textfield>

        ${this._renderSwitch('show_header', 'Show header')}
        ${this._renderSwitch('show_table_header', 'Show table header')}
        ${this._renderSwitch('show_tla', 'Show TLA', 'Driver codes like VER, HAM')}
        ${this._renderSwitch('show_team_logo', 'Show team logos')}

        <ha-select
          .label=${'Team logo style'}
          .value=${this._config.team_logo_style || 'color'}
          @selected=${(e) => this._valueChanged('team_logo_style', e.target.value)}
          @closed=${(e) => e.stopPropagation()}
        >
          <mwc-list-item value="color">Color (fallback to white)</mwc-list-item>
          <mwc-list-item value="white">White</mwc-list-item>
        </ha-select>

        ${this._renderSwitch('show_status', 'Show status')}
        ${this._renderSwitch('show_tyre', 'Show tyre')}
        ${this._renderSwitch('show_pit_count', 'Show pit stop count')}
        ${this._renderSwitch('show_pit_time', 'Show pit stop time')}
        ${this._renderSwitch('show_pit_lane_time', 'Show pit lane time')}
        ${this._renderSwitch('show_pit_delta', 'Show pit stop delta')}
      </div>
    `;
  }

  _renderEntityPicker(name, label, helper, required, domain) {
    const value = this._config[name];
    const showWarning = required && !value;
    const schema = [{ name, label, required, selector: { entity: { domain } } }];

    return html`
      <div class="field">
        <ha-form
          .hass=${this.hass}
          .data=${this._config}
          .schema=${schema}
          .computeLabel=${() => label}
          @value-changed=${this._formValueChanged}
        ></ha-form>
        <div class="helper">${helper}</div>
        ${showWarning ? html`
          <div class="warning">This sensor is required for the card to function</div>
        ` : ''}
      </div>
    `;
  }

  _renderSwitch(name, label, helper = null) {
    const schema = [{ name, label, selector: { boolean: {} } }];
    return html`
      <ha-form
        .hass=${this.hass}
        .data=${this._config}
        .schema=${schema}
        .computeLabel=${() => label}
        @value-changed=${this._formValueChanged}
      ></ha-form>
      ${helper ? html`<div class="helper">${helper}</div>` : ''}
    `;
  }

  _formValueChanged(ev) {
    if (!this._config) return;
    const value = ev.detail?.value || {};
    const newConfig = { ...this._config, ...value };
    this._config = newConfig;
    this.dispatchEvent(new CustomEvent('config-changed', { detail: { config: newConfig } }));
  }

  _valueChanged(name, value) {
    if (!this._config) return;
    const newConfig = { ...this._config, [name]: value };
    this._config = newConfig;
    this.dispatchEvent(new CustomEvent('config-changed', { detail: { config: newConfig } }));
  }
}

// ============================================================================
// F1 Driver Lap Times Card
// ============================================================================

class F1DriverLapTimesCard extends LitElement {
  static properties = {
    hass: {},
    config: {},
  };

  static styles = css`
    /* Animation keyframes */
    @keyframes fadeSlideIn {
      from { opacity: 0; transform: translateY(-8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    :host {
      --ts-bg: #0b0b0d;
      --ts-bg-soft: #131315;
      --ts-border: rgba(255, 255, 255, 0.08);
      --ts-text: #f5f5f5;
      --ts-muted: rgba(255, 255, 255, 0.65);
      --ts-chip: rgba(255, 255, 255, 0.06);
      --ts-shadow: 0 16px 40px rgba(0, 0, 0, 0.35);
      display: block;
      font-family: 'Formula1 Display', 'Noto Sans', sans-serif;
    }

    ha-card {
      padding: 0;
      background: transparent;
      box-shadow: none;
      border: none;
    }

    .dl-card {
      position: relative;
      padding: clamp(12px, 2.2vw, 18px) clamp(12px, 2.2vw, 18px) clamp(12px, 2vw, 16px);
      border-radius: var(--ha-card-border-radius, 12px);
      background: radial-gradient(circle at 15% 10%, rgba(255, 255, 255, 0.08), transparent 45%),
        linear-gradient(160deg, var(--ts-bg) 0%, var(--ts-bg-soft) 60%, #0a0a0a 100%);
      border: 1px solid var(--ts-border);
      box-shadow: var(--ts-shadow);
      overflow: hidden;
      color: var(--ts-text);
    }

    .dl-header {
      text-align: center;
      font-family: 'Formula1 Wide', 'Formula1 Display', 'Noto Sans', sans-serif;
      font-size: clamp(16px, 2.4vw, 20px);
      font-weight: 700;
      letter-spacing: clamp(0.03em, 0.06em, 0.08em);
      text-transform: uppercase;
      margin-bottom: clamp(8px, 1.4vw, 12px);
      text-shadow: 0 6px 16px rgba(0, 0, 0, 0.6);
      white-space: normal;
      text-wrap: balance;
      line-height: 1.1;
      padding: 0 4px;
    }

    .dl-table {
      display: grid;
      gap: 6px;
    }

    .dl-row {
      display: grid;
      grid-template-columns: var(--dl-columns);
      align-items: center;
      column-gap: 0px;
      padding: 6px 4px;
      border-radius: 10px;
      background: var(--ts-chip);
      font-size: clamp(10px, 1.6vw, 11px);
      color: var(--ts-text);
      animation: fadeSlideIn 0.25s ease-out backwards;
      transition: background 0.2s ease, border-left 0.2s ease;
    }

    .dl-row.fastest-lap {
      background: linear-gradient(90deg, rgba(138, 43, 226, 0.12), var(--ts-chip));
      border-left: 2px solid #8b5cf6;
    }

    .dl-row.retired {
      color: rgba(255, 255, 255, 0.45);
    }

    .dl-row.retired .dl-cell,
    .dl-row.retired .dl-tla,
    .dl-row.retired .dl-status {
      color: rgba(255, 255, 255, 0.45) !important;
    }

    .dl-row.header {
      background: transparent;
      padding: 4px 6px 2px;
      font-size: clamp(9px, 1.4vw, 10px);
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--ts-muted);
    }

    .dl-cell {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      min-width: 0;
      display: flex;
      align-items: center;
    }

    .dl-cell.center {
      justify-content: center;
      text-align: center;
    }

    .dl-cell.compact {
      padding-right: 0;
    }

    .dl-cell.tabular {
      font-variant-numeric: tabular-nums;
    }

    .dl-cell.numeric {
      justify-content: center;
      text-align: center;
      font-variant-numeric: tabular-nums;
    }

    .dl-cell.group-start {
      padding-left: 6px;
      border-left: 1px solid rgba(255, 255, 255, 0.12);
    }

    .dl-tla {
      font-weight: 700;
      letter-spacing: 0.08em;
      color: var(--driver-color, var(--ts-text));
    }

    .dl-tla-wrap {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .dl-status {
      font-size: 10px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--ts-muted);
    }

    .dl-status-inline {
      margin-left: 2px;
      font-weight: 600;
      display: inline-block;
      max-width: 54px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .dl-status.pit-in {
      color: #f59e0b;
      animation: pulse 1.5s ease-in-out infinite;
    }

    .dl-status.pit-out {
      color: #38bdf8;
      animation: pulse 1.5s ease-in-out infinite;
    }

    .dl-status.stopped {
      color: #fb7185;
    }

    .dl-status.retired {
      color: #a3a3a3;
    }

    .dl-team-logo {
      width: 14px;
      height: 14px;
      object-fit: contain;
      filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.4));
    }

    .dl-empty {
      padding: 16px;
      border-radius: var(--ha-card-border-radius, 12px);
      background: var(--ts-chip);
      border: 1px dashed rgba(255, 255, 255, 0.12);
      color: var(--ts-muted);
      text-align: center;
      font-size: 13px;
    }

    @media (max-width: 720px) {
      .dl-card {
        padding: 12px 10px 12px;
      }

      .dl-header {
        font-size: 16px;
        letter-spacing: 0.03em;
      }

      .dl-row {
        font-size: 9px;
        padding: 5px 6px;
      }
    }
  `;

  setConfig(config) {
    this.config = {
      title: 'Driver Lap Times',
      show_header: true,
      show_table_header: true,
      show_position: true,
      show_team_logo: true,
      show_tla: true,
      show_status: true,
      show_last_lap: true,
      team_logo_style: 'color',
      drivers_entity: 'sensor.f1_drivers_driver_list',
      positions_entity: 'sensor.f1_drivers_driver_positions',
      ...config,
    };
  }

  connectedCallback() {
    super.connectedCallback();
    ensureF1Fonts();
  }

  getCardSize() {
    return 6;
  }

  getGridOptions() {
    return {
      columns: 12,
      min_columns: 4,
      max_columns: 12,
      min_rows: 4,
    };
  }

  static getStubConfig() {
    return {
      type: 'custom:f1-driver-lap-times-card',
      drivers_entity: 'sensor.f1_drivers_driver_list',
      positions_entity: 'sensor.f1_drivers_driver_positions',
      title: 'Driver Lap Times',
    };
  }

  static getConfigElement() {
    return document.createElement('f1-driver-lap-times-card-editor');
  }

  render() {
    if (!this.hass || !this.config) return html``;

    if (!this.config.drivers_entity || !this.config.positions_entity) {
      return html`
        <ha-card>
          <div class="dl-card">
            <div class="dl-empty">Select entities in the editor</div>
          </div>
        </ha-card>
      `;
    }

    const driversState = this.hass.states?.[this.config.drivers_entity];
    const positionsState = this.hass.states?.[this.config.positions_entity];
    if (!driversState || !positionsState) {
      return html`
        <ha-card>
          <div class="dl-card">
            <div class="dl-empty">Entity not found</div>
          </div>
        </ha-card>
      `;
    }

    const drivers = this._asList(driversState?.attributes?.drivers);
    const positions = positionsState?.attributes?.drivers;
    const fastestLap = positionsState?.attributes?.fastest_lap;

    const rows = this._buildRows(drivers, positions, fastestLap);
    const columns = this._columns();
    const gridColumns = columns.map((col) => col.width).join(' ');

    if (rows.length === 0) {
      return html`
        <ha-card>
          <div class="dl-card">
            <div class="dl-empty">No driver data</div>
          </div>
        </ha-card>
      `;
    }

    return html`
      <ha-card @click=${this._handleCardAction}>
        <div class="dl-card">
          ${this.config.show_header
            ? html`<div class="dl-header">${this.config.title || 'Driver Lap Times'}</div>`
            : null}
          <div class="dl-table" style="--dl-columns: ${gridColumns};">
            ${this.config.show_table_header ? this._renderHeader(columns) : null}
            ${rows.map((row) => this._renderRow(row, columns))}
          </div>
        </div>
      </ha-card>
    `;
  }

  _columns() {
    const cols = [];
    if (this.config.show_position !== false) {
      cols.push({ key: 'position', label: 'POS', width: '0.14fr', tabular: true, compact: true, hideHeader: true });
    }
    if (this.config.show_team_logo !== false) {
      cols.push({ key: 'logo', label: 'LOGO', width: '0.16fr', compact: true, hideHeader: true });
    }
    if (this.config.show_tla !== false) {
      cols.push({ key: 'tla', label: 'TLA', width: '0.36fr', compact: true, hideHeader: true });
    }
    if (this.config.show_last_lap !== false) {
      cols.push({ key: 'last_lap', label: 'LAST', width: '1fr', numeric: true, groupStart: true });
    }
    return cols;
  }

  _renderHeader(columns) {
    return html`
      <div class="dl-row header">
        ${columns.map((col) => html`
          <div class="dl-cell ${col.numeric ? 'numeric' : ''} ${col.center ? 'center' : ''} ${col.tabular ? 'tabular' : ''} ${col.groupStart ? 'group-start' : ''} ${col.compact ? 'compact' : ''}">
            ${col.hideHeader ? '' : col.label}
          </div>
        `)}
      </div>
    `;
  }

  _renderRow(row, columns) {
    const rowClasses = ['dl-row'];
    if (row.is_fastest) rowClasses.push('fastest-lap');
    if (row.retired) rowClasses.push('retired');
    return html`
      <div class="${rowClasses.join(' ')}">
        ${columns.map((col) => this._renderCell(row, col))}
      </div>
    `;
  }

  _renderCell(row, col) {
    const classes = ['dl-cell'];
    if (col.numeric) classes.push('numeric');
    if (col.center) classes.push('center');
    if (col.tabular) classes.push('tabular');
    if (col.groupStart) classes.push('group-start');
    if (col.compact) classes.push('compact');
    if (col.key === 'tla') classes.push('dl-tla');

    let style = '';
    if (col.key === 'tla' && row.team_color) {
      style = `--driver-color: ${row.team_color};`;
    }

    if (col.key === 'logo') {
      const logo = row.team_logo;
      return html`
        <div class="${classes.join(' ')}">
          ${logo ? html`
            <img
              class="dl-team-logo"
              src="${logo.src}"
              data-fallback="${logo.fallback || ''}"
              loading="lazy"
              @error=${handleTeamLogoError}
              alt=""
            />
          ` : html`<span>--</span>`}
        </div>
      `;
    }

    let value = row[col.key];
    if (col.key === 'position') value = row.position ?? '--';
    if (col.key === 'last_lap') value = row.last_lap || '--:--.---';
    if (col.key === 'tla') value = row.tla || '--';

    if (col.key === 'tla' && this.config.show_status !== false && row.status) {
      const statusClasses = ['dl-status', 'dl-status-inline'];
      if (row.status_key) statusClasses.push(row.status_key);
      return html`
        <div class="${classes.join(' ')}" style="${style}">
          <span class="dl-tla-wrap">
            ${value ?? '--'}
            <span class="${statusClasses.join(' ')}">- ${row.status}</span>
          </span>
        </div>
      `;
    }

    return html`<div class="${classes.join(' ')}" style="${style}">${value ?? '--'}</div>`;
  }

  _buildRows(drivers, positions, fastestLap) {
    const positionMap = this._buildPositionMap(positions);
    const fastestInfo = this._normalizeFastestLap(fastestLap);

    const rows = drivers.map((driver) => {
      const rn = String(driver?.racing_number ?? '').trim();
      const pos = positionMap.get(rn) || {};

      const teamName = driver?.team || driver?.team_name || pos?.team;
      const teamLogo = getTeamLogoMeta(teamName, 24, this.config.team_logo_style);
      const teamColor = this._normalizeColor(driver?.team_color || pos?.team_color);
      const tlaValue = driver?.tla || pos?.tla || '--';
      const tlaKey = String(tlaValue || '').trim().toUpperCase();

      const position = this._parsePosition(
        pos?.current_position ?? pos?.grid_position ?? driver?.position,
      );

      const latestLap = this._latestLapTime(pos);
      const isFastest = Boolean(pos?.fastest_lap) || this._matchesFastest(rn, tlaKey, fastestInfo);
      const statusInfo = this._statusLabel(pos);

      return {
        rn,
        position,
        tla: tlaValue,
        status: statusInfo?.label || '',
        status_key: statusInfo?.key || '',
        retired: statusInfo?.retired === true,
        team_color: teamColor,
        team_logo: teamLogo,
        last_lap: latestLap,
        is_fastest: isFastest,
      };
    });

    rows.sort((a, b) => {
      if (a.position !== null && b.position !== null) {
        const diff = a.position - b.position;
        if (diff !== 0) return diff;
        return this._compareRacingNumber(a.rn, b.rn);
      }
      if (a.position !== null) return -1;
      if (b.position !== null) return 1;
      return this._compareRacingNumber(a.rn, b.rn);
    });

    return rows;
  }

  _buildPositionMap(positions) {
    const map = new Map();
    if (Array.isArray(positions)) {
      positions.forEach((item) => {
        const rn = String(item?.racing_number ?? '').trim();
        const tla = String(item?.tla ?? '').trim();
        if (rn) map.set(rn, item);
        if (tla) map.set(tla, item);
      });
    } else if (positions && typeof positions === 'object') {
      Object.entries(positions).forEach(([key, info]) => {
        if (!info || typeof info !== 'object') return;
        const rnFromInfo = String(info.racing_number ?? '').trim();
        const rnFromKeyMatch = String(key).match(/\d+/);
        const rn = rnFromInfo || (rnFromKeyMatch ? rnFromKeyMatch[0] : '');
        const tla = String(info.tla ?? '').trim();
        if (rn) map.set(rn, info);
        if (tla) map.set(tla, info);
      });
    }
    return map;
  }

  _latestLapTime(positionInfo) {
    if (!positionInfo || typeof positionInfo !== 'object') return '--:--.---';
    const laps = positionInfo?.laps;
    if (!laps || typeof laps !== 'object') return '--:--.---';
    let lapKey = null;
    const completed = Number(positionInfo?.completed_laps);
    if (Number.isFinite(completed) && completed > 0) {
      lapKey = String(Math.floor(completed));
      if (!Object.prototype.hasOwnProperty.call(laps, lapKey)) {
        lapKey = null;
      }
    }
    if (!lapKey) {
      let maxKey = null;
      Object.keys(laps).forEach((key) => {
        const num = Number(key);
        if (!Number.isFinite(num)) return;
        if (maxKey === null || num > maxKey) maxKey = num;
      });
      if (maxKey !== null) lapKey = String(maxKey);
    }
    const time = lapKey ? laps[lapKey] : null;
    if (typeof time === 'string' && time.trim()) return time;
    return '--:--.---';
  }

  _compareRacingNumber(a, b) {
    const aNum = Number(a);
    const bNum = Number(b);
    if (Number.isFinite(aNum) && Number.isFinite(bNum)) return aNum - bNum;
    return String(a).localeCompare(String(b));
  }

  _asList(value) {
    return Array.isArray(value) ? value : [];
  }

  _parsePosition(value) {
    if (value === null || value === undefined) return null;
    const text = String(value).trim();
    if (!text) return null;
    const match = text.match(/\d+/);
    if (!match) return null;
    const num = Number(match[0]);
    return Number.isFinite(num) ? num : null;
  }

  _normalizeFastestLap(value) {
    if (!value || typeof value !== 'object') return null;
    const rn = String(value?.racing_number ?? '').trim();
    const tla = String(value?.tla ?? '').trim().toUpperCase();
    if (!rn && !tla) return null;
    return { rn: rn || null, tla: tla || null };
  }

  _statusLabel(info) {
    if (!info || typeof info !== 'object') return { label: '', retired: false };
    const retired = info.retired === true;
    const stopped = info.stopped === true;
    const inPit = info.in_pit === true;
    const pitOut = info.pit_out === true;
    const status = typeof info.status === 'string' ? info.status.toLowerCase() : '';

    if (retired || status === 'retired' || status === 'out') {
      return { label: 'OUT', retired: true, key: 'retired' };
    }
    if (stopped || status === 'stopped') return { label: 'STOP', retired: false, key: 'stopped' };
    if (pitOut || status === 'pit_out') return { label: 'PIT', retired: false, key: 'pit-out' };
    if (inPit || status === 'in_pit' || status === 'pit') return { label: 'PIT', retired: false, key: 'pit-in' };
    if (status && status !== 'on_track') {
      return { label: status.replace(/_/g, ' ').toUpperCase(), retired: false, key: 'other' };
    }
    return { label: '', retired: false, key: '' };
  }

  _matchesFastest(rn, tla, fastestInfo) {
    if (!fastestInfo) return false;
    if (fastestInfo.rn && rn && fastestInfo.rn === rn) return true;
    if (fastestInfo.tla && tla && fastestInfo.tla === tla) return true;
    return false;
  }

  _normalizeColor(value) {
    if (!value) return null;
    const text = String(value).trim();
    if (text.startsWith('#') || text.startsWith('rgb')) return text;
    if (/^[0-9a-fA-F]{6}$/.test(text)) return `#${text}`;
    return text;
  }

  _handleCardAction() {
    const action = this.config?.tap_action || { action: 'more-info' };
    if (action.action === 'none') return;
    if (action.action === 'more-info') {
      const entityId = this.config.positions_entity || this.config.drivers_entity;
      this.dispatchEvent(new CustomEvent('hass-more-info', {
        bubbles: true,
        composed: true,
        detail: { entityId },
      }));
    }
  }
}

class F1DriverLapTimesCardEditor extends LitElement {
  static properties = {
    hass: {},
    _config: {},
    _activeTab: { state: true },
  };

  static styles = css`
    .card-config {
      display: flex;
      flex-direction: column;
    }

    .tabs {
      display: flex;
      border-bottom: 1px solid var(--divider-color);
      margin-bottom: 16px;
    }

    .tabs button {
      flex: 1;
      padding: 12px;
      background: none;
      border: none;
      cursor: pointer;
      color: var(--primary-text-color);
      font-size: 14px;
      font-family: inherit;
      transition: color 0.2s;
    }

    .tabs button:hover {
      color: var(--primary-color);
    }

    .tabs button.active {
      color: var(--primary-color);
      border-bottom: 2px solid var(--primary-color);
      margin-bottom: -1px;
    }

    .section {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-bottom: 16px;
    }

    .section-header {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 0.5px;
      color: var(--secondary-text-color);
      text-transform: uppercase;
      margin-top: 8px;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .helper {
      font-size: 12px;
      color: var(--secondary-text-color);
      padding-left: 16px;
      line-height: 1.4;
    }

    .warning {
      font-size: 12px;
      color: var(--error-color);
      padding-left: 16px;
    }

    .display-section {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    ha-textfield {
      display: block;
      margin-bottom: 8px;
    }

    ha-formfield {
      display: flex;
      align-items: center;
      padding: 4px 0;
    }

    ha-select {
      width: 100%;
    }
  `;

  constructor() {
    super();
    this._activeTab = 'sources';
  }

  setConfig(config) {
    this._config = { ...config };
  }

  render() {
    if (!this.hass || !this._config) return html``;

    return html`
      <div class="card-config">
        <div class="tabs">
          <button
            class=${this._activeTab === 'sources' ? 'active' : ''}
            @click=${() => this._activeTab = 'sources'}
          >
            Data Sources
          </button>
          <button
            class=${this._activeTab === 'display' ? 'active' : ''}
            @click=${() => this._activeTab = 'display'}
          >
            Display
          </button>
        </div>

        ${this._activeTab === 'sources'
          ? this._renderDataSourcesTab()
          : this._renderDisplayTab()}
      </div>
    `;
  }

  _renderDataSourcesTab() {
    return html`
      <div class="section">
        <div class="section-header">REQUIRED SENSORS</div>
        ${this._renderEntityPicker(
          'drivers_entity',
          'Driver List Sensor',
          'Provides driver names, TLAs, and team colors',
          true,
          'sensor'
        )}
        ${this._renderEntityPicker(
          'positions_entity',
          'Driver Positions Sensor',
          'Provides race positions and status flags',
          true,
          'sensor'
        )}
      </div>
    `;
  }

  _renderDisplayTab() {
    return html`
      <div class="display-section">
        <ha-textfield
          .label=${'Title'}
          .value=${this._config.title || ''}
          @input=${(e) => this._valueChanged('title', e.target.value)}
        ></ha-textfield>

        ${this._renderSwitch('show_header', 'Show header')}
        ${this._renderSwitch('show_table_header', 'Show table header')}
        ${this._renderSwitch('show_position', 'Show position')}
        ${this._renderSwitch('show_team_logo', 'Show team logo')}

        <ha-select
          .label=${'Team logo style'}
          .value=${this._config.team_logo_style || 'color'}
          @selected=${(e) => this._valueChanged('team_logo_style', e.target.value)}
          @closed=${(e) => e.stopPropagation()}
        >
          <mwc-list-item value="color">Color (fallback to white)</mwc-list-item>
          <mwc-list-item value="white">White</mwc-list-item>
        </ha-select>

        ${this._renderSwitch('show_tla', 'Show TLA', 'Driver codes like VER, HAM')}
        ${this._renderSwitch('show_status', 'Show status')}
        ${this._renderSwitch('show_last_lap', 'Show last lap time')}
      </div>
    `;
  }

  _renderEntityPicker(name, label, helper, required, domain) {
    const value = this._config[name];
    const showWarning = required && !value;
    const schema = [{ name, label, required, selector: { entity: { domain } } }];

    return html`
      <div class="field">
        <ha-form
          .hass=${this.hass}
          .data=${this._config}
          .schema=${schema}
          .computeLabel=${() => label}
          @value-changed=${this._formValueChanged}
        ></ha-form>
        <div class="helper">${helper}</div>
        ${showWarning ? html`
          <div class="warning">This sensor is required for the card to function</div>
        ` : ''}
      </div>
    `;
  }

  _renderSwitch(name, label, helper = null) {
    const schema = [{ name, label, selector: { boolean: {} } }];
    return html`
      <ha-form
        .hass=${this.hass}
        .data=${this._config}
        .schema=${schema}
        .computeLabel=${() => label}
        @value-changed=${this._formValueChanged}
      ></ha-form>
      ${helper ? html`<div class="helper">${helper}</div>` : ''}
    `;
  }

  _formValueChanged(ev) {
    if (!this._config) return;
    const value = ev.detail?.value || {};
    const newConfig = { ...this._config, ...value };
    this._config = newConfig;
    this.dispatchEvent(new CustomEvent('config-changed', { detail: { config: newConfig } }));
  }

  _valueChanged(name, value) {
    if (!this._config) return;
    const newConfig = { ...this._config, [name]: value };
    this._config = newConfig;
    this.dispatchEvent(new CustomEvent('config-changed', { detail: { config: newConfig } }));
  }
}

// ============================================================================
// F1 Championship Prediction Drivers Card
// ============================================================================

class F1ChampionshipPredictionDriversCard extends LitElement {
  static properties = {
    hass: {},
    config: {},
  };

  static styles = css`
    /* Animation keyframes */
    @keyframes fadeSlideIn {
      from { opacity: 0; transform: translateY(-8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    :host {
      --ts-bg: #0b0b0d;
      --ts-bg-soft: #131315;
      --ts-border: rgba(255, 255, 255, 0.08);
      --ts-text: #f5f5f5;
      --ts-muted: rgba(255, 255, 255, 0.65);
      --ts-chip: rgba(255, 255, 255, 0.06);
      --ts-shadow: 0 16px 40px rgba(0, 0, 0, 0.35);
      display: block;
      font-family: 'Formula1 Display', 'Noto Sans', sans-serif;
    }

    ha-card {
      padding: 0;
      background: transparent;
      box-shadow: none;
      border: none;
    }

    .cpd-card {
      position: relative;
      padding: clamp(12px, 2.2vw, 18px) clamp(12px, 2.2vw, 18px) clamp(12px, 2vw, 16px);
      border-radius: var(--ha-card-border-radius, 12px);
      background: radial-gradient(circle at 15% 10%, rgba(255, 255, 255, 0.08), transparent 45%),
        linear-gradient(160deg, var(--ts-bg) 0%, var(--ts-bg-soft) 60%, #0a0a0a 100%);
      border: 1px solid var(--ts-border);
      box-shadow: var(--ts-shadow);
      overflow: hidden;
      color: var(--ts-text);
    }

    .cpd-header {
      text-align: center;
      font-family: 'Formula1 Wide', 'Formula1 Display', 'Noto Sans', sans-serif;
      font-size: clamp(16px, 2.4vw, 20px);
      font-weight: 700;
      letter-spacing: clamp(0.03em, 0.06em, 0.08em);
      text-transform: uppercase;
      margin-bottom: clamp(8px, 1.4vw, 12px);
      text-shadow: 0 6px 16px rgba(0, 0, 0, 0.6);
      white-space: normal;
      text-wrap: balance;
      line-height: 1.1;
      padding: 0 4px;
    }

    .cpd-table {
      display: grid;
      gap: 6px;
    }

    .cpd-row {
      display: grid;
      grid-template-columns: var(--cpd-columns);
      align-items: center;
      column-gap: 4px;
      padding: 6px 8px;
      border-radius: 10px;
      background: var(--ts-chip);
      font-size: clamp(10px, 1.6vw, 11px);
      color: var(--ts-text);
      animation: fadeSlideIn 0.25s ease-out backwards;
      transition: background 0.2s ease;
    }

    .cpd-row.header {
      background: transparent;
      padding: 4px 6px 2px;
      font-size: clamp(9px, 1.4vw, 10px);
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--ts-muted);
    }

    .cpd-cell {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      min-width: 0;
      display: flex;
      align-items: center;
    }

    .cpd-cell.numeric {
      justify-content: center;
      text-align: center;
      font-variant-numeric: tabular-nums;
    }

    .cpd-cell.group-start {
      padding-left: 6px;
      border-left: 1px solid rgba(255, 255, 255, 0.12);
    }

    .cpd-team-logo {
      width: 14px;
      height: 14px;
      object-fit: contain;
      filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.4));
    }

    .cpd-tla {
      font-weight: 700;
      letter-spacing: 0.08em;
      color: var(--driver-color, var(--ts-text));
    }

    .cpd-delta.positive {
      color: #34d399;
    }

    .cpd-delta.negative {
      color: #f87171;
    }

    .cpd-delta.neutral {
      color: var(--ts-muted);
    }

    .cpd-delta-wrap {
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .cpd-pos-arrow {
      font-size: 10px;
      line-height: 1;
      font-weight: 700;
    }

    .cpd-pos-arrow.up {
      color: #34d399;
    }

    .cpd-pos-arrow.down {
      color: #f87171;
    }

    .cpd-empty {
      padding: 16px;
      border-radius: var(--ha-card-border-radius, 12px);
      background: var(--ts-chip);
      border: 1px dashed rgba(255, 255, 255, 0.12);
      color: var(--ts-muted);
      text-align: center;
      font-size: 13px;
    }

    @media (max-width: 720px) {
      .cpd-card {
        padding: 12px 10px 12px;
      }

      .cpd-header {
        font-size: 16px;
        letter-spacing: 0.03em;
      }

      .cpd-row {
        font-size: 9px;
        padding: 5px 6px;
      }
    }
  `;

  setConfig(config) {
    this.config = {
      title: 'Championship Prediction Drivers',
      entity: 'sensor.f1_championship_championship_prediction_drivers',
      drivers_entity: 'sensor.f1_drivers_driver_list',
      show_header: true,
      show_table_header: true,
      show_position: true,
      show_tla: true,
      show_team_logo: true,
      team_logo_style: 'color',
      show_predicted_points: true,
      show_current_points: true,
      show_delta: true,
      top_limit: 0,
      ...config,
    };
  }

  connectedCallback() {
    super.connectedCallback();
    ensureF1Fonts();
  }

  getCardSize() {
    return 6;
  }

  getGridOptions() {
    return {
      columns: 12,
      min_columns: 4,
      max_columns: 12,
      min_rows: 5,
    };
  }

  static getStubConfig() {
    return {
      type: 'custom:f1-championship-prediction-drivers-card',
      entity: 'sensor.f1_championship_championship_prediction_drivers',
      drivers_entity: 'sensor.f1_drivers_driver_list',
      title: 'Championship Prediction Drivers',
    };
  }

  static getConfigElement() {
    return document.createElement('f1-championship-prediction-drivers-card-editor');
  }

  render() {
    if (!this.hass || !this.config) return html``;

    if (!this.config.entity) {
      return html`
        <ha-card>
          <div class="cpd-card">
            ${this.config.show_header
              ? html`<div class="cpd-header">${this.config.title || 'Championship Prediction Drivers'}</div>`
              : null}
            <div class="cpd-empty">Select entities in the editor</div>
          </div>
        </ha-card>
      `;
    }

    const predictionState = this.hass.states?.[this.config.entity];
    if (!predictionState) {
      return html`
        <ha-card>
          <div class="cpd-card">
            ${this.config.show_header
              ? html`<div class="cpd-header">${this.config.title || 'Championship Prediction Drivers'}</div>`
              : null}
            <div class="cpd-empty">Entity not found</div>
          </div>
        </ha-card>
      `;
    }

    const predictions = predictionState?.attributes?.drivers;
    if (!predictions || typeof predictions !== 'object') {
      return html`
        <ha-card>
          <div class="cpd-card">
            ${this.config.show_header
              ? html`<div class="cpd-header">${this.config.title || 'Championship Prediction Drivers'}</div>`
              : null}
            <div class="cpd-empty">No prediction data</div>
          </div>
        </ha-card>
      `;
    }

    const driverListState = this.config.drivers_entity
      ? this.hass.states?.[this.config.drivers_entity]
      : null;
    const driverList = Array.isArray(driverListState?.attributes?.drivers)
      ? driverListState.attributes.drivers
      : [];
    const driverMap = this._buildDriverMap(driverList);
    const rows = this._applyTopLimit(this._buildRows(predictions, driverMap));
    const columns = this._columns();
    const gridColumns = columns.map((col) => col.width).join(' ');

    if (rows.length === 0) {
      return html`
        <ha-card>
          <div class="cpd-card">
            ${this.config.show_header
              ? html`<div class="cpd-header">${this.config.title || 'Championship Prediction Drivers'}</div>`
              : null}
            <div class="cpd-empty">No prediction data</div>
          </div>
        </ha-card>
      `;
    }

    return html`
      <ha-card @click=${this._handleCardAction}>
        <div class="cpd-card">
          ${this.config.show_header
            ? html`<div class="cpd-header">${this.config.title || 'Championship Prediction Drivers'}</div>`
            : null}
          <div class="cpd-table" style="--cpd-columns: ${gridColumns};">
            ${this.config.show_table_header ? this._renderHeader(columns) : null}
            ${rows.map((row) => this._renderRow(row, columns))}
          </div>
        </div>
      </ha-card>
    `;
  }

  _columns() {
    const cols = [];
    if (this.config.show_position !== false) {
      cols.push({ key: 'position', label: 'POS', width: '0.16fr', numeric: true, hideHeader: true });
    }
    if (this.config.show_team_logo !== false) {
      cols.push({ key: 'logo', label: 'LOGO', width: '0.16fr', hideHeader: true });
    }
    if (this.config.show_tla !== false) {
      cols.push({ key: 'tla', label: 'DRIVER', width: '0.62fr' });
    }
    if (this.config.show_predicted_points !== false) {
      cols.push({ key: 'predicted_points', label: 'PRED', width: '0.44fr', numeric: true, groupStart: true });
    }
    if (this.config.show_current_points !== false) {
      cols.push({ key: 'current_points', label: 'CUR', width: '0.44fr', numeric: true });
    }
    if (this.config.show_delta !== false) {
      cols.push({ key: 'delta', label: '', width: '0.34fr', numeric: true });
    }
    return cols;
  }

  _renderHeader(columns) {
    return html`
      <div class="cpd-row header">
        ${columns.map((col) => html`
          <div class="cpd-cell ${col.numeric ? 'numeric' : ''} ${col.groupStart ? 'group-start' : ''}">
            ${col.hideHeader ? '' : col.label}
          </div>
        `)}
      </div>
    `;
  }

  _renderRow(row, columns) {
    return html`
      <div class="cpd-row">
        ${columns.map((col) => this._renderCell(row, col))}
      </div>
    `;
  }

  _renderCell(row, col) {
    const classes = ['cpd-cell'];
    if (col.numeric) classes.push('numeric');
    if (col.groupStart) classes.push('group-start');

    if (col.key === 'logo') {
      return html`
        <div class="${classes.join(' ')}">
          ${row.team_logo ? html`
            <img
              class="cpd-team-logo"
              src="${row.team_logo.src}"
              data-fallback="${row.team_logo.fallback || ''}"
              loading="lazy"
              @error=${handleTeamLogoError}
              alt=""
            />
          ` : html`<span>--</span>`}
        </div>
      `;
    }

    if (col.key === 'tla') {
      const style = row.team_color ? `--driver-color: ${row.team_color};` : '';
      return html`
        <div class="${classes.join(' ')} cpd-tla" style="${style}">
          ${row.display_tla || '--'}
        </div>
      `;
    }

    if (col.key === 'delta') {
      const deltaClass = row.delta > 0 ? 'positive' : row.delta < 0 ? 'negative' : 'neutral';
      const positionMove = this._getPositionMovement(row.current_position, row.predicted_position);
      return html`
        <div class="${classes.join(' ')} cpd-delta ${deltaClass}">
          <span class="cpd-delta-wrap">
            <span>${row.delta_display}</span>
            ${positionMove ? html`
              <span class="cpd-pos-arrow ${positionMove.className}" title="${positionMove.title}">
                ${positionMove.symbol}
              </span>
            ` : null}
          </span>
        </div>
      `;
    }

    let value = '--';
    if (col.key === 'position') value = row.predicted_position ?? '--';
    if (col.key === 'predicted_points') value = row.predicted_points_display;
    if (col.key === 'current_points') value = row.current_points_display;
    return html`<div class="${classes.join(' ')}">${value}</div>`;
  }

  _buildRows(predictions, driverMap) {
    const rows = [];
    Object.entries(predictions || {}).forEach(([key, entry]) => {
      if (!entry || typeof entry !== 'object') return;
      const rn = String(entry?.RacingNumber ?? key).trim();
      const identity = driverMap.get(rn) || {};
      const predictedPosition = this._parsePosition(entry?.PredictedPosition);
      const currentPosition = this._parsePosition(entry?.CurrentPosition);
      const predictedPoints = this._toNumber(entry?.PredictedPoints);
      const currentPoints = this._toNumber(entry?.CurrentPoints);
      const delta = Number.isFinite(predictedPoints) && Number.isFinite(currentPoints)
        ? predictedPoints - currentPoints
        : null;

      const tla = this._normalizeTla(entry?.Tla || identity?.tla);
      const teamName = entry?.TeamName || identity?.team || null;
      const teamColor = this._normalizeColor(entry?.TeamColor || identity?.team_color);

      rows.push({
        rn,
        predicted_position: predictedPosition,
        current_position: currentPosition,
        display_tla: tla || (rn ? `#${rn}` : '--'),
        team_logo: getTeamLogoMeta(teamName, 24, this.config.team_logo_style),
        team_color: teamColor,
        predicted_points: predictedPoints,
        current_points: currentPoints,
        delta,
        predicted_points_display: this._formatPoints(predictedPoints),
        current_points_display: this._formatPoints(currentPoints),
        delta_display: this._formatDelta(delta),
      });
    });

    rows.sort((a, b) => {
      if (a.predicted_position !== null && b.predicted_position !== null) {
        const diff = a.predicted_position - b.predicted_position;
        if (diff !== 0) return diff;
      } else if (a.predicted_position !== null) {
        return -1;
      } else if (b.predicted_position !== null) {
        return 1;
      }

      if (a.current_position !== null && b.current_position !== null) {
        const diff = a.current_position - b.current_position;
        if (diff !== 0) return diff;
      } else if (a.current_position !== null) {
        return -1;
      } else if (b.current_position !== null) {
        return 1;
      }

      return this._compareRacingNumber(a.rn, b.rn);
    });

    return rows;
  }

  _applyTopLimit(rows) {
    const list = Array.isArray(rows) ? rows : [];
    const limit = this._parseTopLimit(this.config?.top_limit);
    if (limit <= 0) return list;
    return list.slice(0, limit);
  }

  _buildDriverMap(drivers) {
    const map = new Map();
    (Array.isArray(drivers) ? drivers : []).forEach((driver) => {
      const rn = String(driver?.racing_number ?? '').trim();
      if (!rn) return;
      map.set(rn, {
        tla: driver?.tla,
        team: driver?.team || driver?.team_name,
        team_color: driver?.team_color,
      });
    });
    return map;
  }

  _parseTopLimit(value) {
    const parsed = Number.parseInt(value, 10);
    if (!Number.isFinite(parsed) || parsed < 0) return 0;
    return parsed;
  }

  _parsePosition(value) {
    if (value === null || value === undefined) return null;
    const text = String(value).trim();
    if (!text) return null;
    const match = text.match(/\d+/);
    if (!match) return null;
    const num = Number(match[0]);
    return Number.isFinite(num) ? num : null;
  }

  _toNumber(value) {
    const num = Number(value);
    return Number.isFinite(num) ? num : null;
  }

  _formatPoints(value) {
    if (!Number.isFinite(value)) return '--';
    if (Math.abs(value - Math.round(value)) < 0.0001) {
      return String(Math.round(value));
    }
    return Number(value).toFixed(1);
  }

  _formatDelta(value) {
    if (!Number.isFinite(value)) return '--';
    const sign = value < 0 ? '-' : '+';
    const abs = Math.abs(value);
    return `${sign}${this._formatPoints(abs)}`;
  }

  _getPositionMovement(currentPosition, predictedPosition) {
    if (!Number.isFinite(currentPosition) || !Number.isFinite(predictedPosition)) {
      return null;
    }
    const change = currentPosition - predictedPosition;
    if (change > 0) {
      return { symbol: '', className: 'up', title: `Improves by ${change} position${change > 1 ? 's' : ''}` };
    }
    if (change < 0) {
      const loss = Math.abs(change);
      return { symbol: '', className: 'down', title: `Drops by ${loss} position${loss > 1 ? 's' : ''}` };
    }
    return null;
  }

  _normalizeTla(value) {
    if (!value) return null;
    const tla = String(value).trim().toUpperCase();
    return tla || null;
  }

  _normalizeColor(value) {
    if (!value) return null;
    const text = String(value).trim();
    if (text.startsWith('#') || text.startsWith('rgb')) return text;
    if (/^[0-9a-fA-F]{6}$/.test(text)) return `#${text}`;
    return text;
  }

  _compareRacingNumber(a, b) {
    const aNum = Number(a);
    const bNum = Number(b);
    if (Number.isFinite(aNum) && Number.isFinite(bNum)) return aNum - bNum;
    return String(a).localeCompare(String(b));
  }

  _handleCardAction() {
    const action = this.config?.tap_action || { action: 'more-info' };
    if (action.action === 'none') return;
    if (action.action === 'more-info') {
      this.dispatchEvent(new CustomEvent('hass-more-info', {
        bubbles: true,
        composed: true,
        detail: { entityId: this.config.entity },
      }));
    }
  }
}

// ============================================================================
// F1 Championship Prediction Teams Card
// ============================================================================

class F1ChampionshipPredictionTeamsCard extends LitElement {
  static properties = {
    hass: {},
    config: {},
  };

  static styles = css`
    /* Animation keyframes */
    @keyframes fadeSlideIn {
      from { opacity: 0; transform: translateY(-8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    :host {
      --ts-bg: #0b0b0d;
      --ts-bg-soft: #131315;
      --ts-border: rgba(255, 255, 255, 0.08);
      --ts-text: #f5f5f5;
      --ts-muted: rgba(255, 255, 255, 0.65);
      --ts-chip: rgba(255, 255, 255, 0.06);
      --ts-shadow: 0 16px 40px rgba(0, 0, 0, 0.35);
      display: block;
      font-family: 'Formula1 Display', 'Noto Sans', sans-serif;
    }

    ha-card {
      padding: 0;
      background: transparent;
      box-shadow: none;
      border: none;
    }

    .cpt-card {
      position: relative;
      padding: clamp(12px, 2.2vw, 18px) clamp(12px, 2.2vw, 18px) clamp(12px, 2vw, 16px);
      border-radius: var(--ha-card-border-radius, 12px);
      background: radial-gradient(circle at 15% 10%, rgba(255, 255, 255, 0.08), transparent 45%),
        linear-gradient(160deg, var(--ts-bg) 0%, var(--ts-bg-soft) 60%, #0a0a0a 100%);
      border: 1px solid var(--ts-border);
      box-shadow: var(--ts-shadow);
      overflow: hidden;
      color: var(--ts-text);
    }

    .cpt-header {
      text-align: center;
      font-family: 'Formula1 Wide', 'Formula1 Display', 'Noto Sans', sans-serif;
      font-size: clamp(16px, 2.4vw, 20px);
      font-weight: 700;
      letter-spacing: clamp(0.03em, 0.06em, 0.08em);
      text-transform: uppercase;
      margin-bottom: clamp(8px, 1.4vw, 12px);
      text-shadow: 0 6px 16px rgba(0, 0, 0, 0.6);
      white-space: normal;
      text-wrap: balance;
      line-height: 1.1;
      padding: 0 4px;
    }

    .cpt-table {
      display: grid;
      gap: 6px;
    }

    .cpt-row {
      display: grid;
      grid-template-columns: var(--cpt-columns);
      align-items: center;
      column-gap: 4px;
      padding: 6px 8px;
      border-radius: 10px;
      background: var(--ts-chip);
      font-size: clamp(10px, 1.6vw, 11px);
      color: var(--ts-text);
      animation: fadeSlideIn 0.25s ease-out backwards;
      transition: background 0.2s ease;
    }

    .cpt-row.header {
      background: transparent;
      padding: 4px 6px 2px;
      font-size: clamp(9px, 1.4vw, 10px);
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--ts-muted);
    }

    .cpt-cell {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      min-width: 0;
      display: flex;
      align-items: center;
    }

    .cpt-cell.numeric {
      justify-content: center;
      text-align: center;
      font-variant-numeric: tabular-nums;
    }

    .cpt-cell.group-start {
      padding-left: 6px;
      border-left: 1px solid rgba(255, 255, 255, 0.12);
    }

    .cpt-team-logo {
      width: 16px;
      height: 16px;
      object-fit: contain;
      filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.4));
    }

    .cpt-team-name {
      font-weight: 700;
      letter-spacing: 0.03em;
    }

    .cpt-delta.positive {
      color: #34d399;
    }

    .cpt-delta.negative {
      color: #f87171;
    }

    .cpt-delta.neutral {
      color: var(--ts-muted);
    }

    .cpt-delta-wrap {
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .cpt-pos-arrow {
      font-size: 10px;
      line-height: 1;
      font-weight: 700;
    }

    .cpt-pos-arrow.up {
      color: #34d399;
    }

    .cpt-pos-arrow.down {
      color: #f87171;
    }

    .cpt-empty {
      padding: 16px;
      border-radius: var(--ha-card-border-radius, 12px);
      background: var(--ts-chip);
      border: 1px dashed rgba(255, 255, 255, 0.12);
      color: var(--ts-muted);
      text-align: center;
      font-size: 13px;
    }

    @media (max-width: 720px) {
      .cpt-card {
        padding: 12px 10px 12px;
      }

      .cpt-header {
        font-size: 16px;
        letter-spacing: 0.03em;
      }

      .cpt-row {
        font-size: 9px;
        padding: 5px 6px;
      }
    }
  `;

  setConfig(config) {
    this.config = {
      title: 'Championship Prediction Teams',
      entity: 'sensor.f1_championship_championship_prediction_teams',
      show_header: true,
      show_table_header: true,
      show_position: true,
      show_team_name: true,
      show_team_logo: true,
      team_logo_style: 'color',
      show_predicted_points: true,
      show_current_points: true,
      show_delta: true,
      top_limit: 0,
      ...config,
    };
  }

  connectedCallback() {
    super.connectedCallback();
    ensureF1Fonts();
  }

  getCardSize() {
    return 6;
  }

  getGridOptions() {
    return {
      columns: 12,
      min_columns: 4,
      max_columns: 12,
      min_rows: 5,
    };
  }

  static getStubConfig() {
    return {
      type: 'custom:f1-championship-prediction-teams-card',
      entity: 'sensor.f1_championship_championship_prediction_teams',
      title: 'Championship Prediction Teams',
    };
  }

  static getConfigElement() {
    return document.createElement('f1-championship-prediction-teams-card-editor');
  }

  render() {
    if (!this.hass || !this.config) return html``;

    if (!this.config.entity) {
      return html`
        <ha-card>
          <div class="cpt-card">
            ${this.config.show_header
              ? html`<div class="cpt-header">${this.config.title || 'Championship Prediction Teams'}</div>`
              : null}
            <div class="cpt-empty">Select entities in the editor</div>
          </div>
        </ha-card>
      `;
    }

    const predictionState = this.hass.states?.[this.config.entity];
    if (!predictionState) {
      return html`
        <ha-card>
          <div class="cpt-card">
            ${this.config.show_header
              ? html`<div class="cpt-header">${this.config.title || 'Championship Prediction Teams'}</div>`
              : null}
            <div class="cpt-empty">Entity not found</div>
          </div>
        </ha-card>
      `;
    }

    const predictions = predictionState?.attributes?.teams;
    if (!predictions || typeof predictions !== 'object') {
      return html`
        <ha-card>
          <div class="cpt-card">
            ${this.config.show_header
              ? html`<div class="cpt-header">${this.config.title || 'Championship Prediction Teams'}</div>`
              : null}
            <div class="cpt-empty">No prediction data</div>
          </div>
        </ha-card>
      `;
    }

    const rows = this._applyTopLimit(this._buildRows(predictions));
    const columns = this._columns();
    const gridColumns = columns.map((col) => col.width).join(' ');

    if (rows.length === 0) {
      return html`
        <ha-card>
          <div class="cpt-card">
            ${this.config.show_header
              ? html`<div class="cpt-header">${this.config.title || 'Championship Prediction Teams'}</div>`
              : null}
            <div class="cpt-empty">No prediction data</div>
          </div>
        </ha-card>
      `;
    }

    return html`
      <ha-card @click=${this._handleCardAction}>
        <div class="cpt-card">
          ${this.config.show_header
            ? html`<div class="cpt-header">${this.config.title || 'Championship Prediction Teams'}</div>`
            : null}
          <div class="cpt-table" style="--cpt-columns: ${gridColumns};">
            ${this.config.show_table_header ? this._renderHeader(columns) : null}
            ${rows.map((row) => this._renderRow(row, columns))}
          </div>
        </div>
      </ha-card>
    `;
  }

  _columns() {
    const cols = [];
    if (this.config.show_position !== false) {
      cols.push({ key: 'position', label: 'POS', width: '0.16fr', numeric: true, hideHeader: true });
    }
    if (this.config.show_team_logo !== false) {
      cols.push({ key: 'logo', label: 'LOGO', width: '0.18fr', hideHeader: true });
    }
    if (this.config.show_team_name !== false) {
      cols.push({ key: 'team_name', label: 'TEAM', width: '0.72fr' });
    }
    if (this.config.show_predicted_points !== false) {
      cols.push({ key: 'predicted_points', label: 'PRED', width: '0.44fr', numeric: true, groupStart: true });
    }
    if (this.config.show_current_points !== false) {
      cols.push({ key: 'current_points', label: 'CUR', width: '0.44fr', numeric: true });
    }
    if (this.config.show_delta !== false) {
      cols.push({ key: 'delta', label: '', width: '0.34fr', numeric: true });
    }
    return cols;
  }

  _renderHeader(columns) {
    return html`
      <div class="cpt-row header">
        ${columns.map((col) => html`
          <div class="cpt-cell ${col.numeric ? 'numeric' : ''} ${col.groupStart ? 'group-start' : ''}">
            ${col.hideHeader ? '' : col.label}
          </div>
        `)}
      </div>
    `;
  }

  _renderRow(row, columns) {
    return html`
      <div class="cpt-row">
        ${columns.map((col) => this._renderCell(row, col))}
      </div>
    `;
  }

  _renderCell(row, col) {
    const classes = ['cpt-cell'];
    if (col.numeric) classes.push('numeric');
    if (col.groupStart) classes.push('group-start');

    if (col.key === 'logo') {
      return html`
        <div class="${classes.join(' ')}">
          ${row.team_logo ? html`
            <img
              class="cpt-team-logo"
              src="${row.team_logo.src}"
              data-fallback="${row.team_logo.fallback || ''}"
              loading="lazy"
              @error=${handleTeamLogoError}
              alt=""
            />
          ` : html`<span>--</span>`}
        </div>
      `;
    }

    if (col.key === 'team_name') {
      return html`<div class="${classes.join(' ')} cpt-team-name">${row.display_team_name || '--'}</div>`;
    }

    if (col.key === 'delta') {
      const deltaClass = row.delta > 0 ? 'positive' : row.delta < 0 ? 'negative' : 'neutral';
      const positionMove = this._getPositionMovement(row.current_position, row.predicted_position);
      return html`
        <div class="${classes.join(' ')} cpt-delta ${deltaClass}">
          <span class="cpt-delta-wrap">
            <span>${row.delta_display}</span>
            ${positionMove ? html`
              <span class="cpt-pos-arrow ${positionMove.className}" title="${positionMove.title}">
                ${positionMove.symbol}
              </span>
            ` : null}
          </span>
        </div>
      `;
    }

    let value = '--';
    if (col.key === 'position') value = row.predicted_position ?? '--';
    if (col.key === 'predicted_points') value = row.predicted_points_display;
    if (col.key === 'current_points') value = row.current_points_display;
    return html`<div class="${classes.join(' ')}">${value}</div>`;
  }

  _buildRows(predictions) {
    const rows = [];
    Object.entries(predictions || {}).forEach(([key, entry]) => {
      if (!entry || typeof entry !== 'object') return;
      const teamKey = String(entry?.TeamKey ?? key).trim();
      const teamName = String(entry?.TeamName ?? '').trim();
      const displayTeamName = teamName || teamKey || '--';
      const predictedPosition = this._parsePosition(entry?.PredictedPosition);
      const currentPosition = this._parsePosition(entry?.CurrentPosition);
      const predictedPoints = this._toNumber(entry?.PredictedPoints);
      const currentPoints = this._toNumber(entry?.CurrentPoints);
      const delta = Number.isFinite(predictedPoints) && Number.isFinite(currentPoints)
        ? predictedPoints - currentPoints
        : null;

      rows.push({
        team_key: teamKey,
        display_team_name: displayTeamName,
        predicted_position: predictedPosition,
        current_position: currentPosition,
        team_logo: getTeamLogoMeta(displayTeamName, 28, this.config.team_logo_style),
        predicted_points: predictedPoints,
        current_points: currentPoints,
        delta,
        predicted_points_display: this._formatPoints(predictedPoints),
        current_points_display: this._formatPoints(currentPoints),
        delta_display: this._formatDelta(delta),
      });
    });

    rows.sort((a, b) => {
      if (a.predicted_position !== null && b.predicted_position !== null) {
        const diff = a.predicted_position - b.predicted_position;
        if (diff !== 0) return diff;
      } else if (a.predicted_position !== null) {
        return -1;
      } else if (b.predicted_position !== null) {
        return 1;
      }

      if (a.current_position !== null && b.current_position !== null) {
        const diff = a.current_position - b.current_position;
        if (diff !== 0) return diff;
      } else if (a.current_position !== null) {
        return -1;
      } else if (b.current_position !== null) {
        return 1;
      }

      return a.display_team_name.localeCompare(b.display_team_name);
    });

    return rows;
  }

  _applyTopLimit(rows) {
    const list = Array.isArray(rows) ? rows : [];
    const limit = this._parseTopLimit(this.config?.top_limit);
    if (limit <= 0) return list;
    return list.slice(0, limit);
  }

  _parseTopLimit(value) {
    const parsed = Number.parseInt(value, 10);
    if (!Number.isFinite(parsed) || parsed < 0) return 0;
    return parsed;
  }

  _parsePosition(value) {
    if (value === null || value === undefined) return null;
    const text = String(value).trim();
    if (!text) return null;
    const match = text.match(/\d+/);
    if (!match) return null;
    const num = Number(match[0]);
    return Number.isFinite(num) ? num : null;
  }

  _toNumber(value) {
    const num = Number(value);
    return Number.isFinite(num) ? num : null;
  }

  _formatPoints(value) {
    if (!Number.isFinite(value)) return '--';
    if (Math.abs(value - Math.round(value)) < 0.0001) {
      return String(Math.round(value));
    }
    return Number(value).toFixed(1);
  }

  _formatDelta(value) {
    if (!Number.isFinite(value)) return '--';
    const sign = value < 0 ? '-' : '+';
    const abs = Math.abs(value);
    return `${sign}${this._formatPoints(abs)}`;
  }

  _getPositionMovement(currentPosition, predictedPosition) {
    if (!Number.isFinite(currentPosition) || !Number.isFinite(predictedPosition)) {
      return null;
    }
    const change = currentPosition - predictedPosition;
    if (change > 0) {
      return { symbol: '', className: 'up', title: `Improves by ${change} position${change > 1 ? 's' : ''}` };
    }
    if (change < 0) {
      const loss = Math.abs(change);
      return { symbol: '', className: 'down', title: `Drops by ${loss} position${loss > 1 ? 's' : ''}` };
    }
    return null;
  }

  _handleCardAction() {
    const action = this.config?.tap_action || { action: 'more-info' };
    if (action.action === 'none') return;
    if (action.action === 'more-info') {
      this.dispatchEvent(new CustomEvent('hass-more-info', {
        bubbles: true,
        composed: true,
        detail: { entityId: this.config.entity },
      }));
    }
  }
}

// ============================================================================
// F1 Championship Prediction Drivers Card Editor
// ============================================================================

class F1ChampionshipPredictionDriversCardEditor extends LitElement {
  static properties = {
    hass: {},
    _config: {},
    _activeTab: { state: true },
  };

  static styles = css`
    .card-config {
      display: flex;
      flex-direction: column;
    }

    .tabs {
      display: flex;
      border-bottom: 1px solid var(--divider-color);
      margin-bottom: 16px;
    }

    .tabs button {
      flex: 1;
      padding: 12px;
      background: none;
      border: none;
      cursor: pointer;
      color: var(--primary-text-color);
      font-size: 14px;
      font-family: inherit;
      transition: color 0.2s;
    }

    .tabs button:hover {
      color: var(--primary-color);
    }

    .tabs button.active {
      color: var(--primary-color);
      border-bottom: 2px solid var(--primary-color);
      margin-bottom: -1px;
    }

    .section {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-bottom: 16px;
    }

    .section-header {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 0.5px;
      color: var(--secondary-text-color);
      text-transform: uppercase;
      margin-top: 8px;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .helper {
      font-size: 12px;
      color: var(--secondary-text-color);
      padding-left: 16px;
      line-height: 1.4;
    }

    .warning {
      font-size: 12px;
      color: var(--error-color);
      padding-left: 16px;
    }

    .display-section {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    ha-textfield {
      display: block;
      margin-bottom: 8px;
    }

    ha-formfield {
      display: flex;
      align-items: center;
      padding: 4px 0;
    }

    ha-select {
      width: 100%;
    }
  `;

  constructor() {
    super();
    this._activeTab = 'sources';
  }

  setConfig(config) {
    this._config = {
      entity: 'sensor.f1_championship_championship_prediction_drivers',
      drivers_entity: 'sensor.f1_drivers_driver_list',
      title: 'Championship Prediction Drivers',
      show_header: true,
      show_table_header: true,
      show_position: true,
      show_tla: true,
      show_team_logo: true,
      team_logo_style: 'color',
      show_predicted_points: true,
      show_current_points: true,
      show_delta: true,
      top_limit: 0,
      ...config,
    };
  }

  render() {
    if (!this.hass || !this._config) return html``;

    return html`
      <div class="card-config">
        <div class="tabs">
          <button
            class=${this._activeTab === 'sources' ? 'active' : ''}
            @click=${() => this._activeTab = 'sources'}
          >
            Data Sources
          </button>
          <button
            class=${this._activeTab === 'display' ? 'active' : ''}
            @click=${() => this._activeTab = 'display'}
          >
            Display
          </button>
        </div>

        ${this._activeTab === 'sources'
          ? this._renderDataSourcesTab()
          : this._renderDisplayTab()}
      </div>
    `;
  }

  _renderDataSourcesTab() {
    return html`
      <div class="section">
        <div class="section-header">REQUIRED SENSORS</div>
        ${this._renderEntityPicker(
          'entity',
          'Drivers Prediction Sensor',
          'Provides live championship prediction for drivers',
          true,
          'sensor'
        )}
      </div>
      <div class="section">
        <div class="section-header">OPTIONAL SENSORS</div>
        ${this._renderEntityPicker(
          'drivers_entity',
          'Driver List Sensor',
          'Provides TLA, team names, and team colors when prediction feed is missing identity details',
          false,
          'sensor'
        )}
      </div>
    `;
  }

  _renderDisplayTab() {
    return html`
      <div class="display-section">
        <ha-textfield
          .label=${'Title'}
          .value=${this._config.title || ''}
          @input=${(e) => this._valueChanged('title', e.target.value)}
        ></ha-textfield>

        ${this._renderSwitch('show_header', 'Show header')}
        ${this._renderSwitch('show_table_header', 'Show table header')}
        ${this._renderSwitch('show_position', 'Show position')}
        ${this._renderSwitch('show_tla', 'Show driver code')}
        ${this._renderSwitch('show_team_logo', 'Show team logo')}

        <ha-select
          .label=${'Team logo style'}
          .value=${this._config.team_logo_style || 'color'}
          @selected=${(e) => this._valueChanged('team_logo_style', e.target.value)}
          @closed=${(e) => e.stopPropagation()}
        >
          <mwc-list-item value="color">Color (fallback to white)</mwc-list-item>
          <mwc-list-item value="white">White</mwc-list-item>
        </ha-select>

        ${this._renderSwitch('show_predicted_points', 'Show predicted points')}
        ${this._renderSwitch('show_current_points', 'Show current points')}
        ${this._renderSwitch('show_delta', 'Show points delta')}

        <ha-textfield
          .label=${'Top entries to show'}
          .value=${String(this._config.top_limit ?? 0)}
          type="number"
          min="0"
          @input=${(e) => this._valueChanged('top_limit', Number.parseInt(e.target.value, 10) || 0)}
        ></ha-textfield>
        <div class="helper">0 = show all entries</div>
      </div>
    `;
  }

  _renderEntityPicker(name, label, helper, required, domain) {
    const value = this._config[name];
    const showWarning = required && !value;
    const schema = [{ name, label, required, selector: { entity: { domain } } }];

    return html`
      <div class="field">
        <ha-form
          .hass=${this.hass}
          .data=${this._config}
          .schema=${schema}
          .computeLabel=${() => label}
          @value-changed=${this._formValueChanged}
        ></ha-form>
        <div class="helper">${helper}</div>
        ${showWarning ? html`
          <div class="warning">This sensor is required for the card to function</div>
        ` : ''}
      </div>
    `;
  }

  _renderSwitch(name, label, helper = null) {
    const schema = [{ name, label, selector: { boolean: {} } }];
    return html`
      <ha-form
        .hass=${this.hass}
        .data=${this._config}
        .schema=${schema}
        .computeLabel=${() => label}
        @value-changed=${this._formValueChanged}
      ></ha-form>
      ${helper ? html`<div class="helper">${helper}</div>` : ''}
    `;
  }

  _formValueChanged(ev) {
    if (!this._config) return;
    const value = ev.detail?.value || {};
    const newConfig = { ...this._config, ...value };
    this._config = newConfig;
    this.dispatchEvent(new CustomEvent('config-changed', { detail: { config: newConfig } }));
  }

  _valueChanged(name, value) {
    if (!this._config) return;
    const newConfig = { ...this._config, [name]: value };
    this._config = newConfig;
    this.dispatchEvent(new CustomEvent('config-changed', { detail: { config: newConfig } }));
  }
}

// ============================================================================
// F1 Championship Prediction Teams Card Editor
// ============================================================================

class F1ChampionshipPredictionTeamsCardEditor extends LitElement {
  static properties = {
    hass: {},
    _config: {},
    _activeTab: { state: true },
  };

  static styles = css`
    .card-config {
      display: flex;
      flex-direction: column;
    }

    .tabs {
      display: flex;
      border-bottom: 1px solid var(--divider-color);
      margin-bottom: 16px;
    }

    .tabs button {
      flex: 1;
      padding: 12px;
      background: none;
      border: none;
      cursor: pointer;
      color: var(--primary-text-color);
      font-size: 14px;
      font-family: inherit;
      transition: color 0.2s;
    }

    .tabs button:hover {
      color: var(--primary-color);
    }

    .tabs button.active {
      color: var(--primary-color);
      border-bottom: 2px solid var(--primary-color);
      margin-bottom: -1px;
    }

    .section {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-bottom: 16px;
    }

    .section-header {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 0.5px;
      color: var(--secondary-text-color);
      text-transform: uppercase;
      margin-top: 8px;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .helper {
      font-size: 12px;
      color: var(--secondary-text-color);
      padding-left: 16px;
      line-height: 1.4;
    }

    .warning {
      font-size: 12px;
      color: var(--error-color);
      padding-left: 16px;
    }

    .display-section {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    ha-textfield {
      display: block;
      margin-bottom: 8px;
    }

    ha-formfield {
      display: flex;
      align-items: center;
      padding: 4px 0;
    }

    ha-select {
      width: 100%;
    }
  `;

  constructor() {
    super();
    this._activeTab = 'sources';
  }

  setConfig(config) {
    this._config = {
      entity: 'sensor.f1_championship_championship_prediction_teams',
      title: 'Championship Prediction Teams',
      show_header: true,
      show_table_header: true,
      show_position: true,
      show_team_name: true,
      show_team_logo: true,
      team_logo_style: 'color',
      show_predicted_points: true,
      show_current_points: true,
      show_delta: true,
      top_limit: 0,
      ...config,
    };
  }

  render() {
    if (!this.hass || !this._config) return html``;

    return html`
      <div class="card-config">
        <div class="tabs">
          <button
            class=${this._activeTab === 'sources' ? 'active' : ''}
            @click=${() => this._activeTab = 'sources'}
          >
            Data Sources
          </button>
          <button
            class=${this._activeTab === 'display' ? 'active' : ''}
            @click=${() => this._activeTab = 'display'}
          >
            Display
          </button>
        </div>

        ${this._activeTab === 'sources'
          ? this._renderDataSourcesTab()
          : this._renderDisplayTab()}
      </div>
    `;
  }

  _renderDataSourcesTab() {
    return html`
      <div class="section">
        <div class="section-header">REQUIRED SENSORS</div>
        ${this._renderEntityPicker(
          'entity',
          'Teams Prediction Sensor',
          'Provides live championship prediction for constructors',
          true,
          'sensor'
        )}
      </div>
    `;
  }

  _renderDisplayTab() {
    return html`
      <div class="display-section">
        <ha-textfield
          .label=${'Title'}
          .value=${this._config.title || ''}
          @input=${(e) => this._valueChanged('title', e.target.value)}
        ></ha-textfield>

        ${this._renderSwitch('show_header', 'Show header')}
        ${this._renderSwitch('show_table_header', 'Show table header')}
        ${this._renderSwitch('show_position', 'Show position')}
        ${this._renderSwitch('show_team_name', 'Show team name')}
        ${this._renderSwitch('show_team_logo', 'Show team logo')}

        <ha-select
          .label=${'Team logo style'}
          .value=${this._config.team_logo_style || 'color'}
          @selected=${(e) => this._valueChanged('team_logo_style', e.target.value)}
          @closed=${(e) => e.stopPropagation()}
        >
          <mwc-list-item value="color">Color (fallback to white)</mwc-list-item>
          <mwc-list-item value="white">White</mwc-list-item>
        </ha-select>

        ${this._renderSwitch('show_predicted_points', 'Show predicted points')}
        ${this._renderSwitch('show_current_points', 'Show current points')}
        ${this._renderSwitch('show_delta', 'Show points delta')}

        <ha-textfield
          .label=${'Top entries to show'}
          .value=${String(this._config.top_limit ?? 0)}
          type="number"
          min="0"
          @input=${(e) => this._valueChanged('top_limit', Number.parseInt(e.target.value, 10) || 0)}
        ></ha-textfield>
        <div class="helper">0 = show all entries</div>
      </div>
    `;
  }

  _renderEntityPicker(name, label, helper, required, domain) {
    const value = this._config[name];
    const showWarning = required && !value;
    const schema = [{ name, label, required, selector: { entity: { domain } } }];

    return html`
      <div class="field">
        <ha-form
          .hass=${this.hass}
          .data=${this._config}
          .schema=${schema}
          .computeLabel=${() => label}
          @value-changed=${this._formValueChanged}
        ></ha-form>
        <div class="helper">${helper}</div>
        ${showWarning ? html`
          <div class="warning">This sensor is required for the card to function</div>
        ` : ''}
      </div>
    `;
  }

  _renderSwitch(name, label, helper = null) {
    const schema = [{ name, label, selector: { boolean: {} } }];
    return html`
      <ha-form
        .hass=${this.hass}
        .data=${this._config}
        .schema=${schema}
        .computeLabel=${() => label}
        @value-changed=${this._formValueChanged}
      ></ha-form>
      ${helper ? html`<div class="helper">${helper}</div>` : ''}
    `;
  }

  _formValueChanged(ev) {
    if (!this._config) return;
    const value = ev.detail?.value || {};
    const newConfig = { ...this._config, ...value };
    this._config = newConfig;
    this.dispatchEvent(new CustomEvent('config-changed', { detail: { config: newConfig } }));
  }

  _valueChanged(name, value) {
    if (!this._config) return;
    const newConfig = { ...this._config, [name]: value };
    this._config = newConfig;
    this.dispatchEvent(new CustomEvent('config-changed', { detail: { config: newConfig } }));
  }
}

// ============================================================================
// F1 Investigations Card
// ============================================================================

class F1InvestigationsCard extends LitElement {
  static properties = {
    hass: {},
    config: {},
  };

  static styles = css`
    /* Animation keyframes */
    @keyframes fadeSlideIn {
      from { opacity: 0; transform: translateY(-8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    :host {
      --ts-bg: #0b0b0d;
      --ts-bg-soft: #131315;
      --ts-border: rgba(255, 255, 255, 0.08);
      --ts-text: #f5f5f5;
      --ts-muted: rgba(255, 255, 255, 0.65);
      --ts-chip: rgba(255, 255, 255, 0.06);
      --ts-shadow: 0 16px 40px rgba(0, 0, 0, 0.35);
      display: block;
      font-family: 'Formula1 Display', 'Noto Sans', sans-serif;
    }

    ha-card {
      padding: 0;
      background: transparent;
      box-shadow: none;
      border: none;
    }

    .inv-card {
      position: relative;
      padding: clamp(12px, 2.2vw, 18px) clamp(12px, 2.2vw, 18px) clamp(12px, 2vw, 16px);
      border-radius: var(--ha-card-border-radius, 12px);
      background: radial-gradient(circle at 15% 10%, rgba(255, 255, 255, 0.08), transparent 45%),
        linear-gradient(160deg, var(--ts-bg) 0%, var(--ts-bg-soft) 60%, #0a0a0a 100%);
      border: 1px solid var(--ts-border);
      box-shadow: var(--ts-shadow);
      overflow: hidden;
      color: var(--ts-text);
    }

    .inv-header {
      text-align: center;
      font-family: 'Formula1 Wide', 'Formula1 Display', 'Noto Sans', sans-serif;
      font-size: clamp(16px, 2.4vw, 20px);
      font-weight: 700;
      letter-spacing: clamp(0.03em, 0.06em, 0.08em);
      text-transform: uppercase;
      margin-bottom: clamp(8px, 1.4vw, 12px);
      text-shadow: 0 6px 16px rgba(0, 0, 0, 0.6);
      white-space: normal;
      text-wrap: balance;
      line-height: 1.1;
      padding: 0 4px;
    }

    .inv-table {
      display: grid;
      gap: 6px;
    }

    .inv-row {
      display: grid;
      grid-template-columns: 0.7fr 2.3fr;
      align-items: center;
      column-gap: 8px;
      padding: 6px 8px;
      border-radius: 10px;
      background: var(--ts-chip);
      font-size: clamp(10px, 1.6vw, 11px);
      color: var(--ts-text);
      animation: fadeSlideIn 0.25s ease-out backwards;
      transition: background 0.2s ease, border-left 0.2s ease;
    }

    .inv-row.under-investigation {
      background: linear-gradient(90deg, rgba(96, 165, 250, 0.12), var(--ts-chip));
      border-left: 3px solid #60a5fa;
    }

    .inv-row.has-penalty {
      background: linear-gradient(90deg, rgba(248, 113, 113, 0.1), var(--ts-chip));
      border-left: 3px solid #f87171;
    }

    .inv-row.header {
      background: transparent;
      padding: 4px 6px 2px;
      font-size: clamp(9px, 1.4vw, 10px);
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--ts-muted);
    }

    .inv-cell {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .inv-tla {
      font-weight: 700;
      letter-spacing: 0.08em;
      color: var(--driver-color, var(--ts-text));
    }

    .inv-tla-wrap {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .inv-team-logo {
      width: 16px;
      height: 16px;
      object-fit: contain;
      filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.4));
    }

    .inv-badges {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      align-items: center;
      overflow: visible;
      white-space: normal;
    }

    .inv-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 9px;
      font-weight: 700;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      background: rgba(255, 255, 255, 0.08);
      color: var(--ts-text);
      border: 1px solid rgba(255, 255, 255, 0.08);
      white-space: nowrap;
    }

    .inv-badge.inv {
      color: #60a5fa;
      border-color: rgba(96, 165, 250, 0.4);
      background: rgba(96, 165, 250, 0.12);
      animation: pulse 2s ease-in-out infinite;
    }

    .inv-badge.pen {
      color: #f87171;
      border-color: rgba(248, 113, 113, 0.45);
      background: rgba(248, 113, 113, 0.12);
    }

    .inv-badge.pending {
      color: #f59e0b;
      border-color: rgba(245, 158, 11, 0.45);
      background: rgba(245, 158, 11, 0.12);
    }

    .inv-badge.noted {
      color: #facc15;
      border-color: rgba(250, 204, 21, 0.45);
      background: rgba(250, 204, 21, 0.12);
    }

    .inv-badge.under {
      color: #facc15;
      border-color: rgba(250, 204, 21, 0.45);
      background: rgba(250, 204, 21, 0.12);
    }

    .inv-badge.after {
      color: #a3a3a3;
      border-color: rgba(163, 163, 163, 0.45);
      background: rgba(163, 163, 163, 0.12);
    }

    .inv-badge.nfi {
      color: #34c759;
      border-color: rgba(52, 199, 89, 0.45);
      background: rgba(52, 199, 89, 0.12);
    }

    .inv-empty {
      padding: 16px;
      border-radius: var(--ha-card-border-radius, 12px);
      background: var(--ts-chip);
      border: 1px dashed rgba(255, 255, 255, 0.12);
      color: var(--ts-muted);
      text-align: center;
      font-size: 13px;
    }
  `;

  setConfig(config) {
    this.config = {
      title: 'Investigations & Penalties',
      show_header: true,
      show_table_header: true,
      show_team_logo: false,
      team_logo_style: 'color',
      show_all_drivers: false,
      investigations_entity: 'sensor.f1_officials_investigations_penalties',
      drivers_entity: 'sensor.f1_drivers_driver_list',
      positions_entity: 'sensor.f1_drivers_driver_positions',
      ...config,
    };
  }

  connectedCallback() {
    super.connectedCallback();
    ensureF1Fonts();
  }

  static getStubConfig() {
    return {
      type: 'custom:f1-investigations-card',
      investigations_entity: 'sensor.f1_officials_investigations_penalties',
      drivers_entity: 'sensor.f1_drivers_driver_list',
      positions_entity: 'sensor.f1_drivers_driver_positions',
      title: 'Investigations & Penalties',
    };
  }

  static getConfigElement() {
    return document.createElement('f1-investigations-card-editor');
  }

  render() {
    if (!this.hass || !this.config) return html``;
    if (!this.config.investigations_entity) {
      return html`<ha-card><div class="inv-card"><div class="inv-empty">Select entities in the editor</div></div></ha-card>`;
    }

    const invState = this.hass.states?.[this.config.investigations_entity];
    if (!invState) {
      return html`<ha-card><div class="inv-card"><div class="inv-empty">Investigations entity not found</div></div></ha-card>`;
    }

    const driversState = this.config.drivers_entity
      ? this.hass.states?.[this.config.drivers_entity]
      : null;
    const drivers = Array.isArray(driversState?.attributes?.drivers)
      ? driversState.attributes.drivers
      : [];
    const positionsState = this.config.positions_entity
      ? this.hass.states?.[this.config.positions_entity]
      : null;
    const positions = positionsState?.attributes?.drivers;

    const rows = this._buildRows(invState, drivers, positions);

    const gridTemplate = '0.85fr 2.3fr';

    return html`
      <ha-card>
        <div class="inv-card">
          ${this.config.show_header
            ? html`<div class="inv-header">${this.config.title || 'Investigations & Penalties'}</div>`
            : null}
          ${rows.length
            ? html`
              <div class="inv-table">
                ${this.config.show_table_header
                  ? html`
                    <div class="inv-row header" style="grid-template-columns: ${gridTemplate};">
                      <div class="inv-cell">Driver</div>
                      <div class="inv-cell">Investigations</div>
                    </div>
                  `
                  : null}
                ${rows.map((row) => {
                  const hasActiveInv = row.badges.some(b => b.className === 'inv');
                  const hasPenalty = row.badges.some(b => b.className === 'pen');
                  const rowClass = hasPenalty ? 'has-penalty' : hasActiveInv ? 'under-investigation' : '';
                  return html`
                  <div class="inv-row ${rowClass}" style="grid-template-columns: ${gridTemplate};">
                <div class="inv-cell inv-tla" style="${row.team_color ? `--driver-color: ${row.team_color};` : ''}">
                  <span class="inv-tla-wrap">
                    ${this.config.show_team_logo && row.team_logo
                      ? html`
                        <img
                          class="inv-team-logo"
                          src="${row.team_logo.src}"
                          data-fallback="${row.team_logo.fallback || ''}"
                          loading="lazy"
                          @error=${handleTeamLogoError}
                          alt=""
                        />
                      `
                      : null}
                    ${row.tla}
                  </span>
                </div>
                    <div class="inv-cell inv-badges">
                      ${row.badges.map((badge) => html`
                        <span class="inv-badge ${badge.className}" title="${badge.title || ''}">${badge.label}</span>
                      `)}
                    </div>
                  </div>
                `})}
              </div>
            `
            : html`<div class="inv-empty">No investigations</div>`}
        </div>
      </ha-card>
    `;
  }

  _buildRows(invState, drivers, positions) {
    const driverMap = new Map();
    drivers.forEach((driver, index) => {
      const tla = String(driver?.tla || '').trim();
      if (!tla) return;
      driverMap.set(tla, { ...driver, index });
    });

    const noted = Array.isArray(invState?.attributes?.noted) ? invState.attributes.noted : [];
    const underInvestigation = Array.isArray(invState?.attributes?.under_investigation)
      ? invState.attributes.under_investigation
      : [];
    const noFurther = Array.isArray(invState?.attributes?.no_further_action)
      ? invState.attributes.no_further_action
      : [];
    const penalties = Array.isArray(invState?.attributes?.penalties)
      ? invState.attributes.penalties
      : [];

    const incidentLists = [noted, underInvestigation, noFurther, penalties];
    incidentLists.forEach((items) => {
      items.forEach((incident, idx) => {
        const driversList = Array.isArray(incident?.drivers)
          ? incident.drivers
          : (incident?.driver ? [incident.driver] : []);
        driversList.forEach((tla) => {
          const key = String(tla || '').trim();
          if (!key) return;
          if (!driverMap.has(key)) {
            driverMap.set(key, { tla: key, racing_number: incident?.racing_number, index: 1000 + idx });
          }
        });
      });
    });

    const positionMap = this._buildPositionMap(positions);
    const rows = [];

    for (const [tla, driver] of driverMap.entries()) {
      const incidentBadges = this._collectIncidentBadges(
        tla,
        noted,
        underInvestigation,
        noFurther,
        penalties,
      );
      const hasActivity = incidentBadges.length > 0;
      if (!this.config.show_all_drivers && !hasActivity) {
        continue;
      }

      const rn = String(driver?.racing_number ?? '').trim();
      const positionInfo = positionMap.get(rn) || positionMap.get(tla) || {};
      const position = this._parsePosition(
        positionInfo?.current_position ?? positionInfo?.grid_position ?? driver?.position,
      );

      const badges = [];
      if (incidentBadges.length > 0) {
        badges.push(...incidentBadges);
      }
      if (badges.length > 0) {
        badges.sort((a, b) => this._badgeOrder(a) - this._badgeOrder(b));
      }
      if (!badges.length) badges.push({ label: '--', className: '' });

      const latestTime = this._latestIncidentTime(
        tla,
        noted,
        underInvestigation,
        noFurther,
        penalties,
      );

      rows.push({
        tla,
        team_color: this._normalizeColor(driver?.team_color || positionInfo?.team_color),
        team_logo: getTeamLogoMeta(
          driver?.team || driver?.team_name || positionInfo?.team,
          28,
          this.config.team_logo_style,
        ),
        position,
        index: driver?.index ?? 0,
        latestTime,
        badges,
      });
    }

    rows.sort((a, b) => {
      if (Number.isFinite(a.latestTime) && Number.isFinite(b.latestTime)) {
        const diff = b.latestTime - a.latestTime;
        if (diff !== 0) return diff;
      } else if (Number.isFinite(a.latestTime)) {
        return -1;
      } else if (Number.isFinite(b.latestTime)) {
        return 1;
      }
      if (a.position !== null && b.position !== null) return a.position - b.position;
      if (a.position !== null) return -1;
      if (b.position !== null) return 1;
      return a.index - b.index;
    });

    return rows;
  }

  _collectIncidentBadges(tla, noted, underInvestigation, noFurther, penalties) {
    const badges = [];
    noted.forEach((item) => {
      if (!this._incidentHasDriver(item, tla)) return;
      badges.push({ label: 'NOTED', className: 'noted', title: this._incidentTitle(item, 'Noted') });
    });
    underInvestigation.forEach((item) => {
      if (!this._incidentHasDriver(item, tla)) return;
      if (item?.after_race) {
        badges.push({ label: 'AFTER RACE', className: 'after', title: this._incidentTitle(item, 'After race') });
        return;
      }
      badges.push({ label: 'UNDER INVESTIGATION', className: 'inv', title: this._incidentTitle(item, 'Under investigation') });
    });
    noFurther.forEach((item) => {
      if (!this._incidentHasDriver(item, tla)) return;
      badges.push({ label: 'NO ACTION', className: 'nfi', title: this._incidentTitle(item, 'No further action') });
    });
    penalties.forEach((item) => {
      if (String(item?.driver || '').trim() !== tla) return;
      const text = item?.penalty ? this._longPenalty(item.penalty) || item.penalty : 'PENALTY';
      badges.push({ label: text, className: 'pen', title: this._incidentTitle(item, `Penalty: ${text}`) });
    });
    return badges;
  }

  _incidentHasDriver(item, tla) {
    if (!item || !tla) return false;
    if (Array.isArray(item.drivers)) return item.drivers.includes(tla);
    if (item.driver) return String(item.driver).trim() === tla;
    return false;
  }

  _latestIncidentTime(tla, noted, underInvestigation, noFurther, penalties) {
    const times = [];
    noted.forEach((item) => {
      if (!this._incidentHasDriver(item, tla)) return;
      const time = this._parseIncidentTime(item?.utc);
      if (Number.isFinite(time)) times.push(time);
    });
    underInvestigation.forEach((item) => {
      if (!this._incidentHasDriver(item, tla)) return;
      const time = this._parseIncidentTime(item?.utc);
      if (Number.isFinite(time)) times.push(time);
    });
    noFurther.forEach((item) => {
      if (!this._incidentHasDriver(item, tla)) return;
      const time = this._parseIncidentTime(item?.nfi_utc || item?.utc);
      if (Number.isFinite(time)) times.push(time);
    });
    penalties.forEach((item) => {
      if (String(item?.driver || '').trim() !== tla) return;
      const time = this._parseIncidentTime(item?.utc);
      if (Number.isFinite(time)) times.push(time);
    });
    if (!times.length) return null;
    return Math.max(...times);
  }

  _parseIncidentTime(value) {
    if (!value) return null;
    const text = String(value).trim();
    if (!text) return null;
    const normalized = text.includes('Z') || /[+-]\d{2}:\d{2}$/.test(text)
      ? text
      : `${text}Z`;
    const ts = Date.parse(normalized);
    return Number.isNaN(ts) ? null : ts;
  }

  _incidentTitle(item, prefix) {
    if (!item || typeof item !== 'object') return prefix || '';
    const parts = [];
    if (prefix) parts.push(prefix);
    if (Array.isArray(item.drivers) && item.drivers.length) {
      parts.push(item.drivers.join('/'));
    }
    if (item.lap !== undefined && item.lap !== null && item.lap !== '') {
      parts.push(`Lap ${item.lap}`);
    }
    if (item.location) parts.push(String(item.location));
    if (item.reason) parts.push(String(item.reason));
    return parts.join('  ');
  }

  _badgeOrder(badge) {
    if (!badge) return 99;
    if (badge.label === 'NOTED') return 0;
    if (badge.className === 'inv' || badge.label === 'INV') return 1;
    if (badge.label === 'AFTER RACE') return 2;
    if (badge.label === 'NFI') return 3;
    if (badge.className === 'pen' || badge.label.includes('PENALTY')) return 4;
    return 5;
  }

  _longPenalty(text) {
    if (!text) return null;
    const upper = String(text).toUpperCase();
    const timeMatch = upper.match(/(\d+)\s*SECOND/);
    if (timeMatch && upper.includes('TIME PENALTY')) return `PENALTY ${timeMatch[1]} SEC`;
    if (timeMatch && upper.includes('STOP/GO')) return `PENALTY STOP/GO ${timeMatch[1]} SEC`;
    if (upper.includes('DRIVE THROUGH')) return 'PENALTY DRIVE THROUGH';
    if (upper.includes('REPRIMAND')) return 'REPRIMAND';
    return null;
  }

  _buildPositionMap(positions) {
    const map = new Map();
    if (Array.isArray(positions)) {
      positions.forEach((item) => {
        const rn = String(item?.racing_number ?? '').trim();
        const tla = String(item?.tla ?? '').trim();
        if (rn) map.set(rn, item);
        if (tla) map.set(tla, item);
      });
    } else if (positions && typeof positions === 'object') {
      Object.entries(positions).forEach(([key, info]) => {
        if (!info || typeof info !== 'object') return;
        const rnFromInfo = String(info.racing_number ?? '').trim();
        const rnFromKeyMatch = String(key).match(/\d+/);
        const rn = rnFromInfo || (rnFromKeyMatch ? rnFromKeyMatch[0] : '');
        const tla = String(info.tla ?? '').trim();
        if (rn) map.set(rn, info);
        if (tla) map.set(tla, info);
      });
    }
    return map;
  }

  _parsePosition(value) {
    if (value === null || value === undefined) return null;
    const text = String(value).trim();
    if (!text) return null;
    const match = text.match(/\d+/);
    if (!match) return null;
    const num = Number(match[0]);
    return Number.isFinite(num) ? num : null;
  }

  _normalizeColor(value) {
    if (!value) return null;
    const text = String(value).trim();
    if (text.startsWith('#') || text.startsWith('rgb')) return text;
    if (/^[0-9a-fA-F]{6}$/.test(text)) return `#${text}`;
    return text;
  }
}

class F1InvestigationsCardEditor extends LitElement {
  static properties = {
    hass: {},
    _config: {},
    _activeTab: { state: true },
  };

  static styles = css`
    .card-config {
      display: flex;
      flex-direction: column;
    }

    .tabs {
      display: flex;
      border-bottom: 1px solid var(--divider-color);
      margin-bottom: 16px;
    }

    .tabs button {
      flex: 1;
      padding: 12px;
      background: none;
      border: none;
      cursor: pointer;
      color: var(--primary-text-color);
      font-size: 14px;
      font-family: inherit;
      transition: color 0.2s;
    }

    .tabs button:hover {
      color: var(--primary-color);
    }

    .tabs button.active {
      color: var(--primary-color);
      border-bottom: 2px solid var(--primary-color);
      margin-bottom: -1px;
    }

    .section {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-bottom: 16px;
    }

    .section-header {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 0.5px;
      color: var(--secondary-text-color);
      text-transform: uppercase;
      margin-top: 8px;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .helper {
      font-size: 12px;
      color: var(--secondary-text-color);
      padding-left: 16px;
      line-height: 1.4;
    }

    .warning {
      font-size: 12px;
      color: var(--error-color);
      padding-left: 16px;
    }

    .display-section {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    ha-textfield {
      display: block;
      margin-bottom: 8px;
    }

    ha-formfield {
      display: flex;
      align-items: center;
      padding: 4px 0;
    }

    ha-select {
      width: 100%;
    }
  `;

  constructor() {
    super();
    this._activeTab = 'sources';
  }

  setConfig(config) {
    this._config = { ...config };
  }

  render() {
    if (!this.hass || !this._config) return html``;

    return html`
      <div class="card-config">
        <div class="tabs">
          <button
            class=${this._activeTab === 'sources' ? 'active' : ''}
            @click=${() => this._activeTab = 'sources'}
          >
            Data Sources
          </button>
          <button
            class=${this._activeTab === 'display' ? 'active' : ''}
            @click=${() => this._activeTab = 'display'}
          >
            Display
          </button>
        </div>

        ${this._activeTab === 'sources'
          ? this._renderDataSourcesTab()
          : this._renderDisplayTab()}
      </div>
    `;
  }

  _renderDataSourcesTab() {
    return html`
      <div class="section">
        <div class="section-header">REQUIRED SENSORS</div>
        ${this._renderEntityPicker(
          'investigations_entity',
          'Investigations Sensor',
          'Provides active investigations and penalties',
          true,
          'sensor'
        )}
      </div>
      <div class="section">
        <div class="section-header">OPTIONAL SENSORS</div>
        ${this._renderEntityPicker(
          'drivers_entity',
          'Driver List Sensor',
          'Provides driver names, TLAs, and team colors. Enables team logo display.',
          false,
          'sensor'
        )}
        ${this._renderEntityPicker(
          'positions_entity',
          'Driver Positions Sensor',
          'Provides race positions and status flags. Enables position ordering.',
          false,
          'sensor'
        )}
      </div>
    `;
  }

  _renderDisplayTab() {
    return html`
      <div class="display-section">
        <ha-textfield
          .label=${'Title'}
          .value=${this._config.title || ''}
          @input=${(e) => this._valueChanged('title', e.target.value)}
        ></ha-textfield>

        ${this._renderSwitch('show_header', 'Show header')}
        ${this._renderSwitch('show_table_header', 'Show table header')}
        ${this._renderSwitch('show_team_logo', 'Show team logos')}

        <ha-select
          .label=${'Team logo style'}
          .value=${this._config.team_logo_style || 'color'}
          @selected=${(e) => this._valueChanged('team_logo_style', e.target.value)}
          @closed=${(e) => e.stopPropagation()}
        >
          <mwc-list-item value="color">Color (fallback to white)</mwc-list-item>
          <mwc-list-item value="white">White</mwc-list-item>
        </ha-select>

        ${this._renderSwitch('show_all_drivers', 'Show all drivers')}
      </div>
    `;
  }

  _renderEntityPicker(name, label, helper, required, domain) {
    const value = this._config[name];
    const showWarning = required && !value;
    const schema = [{ name, label, required, selector: { entity: { domain } } }];

    return html`
      <div class="field">
        <ha-form
          .hass=${this.hass}
          .data=${this._config}
          .schema=${schema}
          .computeLabel=${() => label}
          @value-changed=${this._formValueChanged}
        ></ha-form>
        <div class="helper">${helper}</div>
        ${showWarning ? html`
          <div class="warning">This sensor is required for the card to function</div>
        ` : ''}
      </div>
    `;
  }

  _renderSwitch(name, label, helper = null) {
    const schema = [{ name, label, selector: { boolean: {} } }];
    return html`
      <ha-form
        .hass=${this.hass}
        .data=${this._config}
        .schema=${schema}
        .computeLabel=${() => label}
        @value-changed=${this._formValueChanged}
      ></ha-form>
      ${helper ? html`<div class="helper">${helper}</div>` : ''}
    `;
  }

  _formValueChanged(ev) {
    if (!this._config) return;
    const value = ev.detail?.value || {};
    const newConfig = { ...this._config, ...value };
    this._config = newConfig;
    this.dispatchEvent(new CustomEvent('config-changed', { detail: { config: newConfig } }));
  }

  _valueChanged(name, value) {
    if (!this._config) return;
    const newConfig = { ...this._config, [name]: value };
    this._config = newConfig;
    this.dispatchEvent(new CustomEvent('config-changed', { detail: { config: newConfig } }));
  }
}

// ============================================================================
// F1 Track Limits Card
// ============================================================================

class F1TrackLimitsCard extends LitElement {
  static properties = {
    hass: {},
    config: {},
  };

  static styles = css`
    /* Animation keyframes */
    @keyframes fadeSlideIn {
      from { opacity: 0; transform: translateY(-8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    @keyframes glowPulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(var(--glow-color-rgb, 239, 68, 68), 0.4); }
      50% { box-shadow: 0 0 12px 2px rgba(var(--glow-color-rgb, 239, 68, 68), 0.6); }
    }

    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    :host {
      --ts-bg: #0b0b0d;
      --ts-bg-soft: #131315;
      --ts-border: rgba(255, 255, 255, 0.08);
      --ts-text: #f5f5f5;
      --ts-muted: rgba(255, 255, 255, 0.65);
      --ts-chip: rgba(255, 255, 255, 0.06);
      --ts-shadow: 0 16px 40px rgba(0, 0, 0, 0.35);
      display: block;
      font-family: 'Formula1 Display', 'Noto Sans', sans-serif;
    }

    ha-card {
      padding: 0;
      background: transparent;
      box-shadow: none;
      border: none;
    }

    .tl-card {
      position: relative;
      padding: clamp(12px, 2.2vw, 18px) clamp(12px, 2.2vw, 18px) clamp(12px, 2vw, 16px);
      border-radius: var(--ha-card-border-radius, 12px);
      background: radial-gradient(circle at 15% 10%, rgba(255, 255, 255, 0.08), transparent 45%),
        linear-gradient(160deg, var(--ts-bg) 0%, var(--ts-bg-soft) 60%, #0a0a0a 100%);
      border: 1px solid var(--ts-border);
      box-shadow: var(--ts-shadow);
      overflow: hidden;
      color: var(--ts-text);
    }

    .tl-header {
      text-align: center;
      font-family: 'Formula1 Wide', 'Formula1 Display', 'Noto Sans', sans-serif;
      font-size: clamp(16px, 2.4vw, 20px);
      font-weight: 700;
      letter-spacing: clamp(0.03em, 0.06em, 0.08em);
      text-transform: uppercase;
      margin-bottom: clamp(8px, 1.4vw, 12px);
      text-shadow: 0 6px 16px rgba(0, 0, 0, 0.6);
      white-space: normal;
      text-wrap: balance;
      line-height: 1.1;
      padding: 0 4px;
    }

    .tl-table {
      display: grid;
      gap: 6px;
    }

    .tl-row {
      display: grid;
      grid-template-columns: 0.85fr 2.1fr 0.6fr;
      align-items: center;
      column-gap: 8px;
      padding: 6px 8px;
      border-radius: 10px;
      background: var(--ts-chip);
      font-size: clamp(10px, 1.6vw, 11px);
      color: var(--ts-text);
      animation: fadeSlideIn 0.25s ease-out backwards;
      transition: background 0.2s ease, border-left 0.2s ease;
    }

    .tl-row.has-warning {
      background: linear-gradient(90deg, rgba(250, 204, 21, 0.1), var(--ts-chip));
      border-left: 3px solid #facc15;
    }

    .tl-row.has-penalty {
      background: linear-gradient(90deg, rgba(239, 68, 68, 0.1), var(--ts-chip));
      border-left: 3px solid #ef4444;
      --glow-color-rgb: 239, 68, 68;
      animation: fadeSlideIn 0.25s ease-out backwards, glowPulse 2s ease-in-out infinite;
    }

    .tl-row.header {
      background: transparent;
      padding: 4px 6px 2px;
      font-size: clamp(9px, 1.4vw, 10px);
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--ts-muted);
    }

    .tl-cell {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .tl-tla {
      font-weight: 700;
      letter-spacing: 0.08em;
      color: var(--driver-color, var(--ts-text));
    }

    .tl-tla-wrap {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .tl-team-logo {
      width: 16px;
      height: 16px;
      object-fit: contain;
      filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.4));
    }

    .tl-badges {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      align-items: center;
    }

    .tl-count {
      position: relative;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      display: grid;
      place-items: center;
      font-size: 10px;
      font-weight: 700;
      letter-spacing: 0.06em;
      color: var(--count-color, var(--ts-text));
      border: 2px solid var(--count-color, var(--ts-text));
      background: color-mix(in srgb, var(--count-color, var(--ts-text)) 12%, transparent);
      overflow: hidden;
    }

    .tl-count::before {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: var(--progress-height, 0%);
      background: currentColor;
      opacity: 0.15;
      border-radius: inherit;
      transition: height 0.3s ease-out;
    }

    .tl-count.minor {
      --count-color: #94a3b8;
    }

    .tl-count.limit {
      --count-color: #facc15;
      animation: pulse 2s ease-in-out infinite;
    }

    .tl-count.warning {
      --count-color: #f59e0b;
      animation: pulse 1.5s ease-in-out infinite;
    }

    .tl-count.penalty {
      --count-color: #ef4444;
    }

    .tl-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 3px 6px;
      border-radius: 999px;
      font-size: 9px;
      font-weight: 700;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      background: rgba(255, 255, 255, 0.08);
      color: var(--ts-text);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .tl-badge.del {
      color: #f87171;
      border-color: rgba(248, 113, 113, 0.45);
      background: rgba(248, 113, 113, 0.12);
    }

    .tl-badge.warn {
      color: #facc15;
      border-color: rgba(250, 204, 21, 0.45);
      background: rgba(250, 204, 21, 0.12);
    }

    .tl-badge.pen {
      color: #fb923c;
      border-color: rgba(251, 146, 60, 0.45);
      background: rgba(251, 146, 60, 0.12);
    }

    .tl-empty {
      padding: 16px;
      border-radius: var(--ha-card-border-radius, 12px);
      background: var(--ts-chip);
      border: 1px dashed rgba(255, 255, 255, 0.12);
      color: var(--ts-muted);
      text-align: center;
      font-size: 13px;
    }
  `;

  setConfig(config) {
    this.config = {
      title: 'Track Limits',
      show_header: true,
      show_table_header: true,
      show_team_logo: false,
      team_logo_style: 'color',
      show_all_drivers: false,
      track_limits_entity: 'sensor.f1_officials_track_limits',
      drivers_entity: 'sensor.f1_drivers_driver_list',
      positions_entity: 'sensor.f1_drivers_driver_positions',
      ...config,
    };
  }

  connectedCallback() {
    super.connectedCallback();
    ensureF1Fonts();
  }

  static getStubConfig() {
    return {
      type: 'custom:f1-track-limits-card',
      track_limits_entity: 'sensor.f1_officials_track_limits',
      drivers_entity: 'sensor.f1_drivers_driver_list',
      positions_entity: 'sensor.f1_drivers_driver_positions',
      title: 'Track Limits',
    };
  }

  static getConfigElement() {
    return document.createElement('f1-track-limits-card-editor');
  }

  render() {
    if (!this.hass || !this.config) return html``;
    if (!this.config.track_limits_entity) {
      return html`<ha-card><div class="tl-card"><div class="tl-empty">Select entities in the editor</div></div></ha-card>`;
    }

    const limitsState = this.hass.states?.[this.config.track_limits_entity];
    if (!limitsState) {
      return html`<ha-card><div class="tl-card"><div class="tl-empty">Track limits entity not found</div></div></ha-card>`;
    }

    const driversState = this.config.drivers_entity
      ? this.hass.states?.[this.config.drivers_entity]
      : null;
    const drivers = Array.isArray(driversState?.attributes?.drivers)
      ? driversState.attributes.drivers
      : [];
    const positionsState = this.config.positions_entity
      ? this.hass.states?.[this.config.positions_entity]
      : null;
    const positions = positionsState?.attributes?.drivers;

    const rows = this._buildRows(limitsState, drivers, positions);

    const gridTemplate = '0.7fr 2.3fr';

    return html`
      <ha-card>
        <div class="tl-card">
          ${this.config.show_header
            ? html`<div class="tl-header">${this.config.title || 'Track Limits'}</div>`
            : null}
          ${rows.length
            ? html`
              <div class="tl-table">
                ${this.config.show_table_header
                  ? html`
                    <div class="tl-row header" style="grid-template-columns: ${gridTemplate};">
                      <div class="tl-cell">Driver</div>
                      <div class="tl-cell">Violations</div>
                    </div>
                  `
                  : null}
                ${rows.map((row) => {
                  const rowClass = row.hasPenalty ? 'has-penalty' : row.hasWarning ? 'has-warning' : '';
                  return html`
                  <div class="tl-row ${rowClass}" style="grid-template-columns: ${gridTemplate};">
                <div class="tl-cell tl-tla" style="${row.team_color ? `--driver-color: ${row.team_color};` : ''}">
                  <span class="tl-tla-wrap">
                    ${this.config.show_team_logo && row.team_logo
                      ? html`
                        <img
                          class="tl-team-logo"
                          src="${row.team_logo.src}"
                          data-fallback="${row.team_logo.fallback || ''}"
                          loading="lazy"
                          @error=${handleTeamLogoError}
                          alt=""
                        />
                      `
                      : null}
                    ${row.tla}
                  </span>
                </div>
                    <div class="tl-cell tl-badges">
                      ${row.badges.map((badge) => badge.type === 'count'
                        ? html`<span class="tl-count ${badge.level}" style="--progress-height: ${Math.min(100, badge.label * 25)}%">${badge.label}</span>`
                        : html`<span class="tl-badge ${badge.className}">${badge.label}</span>`)}
                    </div>
                  </div>
                `})}
              </div>
            `
            : html`<div class="tl-empty">No track limits</div>`}
        </div>
      </ha-card>
    `;
  }

  _buildRows(limitsState, drivers, positions) {
    const byDriver = limitsState?.attributes?.by_driver;
    const driverMap = new Map();
    drivers.forEach((driver, index) => {
      const tla = String(driver?.tla || '').trim();
      if (!tla) return;
      driverMap.set(tla, { ...driver, index });
    });

    if (byDriver && typeof byDriver === 'object') {
      Object.entries(byDriver).forEach(([tla, info], i) => {
        if (!driverMap.has(tla)) {
          driverMap.set(tla, { tla, racing_number: info?.racing_number, index: 1000 + i });
        }
      });
    }

    const positionMap = this._buildPositionMap(positions);
    const rows = [];

    for (const [tla, driver] of driverMap.entries()) {
      const stats = byDriver && typeof byDriver === 'object' ? byDriver[tla] || {} : {};
      const deletions = Number(stats?.deletions) || 0;
      const warning = stats?.warning === true;
      const penalty = stats?.penalty;
      const latestTime = this._latestViolationTime(stats);
      const hasActivity = deletions > 0 || warning || penalty;
      if (!this.config.show_all_drivers && !hasActivity) {
        continue;
      }

      const rn = String(driver?.racing_number ?? stats?.racing_number ?? '').trim();
      const positionInfo = positionMap.get(rn) || positionMap.get(tla) || {};
      const position = this._parsePosition(
        positionInfo?.current_position ?? positionInfo?.grid_position ?? driver?.position,
      );

      const badges = [];
      const severity = this._trackLimitSeverity(deletions, warning, penalty);
      if (deletions > 0) {
        badges.push({ type: 'count', label: `${deletions}`, level: severity });
      }
      if (warning) badges.push({ label: 'WARNING', className: 'warn' });
      if (penalty) badges.push({ label: this._longPenalty(penalty) || penalty, className: 'pen' });
      if (!badges.length) badges.push({ label: '--', className: '' });

      rows.push({
        tla,
        team_color: this._normalizeColor(driver?.team_color || positionInfo?.team_color),
        team_logo: getTeamLogoMeta(
          driver?.team || driver?.team_name || positionInfo?.team,
          28,
          this.config.team_logo_style,
        ),
        position,
        index: driver?.index ?? 0,
        latestTime,
        badges,
        hasWarning: warning || deletions >= 3,
        hasPenalty: !!penalty,
      });
    }

    rows.sort((a, b) => {
      if (Number.isFinite(a.latestTime) && Number.isFinite(b.latestTime)) {
        const diff = b.latestTime - a.latestTime;
        if (diff !== 0) return diff;
      } else if (Number.isFinite(a.latestTime)) {
        return -1;
      } else if (Number.isFinite(b.latestTime)) {
        return 1;
      }
      if (a.position !== null && b.position !== null) return a.position - b.position;
      if (a.position !== null) return -1;
      if (b.position !== null) return 1;
      return a.index - b.index;
    });

    return rows;
  }

  _buildPositionMap(positions) {
    const map = new Map();
    if (Array.isArray(positions)) {
      positions.forEach((item) => {
        const rn = String(item?.racing_number ?? '').trim();
        const tla = String(item?.tla ?? '').trim();
        if (rn) map.set(rn, item);
        if (tla) map.set(tla, item);
      });
    } else if (positions && typeof positions === 'object') {
      Object.entries(positions).forEach(([key, info]) => {
        if (!info || typeof info !== 'object') return;
        const rnFromInfo = String(info.racing_number ?? '').trim();
        const rnFromKeyMatch = String(key).match(/\d+/);
        const rn = rnFromInfo || (rnFromKeyMatch ? rnFromKeyMatch[0] : '');
        const tla = String(info.tla ?? '').trim();
        if (rn) map.set(rn, info);
        if (tla) map.set(tla, info);
      });
    }
    return map;
  }

  _parsePosition(value) {
    if (value === null || value === undefined) return null;
    const text = String(value).trim();
    if (!text) return null;
    const match = text.match(/\d+/);
    if (!match) return null;
    const num = Number(match[0]);
    return Number.isFinite(num) ? num : null;
  }

  _longPenalty(text) {
    if (!text) return null;
    const upper = String(text).toUpperCase();
    const timeMatch = upper.match(/(\d+)\s*SECOND/);
    if (timeMatch && upper.includes('TIME PENALTY')) return `PENALTY ${timeMatch[1]} SEC`;
    if (timeMatch && upper.includes('STOP/GO')) return `PENALTY STOP/GO ${timeMatch[1]} SEC`;
    if (upper.includes('DRIVE THROUGH')) return 'PENALTY DRIVE THROUGH';
    if (upper.includes('REPRIMAND')) return 'REPRIMAND';
    return null;
  }

  _latestViolationTime(stats) {
    const violations = Array.isArray(stats?.violations) ? stats.violations : [];
    const times = [];
    violations.forEach((item) => {
      const time = this._parseIncidentTime(item?.utc);
      if (Number.isFinite(time)) times.push(time);
    });
    if (!times.length) return null;
    return Math.max(...times);
  }

  _parseIncidentTime(value) {
    if (!value) return null;
    const text = String(value).trim();
    if (!text) return null;
    const normalized = text.includes('Z') || /[+-]\d{2}:\d{2}$/.test(text)
      ? text
      : `${text}Z`;
    const ts = Date.parse(normalized);
    return Number.isNaN(ts) ? null : ts;
  }

  _trackLimitSeverity(deletions, warning, penalty) {
    if (penalty) return 'penalty';
    if (warning) return 'warning';
    if (Number(deletions) >= 3) return 'limit';
    return 'minor';
  }

  _normalizeColor(value) {
    if (!value) return null;
    const text = String(value).trim();
    if (text.startsWith('#') || text.startsWith('rgb')) return text;
    if (/^[0-9a-fA-F]{6}$/.test(text)) return `#${text}`;
    return text;
  }
}

class F1TrackLimitsCardEditor extends LitElement {
  static properties = {
    hass: {},
    _config: {},
    _activeTab: { state: true },
  };

  static styles = css`
    .card-config {
      display: flex;
      flex-direction: column;
    }

    .tabs {
      display: flex;
      border-bottom: 1px solid var(--divider-color);
      margin-bottom: 16px;
    }

    .tabs button {
      flex: 1;
      padding: 12px;
      background: none;
      border: none;
      cursor: pointer;
      color: var(--primary-text-color);
      font-size: 14px;
      font-family: inherit;
      transition: color 0.2s;
    }

    .tabs button:hover {
      color: var(--primary-color);
    }

    .tabs button.active {
      color: var(--primary-color);
      border-bottom: 2px solid var(--primary-color);
      margin-bottom: -1px;
    }

    .section {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-bottom: 16px;
    }

    .section-header {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 0.5px;
      color: var(--secondary-text-color);
      text-transform: uppercase;
      margin-top: 8px;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .helper {
      font-size: 12px;
      color: var(--secondary-text-color);
      padding-left: 16px;
      line-height: 1.4;
    }

    .warning {
      font-size: 12px;
      color: var(--error-color);
      padding-left: 16px;
    }

    .display-section {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    ha-textfield {
      display: block;
      margin-bottom: 8px;
    }

    ha-formfield {
      display: flex;
      align-items: center;
      padding: 4px 0;
    }

    ha-select {
      width: 100%;
    }
  `;

  constructor() {
    super();
    this._activeTab = 'sources';
  }

  setConfig(config) {
    this._config = { ...config };
  }

  render() {
    if (!this.hass || !this._config) return html``;

    return html`
      <div class="card-config">
        <div class="tabs">
          <button
            class=${this._activeTab === 'sources' ? 'active' : ''}
            @click=${() => this._activeTab = 'sources'}
          >
            Data Sources
          </button>
          <button
            class=${this._activeTab === 'display' ? 'active' : ''}
            @click=${() => this._activeTab = 'display'}
          >
            Display
          </button>
        </div>

        ${this._activeTab === 'sources'
          ? this._renderDataSourcesTab()
          : this._renderDisplayTab()}
      </div>
    `;
  }

  _renderDataSourcesTab() {
    return html`
      <div class="section">
        <div class="section-header">REQUIRED SENSORS</div>
        ${this._renderEntityPicker(
          'track_limits_entity',
          'Track Limits Sensor',
          'Provides track limit violations by driver',
          true,
          'sensor'
        )}
      </div>
      <div class="section">
        <div class="section-header">OPTIONAL SENSORS</div>
        ${this._renderEntityPicker(
          'drivers_entity',
          'Driver List Sensor',
          'Provides driver names, TLAs, and team colors. Enables team logo display.',
          false,
          'sensor'
        )}
        ${this._renderEntityPicker(
          'positions_entity',
          'Driver Positions Sensor',
          'Provides race positions and status flags. Enables position ordering.',
          false,
          'sensor'
        )}
      </div>
    `;
  }

  _renderDisplayTab() {
    return html`
      <div class="display-section">
        <ha-textfield
          .label=${'Title'}
          .value=${this._config.title || ''}
          @input=${(e) => this._valueChanged('title', e.target.value)}
        ></ha-textfield>

        ${this._renderSwitch('show_header', 'Show header')}
        ${this._renderSwitch('show_table_header', 'Show table header')}
        ${this._renderSwitch('show_team_logo', 'Show team logos')}

        <ha-select
          .label=${'Team logo style'}
          .value=${this._config.team_logo_style || 'color'}
          @selected=${(e) => this._valueChanged('team_logo_style', e.target.value)}
          @closed=${(e) => e.stopPropagation()}
        >
          <mwc-list-item value="color">Color (fallback to white)</mwc-list-item>
          <mwc-list-item value="white">White</mwc-list-item>
        </ha-select>

        ${this._renderSwitch('show_all_drivers', 'Show all drivers')}
      </div>
    `;
  }

  _renderEntityPicker(name, label, helper, required, domain) {
    const value = this._config[name];
    const showWarning = required && !value;
    const schema = [{ name, label, required, selector: { entity: { domain } } }];

    return html`
      <div class="field">
        <ha-form
          .hass=${this.hass}
          .data=${this._config}
          .schema=${schema}
          .computeLabel=${() => label}
          @value-changed=${this._formValueChanged}
        ></ha-form>
        <div class="helper">${helper}</div>
        ${showWarning ? html`
          <div class="warning">This sensor is required for the card to function</div>
        ` : ''}
      </div>
    `;
  }

  _renderSwitch(name, label, helper = null) {
    const schema = [{ name, label, selector: { boolean: {} } }];
    return html`
      <ha-form
        .hass=${this.hass}
        .data=${this._config}
        .schema=${schema}
        .computeLabel=${() => label}
        @value-changed=${this._formValueChanged}
      ></ha-form>
      ${helper ? html`<div class="helper">${helper}</div>` : ''}
    `;
  }

  _formValueChanged(ev) {
    if (!this._config) return;
    const value = ev.detail?.value || {};
    const newConfig = { ...this._config, ...value };
    this._config = newConfig;
    this.dispatchEvent(new CustomEvent('config-changed', { detail: { config: newConfig } }));
  }

  _valueChanged(name, value) {
    if (!this._config) return;
    const newConfig = { ...this._config, [name]: value };
    this._config = newConfig;
    this.dispatchEvent(new CustomEvent('config-changed', { detail: { config: newConfig } }));
  }
}

// ============================================================================
// F1 Live Session Status Card
// ============================================================================

class F1LiveSessionCard extends LitElement {
  static properties = {
    hass: {},
    config: {},
  };

  constructor() {
    super();
    this._countdownTimer = null;
    this._sessionClockTimer = null;
    this._clockSnapshot = null;
    this._clockSnapshotKey = null;
  }

  static styles = css`
    /* Animation keyframes */
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    @keyframes glowPulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(var(--glow-color-rgb, 255, 149, 0), 0.4); }
      50% { box-shadow: 0 0 12px 2px rgba(var(--glow-color-rgb, 255, 149, 0), 0.6); }
    }

    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    :host {
      --ls-bg: #0b0b0d;
      --ls-bg-soft: #131315;
      --ls-border: rgba(255, 255, 255, 0.08);
      --ls-text: #f5f5f5;
      --ls-muted: rgba(255, 255, 255, 0.65);
      --ls-shadow: 0 16px 40px rgba(0, 0, 0, 0.35);
    }

    ha-card {
      padding: 0;
      background: transparent;
      box-shadow: none;
      border: none;
    }

    .ls-card {
      font-family: 'Formula1 Display', 'Titillium Web', Arial, sans-serif;
      display: flex;
      flex-direction: column;
      gap: clamp(8px, 1.5vw, 12px);
      padding: clamp(10px, 1.5vw, 14px) clamp(14px, 2vw, 20px);
      border-radius: var(--ha-card-border-radius, 12px);
      background:
        radial-gradient(circle at 15% 10%, rgba(255, 255, 255, 0.06), transparent 45%),
        linear-gradient(160deg, var(--ls-bg) 0%, var(--ls-bg-soft) 60%, #0a0a0a 100%);
      border: 1px solid var(--ls-border);
      box-shadow: var(--ls-shadow);
      color: var(--ls-text);
      container-type: inline-size;
    }

    .ls-header {
      display: flex;
      align-items: center;
      gap: clamp(10px, 2vw, 16px);
    }

    .ls-session-info {
      display: flex;
      align-items: center;
      gap: clamp(8px, 1.5vw, 12px);
    }

    .ls-flag {
      width: clamp(24px, 4vw, 32px);
      height: auto;
      border-radius: 2px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
    }

    .ls-gp-text {
      display: flex;
      flex-direction: column;
      gap: 1px;
    }

    .ls-gp-name {
      font-family: 'Formula1 Wide', 'Formula1 Display', Arial, sans-serif;
      font-weight: 600;
      font-size: clamp(13px, 2.2vw, 16px);
      letter-spacing: 0.02em;
      white-space: nowrap;
    }

    .ls-session-type {
      font-size: clamp(9px, 1.3vw, 11px);
      color: var(--ls-muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .ls-session-state {
      font-weight: 700;
      margin-left: 6px;
      color: var(--session-state-color, var(--ls-muted));
    }

    .ls-countdown {
      margin-left: 6px;
      font-weight: 600;
      color: var(--ls-text);
    }

    .ls-laps {
      font-size: clamp(12px, 1.8vw, 14px);
      color: var(--ls-text);
      white-space: nowrap;
    }

    .ls-lap-progress-container {
      width: 100%;
      height: 4px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 2px;
      overflow: hidden;
      margin-top: 4px;
    }

    .ls-lap-progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #e10600, #ff3b30);
      border-radius: 2px;
      transition: width 0.5s ease-out;
    }

    .ls-laps-group {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      margin-left: clamp(8px, 1.5vw, 12px);
      padding-left: clamp(8px, 1.5vw, 12px);
      border-left: 1px solid var(--ls-border);
      gap: 2px;
      white-space: nowrap;
    }

    .ls-status-group {
      margin-left: auto;
      display: inline-flex;
      align-items: center;
      gap: clamp(6px, 1vw, 10px);
    }

    .ls-status-pill {
      display: inline-flex;
      align-items: center;
      padding: clamp(4px, 0.7vw, 6px) clamp(10px, 1.5vw, 14px);
      border-radius: 20px;
      font-family: 'Formula1 Display', Arial, sans-serif;
      font-weight: 700;
      font-size: clamp(9px, 1.3vw, 11px);
      text-transform: uppercase;
      letter-spacing: 0.04em;
      background: var(--status-bg, rgba(52, 199, 89, 0.2));
      color: var(--status-color, #34c759);
      border: 1px solid color-mix(in srgb, var(--status-color, #34c759) 40%, transparent);
      white-space: nowrap;
      transition: box-shadow 0.3s ease;
    }

    .ls-status-pill.status-sc,
    .ls-status-pill.status-vsc {
      --glow-color-rgb: 255, 149, 0;
      animation: glowPulse 2s ease-in-out infinite;
    }

    .ls-status-pill.status-red {
      --glow-color-rgb: 255, 59, 48;
      animation: glowPulse 1.5s ease-in-out infinite;
    }

    .ls-status-pill.status-yellow {
      --glow-color-rgb: 255, 214, 10;
      animation: pulse 2s ease-in-out infinite;
    }

    .ls-grip-pill {
      --status-color: #f59e0b;
      --status-bg: rgba(245, 158, 11, 0.2);
    }

    .ls-session-state.state-live {
      animation: pulse 2s ease-in-out infinite;
    }

    .ls-countdown.imminent {
      color: #ff3b30;
      animation: pulse 1s ease-in-out infinite;
    }

    .ls-weather {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: clamp(8px, 1.5vw, 16px);
      padding-top: clamp(8px, 1.2vw, 10px);
      border-top: 1px solid var(--ls-border);
      flex-wrap: wrap;
    }

    .ls-weather-col {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1px;
      min-width: 0;
      flex: 1 1 auto;
    }

    .ls-weather-label {
      font-size: clamp(8px, 1.1vw, 10px);
      color: var(--ls-muted);
      text-transform: uppercase;
      letter-spacing: 0.04em;
      white-space: nowrap;
    }

    .ls-weather-value {
      font-family: 'Formula1 Display', Arial, sans-serif;
      font-weight: 700;
      font-size: clamp(11px, 1.5vw, 13px);
      white-space: nowrap;
    }

    .ls-unavailable {
      font-size: clamp(12px, 1.8vw, 14px);
      color: var(--ls-muted);
      padding: clamp(16px, 3vw, 24px);
      text-align: center;
    }

    .ls-time-group {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      margin-left: clamp(8px, 1.5vw, 12px);
      padding-left: clamp(8px, 1.5vw, 12px);
      border-left: 1px solid var(--ls-border);
      gap: 3px;
      white-space: nowrap;
    }

    .ls-time-row {
      display: flex;
      align-items: baseline;
      gap: 5px;
    }

    .ls-time-label {
      font-size: clamp(8px, 1.1vw, 10px);
      color: var(--ls-muted);
      text-transform: uppercase;
      letter-spacing: 0.04em;
    }

    .ls-time-value {
      font-family: 'Formula1 Display', Arial, sans-serif;
      font-weight: 700;
      font-size: clamp(11px, 1.5vw, 13px);
      color: var(--ls-text);
    }

    @container (max-width: 400px) {
      .ls-weather {
        gap: clamp(6px, 1vw, 10px);
      }
      .ls-weather-col {
        flex: 0 1 auto;
      }
    }
  `;

  connectedCallback() {
    super.connectedCallback();
    ensureF1Fonts();
  }

  disconnectedCallback() {
    super.disconnectedCallback();
    this._clearCountdownTimer();
    this._clearSessionClockTimer();
  }

  setConfig(config) {
    this.config = {
      session_entity: 'sensor.f1_session_current_session',
      session_status_entity: 'sensor.f1_session_session_status',
      formation_start_entity: 'binary_sensor.f1_session_formation_start',
      lap_count_entity: 'sensor.f1_session_race_lap_count',
      track_status_entity: 'sensor.f1_session_track_status',
      weather_entity: 'sensor.f1_session_track_weather',
      next_race_entity: 'sensor.f1_race_next_race',
      session_time_remaining_entity: 'sensor.f1_session_session_time_remaining',
      session_time_elapsed_entity: 'sensor.f1_session_session_time_elapsed',
      show_flag: true,
      show_lap_progress: true,
      show_track_status: true,
      show_weather: true,
      show_time_remaining: false,
      show_time_elapsed: false,
      ...config,
    };
  }

  static getConfigElement() {
    return document.createElement('f1-live-session-card-editor');
  }

  static getStubConfig() {
    return {
      type: 'custom:f1-live-session-card',
      session_entity: 'sensor.f1_session_current_session',
      session_status_entity: 'sensor.f1_session_session_status',
      formation_start_entity: 'binary_sensor.f1_session_formation_start',
      lap_count_entity: 'sensor.f1_session_race_lap_count',
      track_status_entity: 'sensor.f1_session_track_status',
      weather_entity: 'sensor.f1_session_track_weather',
      next_race_entity: 'sensor.f1_race_next_race',
    };
  }

  getCardSize() {
    return 2;
  }

  getGridOptions() {
    return {
      columns: 12,
      min_columns: 6,
      max_columns: 12,
      min_rows: 1,
    };
  }

  _getSessionData() {
    const entity = this.hass?.states?.[this.config.session_entity];
    if (!entity || entity.state === 'unavailable' || entity.state === 'unknown') {
      return null;
    }
    return { state: entity.state, ...entity.attributes };
  }

  _getSessionStatusData() {
    const primaryId = this.config.session_status_entity || 'sensor.f1_session_session_status';
    const entity = this.hass?.states?.[primaryId]
      || this.hass?.states?.['sensor.f1_session_session_status'];
    if (!entity || entity.state === 'unavailable' || entity.state === 'unknown') {
      return null;
    }
    return { state: entity.state, ...entity.attributes };
  }

  _getNextRaceData() {
    const primaryId = this.config.next_race_entity || 'sensor.f1_race_next_race';
    const entity = this.hass?.states?.[primaryId]
      || this.hass?.states?.['sensor.f1_race_next_race'];
    if (!entity || entity.state === 'unavailable' || entity.state === 'unknown') {
      return null;
    }
    return { state: entity.state, ...entity.attributes };
  }

  _getSessionClockData() {
    const remainingId = this.config.session_time_remaining_entity || 'sensor.f1_session_session_time_remaining';
    const elapsedId = this.config.session_time_elapsed_entity || 'sensor.f1_session_session_time_elapsed';
    const remainingEntity = this.hass?.states?.[remainingId];
    const elapsedEntity = this.hass?.states?.[elapsedId];
    const isValid = (e) => e && e.state !== 'unavailable' && e.state !== 'unknown' && e.state;

    const parseHMS = (s) => {
      if (!s) return null;
      const parts = String(s).split(/[:.]/).map(Number);
      if (parts.length !== 3 || parts.some(isNaN)) return null;
      return parts[0] * 3600 + parts[1] * 60 + parts[2];
    };

    const formatHMS = (totalS) => {
      if (totalS == null || totalS < 0) return null;
      const h = Math.floor(totalS / 3600);
      const m = Math.floor((totalS % 3600) / 60);
      const s = totalS % 60;
      return `${h}:${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
    };

    const remainingRaw = isValid(remainingEntity) ? remainingEntity.state : null;
    const elapsedRaw = isValid(elapsedEntity) ? elapsedEntity.state : null;

    // Update snapshot whenever HA pushes new state values
    const snapshotKey = `${remainingRaw}|${elapsedRaw}`;
    if (snapshotKey !== this._clockSnapshotKey && (remainingRaw || elapsedRaw)) {
      this._clockSnapshotKey = snapshotKey;
      this._clockSnapshot = {
        remainingS: parseHMS(remainingRaw),
        elapsedS: parseHMS(elapsedRaw),
        ts: Date.now(),
      };
    }

    if (!this._clockSnapshot) {
      return {
        remaining: formatHMS(parseHMS(remainingRaw)) ?? remainingRaw,
        elapsed: formatHMS(parseHMS(elapsedRaw)) ?? elapsedRaw,
      };
    }

    const deltaS = Math.round((Date.now() - this._clockSnapshot.ts) / 1000);
    return {
      remaining: this._clockSnapshot.remainingS != null
        ? formatHMS(this._clockSnapshot.remainingS - deltaS)
        : null,
      elapsed: this._clockSnapshot.elapsedS != null
        ? formatHMS(this._clockSnapshot.elapsedS + deltaS)
        : null,
    };
  }

  _clearSessionClockTimer() {
    if (this._sessionClockTimer) {
      clearInterval(this._sessionClockTimer);
      this._sessionClockTimer = null;
    }
  }

  _ensureSessionClockTimer() {
    const wantsTimer = this.config.show_time_remaining || this.config.show_time_elapsed;
    if (!wantsTimer) {
      this._clearSessionClockTimer();
      return;
    }
    if (!this._sessionClockTimer) {
      this._sessionClockTimer = setInterval(() => this.requestUpdate(), 1000);
    }
  }

  _clearCountdownTimer() {
    if (this._countdownTimer) {
      clearInterval(this._countdownTimer);
      this._countdownTimer = null;
    }
  }

  _ensureCountdownTimer(sessionStatus, nextRace) {
    const state = String(sessionStatus?.state || '').toLowerCase();
    let diff = 0;
    if (state === 'pre') {
      const startValue = this._getSessionStartValue(sessionStatus);
      const start = this._parseDateWithOffset(startValue, sessionStatus?.gmt_offset);
      diff = start ? start.getTime() - Date.now() : 0;
      if (diff <= 0 && start) {
        const fallback = this._getCountdownTarget(start);
        diff = fallback ? fallback.getTime() - Date.now() : diff;
      }
    } else if (nextRace) {
      const startValue = nextRace.race_start_utc || nextRace.state || nextRace.race_start;
      const start = this._parseDateWithOffset(startValue, null);
      diff = start ? start.getTime() - Date.now() : 0;
    }

    const shouldRun = Number.isFinite(diff) && diff > 0;
    if (!shouldRun) {
      this._clearCountdownTimer();
      return;
    }
    if (!this._countdownTimer) {
      this._countdownTimer = setInterval(() => {
        this.requestUpdate();
      }, 1000);
    }
  }

  _getFormationStart() {
    const entityId = this.config.formation_start_entity || 'binary_sensor.f1_session_formation_start';
    const entity = this.hass?.states?.[entityId];
    if (!entity || entity.state === 'unavailable' || entity.state === 'unknown') {
      return false;
    }
    return entity.state === 'on';
  }

  _normalizeOffset(offset) {
    if (!offset) return '';
    const text = String(offset).trim();
    if (text.startsWith('+') || text.startsWith('-')) {
      return text.slice(0, 6);
    }
    if (/^\d{2}:\d{2}:\d{2}$/.test(text)) {
      return `+${text.slice(0, 5)}`;
    }
    return '';
  }

  _parseDateWithOffset(value, offset) {
    if (!value) return null;
    const text = String(value).trim();
    if (!text) return null;
    if (text.includes('Z') || /[+-]\d{2}:\d{2}$/.test(text)) {
      const dt = new Date(text);
      return Number.isNaN(dt.getTime()) ? null : dt;
    }
    const suffix = this._normalizeOffset(offset);
    const dt = new Date(`${text}${suffix}`);
    if (!Number.isNaN(dt.getTime())) return dt;
    const fallback = new Date(text);
    return Number.isNaN(fallback.getTime()) ? null : fallback;
  }

  _formatLocalTime(value, offset) {
    const dt = this._parseDateWithOffset(value, offset);
    if (!dt) return null;
    const timeFormat = this.hass?.locale?.time_format;
    const hour12 = timeFormat === '12';
    const timeZone = this._getTimeZone();
    try {
      return new Intl.DateTimeFormat(this.hass?.locale?.language || undefined, {
        hour: '2-digit',
        minute: '2-digit',
        hour12,
        timeZone,
      }).format(dt);
    } catch (err) {
      return dt.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12, timeZone });
    }
  }

  _getTimeZone() {
    return this.hass?.config?.time_zone
      || this.hass?.locale?.time_zone
      || Intl.DateTimeFormat().resolvedOptions().timeZone;
  }

  _getZonedDate(date, timeZone) {
    try {
      const fmt = new Intl.DateTimeFormat('en-CA', {
        timeZone,
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        hour12: false,
      });
      const parts = fmt.formatToParts(date);
      const get = (type) => Number(parts.find((p) => p.type === type)?.value || 0);
      return new Date(
        get('year'),
        get('month') - 1,
        get('day'),
        get('hour'),
        get('minute'),
        get('second'),
      );
    } catch (err) {
      return date;
    }
  }

  _getSessionStartValue(sessionStatus) {
    if (!sessionStatus) return null;
    return sessionStatus.start
      || sessionStatus.start_time
      || sessionStatus.start_time_local
      || sessionStatus.start_time_utc
      || sessionStatus.start_utc
      || null;
  }

  _sessionStatusLabel(sessionStatus) {
    if (!sessionStatus) return '';
    const state = String(sessionStatus.state || '').toLowerCase();
    if (state === 'pre') {
      const startValue = this._getSessionStartValue(sessionStatus);
      const time = this._formatLocalTime(startValue, sessionStatus.gmt_offset);
      return time ? `Starts ${time}` : 'Starting soon';
    }
    if (state === 'live') return 'Live';
    if (state === 'suspended') return 'Suspended';
    if (state === 'break') return 'Break';
    if (state === 'finished' || state === 'finalised' || state === 'ended') return 'Finished';
    return state ? state.replace(/_/g, ' ').toUpperCase() : '';
  }

  _sessionStateMeta(sessionStatus, formationStart) {
    if (!sessionStatus) return { label: '', color: null, state: '' };
    const state = String(sessionStatus.state || '').toLowerCase();
    if (state === 'pre') {
      if (formationStart) {
        return { label: 'Formation lap', color: '#f59e0b', state };
      }
      return { label: this._sessionStatusLabel(sessionStatus), color: '#f59e0b', state };
    }
    if (state === 'live') {
      return { label: 'LIVE', color: '#34c759', state };
    }
    if (state === 'suspended' || state === 'break') {
      return { label: this._sessionStatusLabel(sessionStatus), color: '#f97316', state };
    }
    if (state === 'finished' || state === 'finalised' || state === 'ended') {
      return { label: 'FINISHED', color: '#a3a3a3', state };
    }
    const label = this._sessionStatusLabel(sessionStatus);
    return { label, color: label ? '#f5f5f5' : null, state };
  }

  _formatCountdown(seconds) {
    const total = Math.max(0, Math.floor(seconds));
    if (total >= 86400) {
      const days = Math.floor(total / 86400);
      const hours = Math.floor((total % 86400) / 3600);
      const minutes = Math.floor((total % 3600) / 60);
      return `T-${days}D ${hours}H ${minutes}M`;
    }
    const h = Math.floor(total / 3600);
    const m = Math.floor((total % 3600) / 60);
    const s = total % 60;
    const pad = (v) => String(v).padStart(2, '0');
    if (h > 0) return `T-${h}:${pad(m)}:${pad(s)}`;
    return `T-${m}:${pad(s)}`;
  }

  _getCountdownTarget(start) {
    if (!start) return null;
    const timeZone = this._getTimeZone();
    const nowZoned = this._getZonedDate(new Date(), timeZone);
    const startZoned = this._getZonedDate(start, timeZone);
    const target = new Date(nowZoned);
    target.setHours(startZoned.getHours(), startZoned.getMinutes(), startZoned.getSeconds(), 0);
    if (target.getTime() <= nowZoned.getTime()) {
      target.setDate(target.getDate() + 1);
    }
    return target;
  }

  _getCountdown(sessionStatus) {
    const state = String(sessionStatus?.state || '').toLowerCase();
    if (state !== 'pre') return '';
    const startValue = this._getSessionStartValue(sessionStatus);
    const start = this._parseDateWithOffset(startValue, sessionStatus?.gmt_offset);
    if (!start) return '';
    const timeZone = this._getTimeZone();
    const startZoned = this._getZonedDate(start, timeZone);
    const nowZoned = this._getZonedDate(new Date(), timeZone);
    let diffSeconds = Math.floor((startZoned.getTime() - nowZoned.getTime()) / 1000);
    if (diffSeconds <= 0) {
      const fallback = this._getCountdownTarget(start);
      if (!fallback) return '';
      const fallbackZoned = this._getZonedDate(fallback, timeZone);
      diffSeconds = Math.floor((fallbackZoned.getTime() - nowZoned.getTime()) / 1000);
      if (diffSeconds <= 0) return '';
    }
    return this._formatCountdown(diffSeconds);
  }

  _getNextRaceCountdown(nextRace) {
    if (!nextRace) return '';
    const startValue = nextRace.race_start_utc || nextRace.state || nextRace.race_start;
    if (!startValue) return '';
    const start = this._parseDateWithOffset(startValue, null);
    if (!start) return '';
    const now = new Date();
    const diffSeconds = Math.floor((start.getTime() - now.getTime()) / 1000);
    if (diffSeconds <= 0) return '';
    return this._formatCountdown(diffSeconds);
  }

  _getLapData() {
    const entity = this.hass?.states?.[this.config.lap_count_entity];
    if (!entity || entity.state === 'unavailable' || entity.state === 'unknown') {
      return null;
    }
    return {
      current: parseInt(entity.state, 10) || 0,
      total: entity.attributes?.total_laps ?? null,
    };
  }

  _getTrackStatus() {
    const entity = this.hass?.states?.[this.config.track_status_entity];
    if (!entity || entity.state === 'unavailable' || entity.state === 'unknown') {
      return null;
    }
    return entity.state?.toUpperCase() || 'CLEAR';
  }

  _getWeatherData() {
    const entity = this.hass?.states?.[this.config.weather_entity];
    if (!entity || entity.state === 'unavailable' || entity.state === 'unknown') {
      return null;
    }
    return entity.attributes || {};
  }

  _getCountryFlagUrl(country) {
    if (!country) return null;
    const code = F1_COUNTRY_CODES[country];
    return code ? `https://flagcdn.com/w80/${code}.png` : null;
  }

  _windDirectionToCardinal(degrees) {
    if (degrees === null || degrees === undefined) return '';
    const num = Number(degrees);
    if (!Number.isFinite(num)) return '';
    const directions = ['N', 'NE', 'E', 'SE', 'S', 'SW', 'W', 'NW'];
    const index = Math.round(num / 45) % 8;
    const arrows = ['', '', '', '', '', '', '', ''];
    return `${directions[index]}${arrows[index]}`;
  }

  _formatLapProgress(current, total) {
    if (!Number.isFinite(current)) return '';
    if (!Number.isFinite(total) || total === 0) return `Lap: ${current}`;
    const remaining = Math.max(0, total - current);
    return `Lap: ${current}/${total} (${remaining} left)`;
  }

  _formatLapSummary(current, total, sessionState) {
    const state = String(sessionState || '').toLowerCase();
    if (state === 'pre') {
      if (Number.isFinite(total) && total > 0) return `Laps: ${total}`;
      return '';
    }
    return this._formatLapProgress(current, total);
  }

  _getStatusClass(trackStatus) {
    const status = String(trackStatus || '').toUpperCase();
    if (status === 'SC' || status === 'SAFETY CAR') return 'status-sc';
    if (status === 'VSC' || status === 'VIRTUAL SC') return 'status-vsc';
    if (status === 'RED' || status === 'RED FLAG') return 'status-red';
    if (status === 'YELLOW' || status === 'YELLOW FLAG') return 'status-yellow';
    return '';
  }

  _isCountdownImminent() {
    const sessionStatus = this._getSessionStatusData();
    const startValue = this._getSessionStartValue(sessionStatus);
    const start = this._parseDateWithOffset(startValue, sessionStatus?.gmt_offset);
    if (!start) return false;
    const diffMs = start.getTime() - Date.now();
    return diffMs > 0 && diffMs < 5 * 60 * 1000; // Less than 5 minutes
  }

  render() {
    if (!this.hass || !this.config) {
      return html`<ha-card><div class="ls-card ls-unavailable">Loading...</div></ha-card>`;
    }

    const session = this._getSessionData();
    const sessionStatus = this._getSessionStatusData();
    const nextRace = (!session && !sessionStatus) ? this._getNextRaceData() : null;
    if (!session && !sessionStatus && !nextRace) {
      return html`<ha-card><div class="ls-card ls-unavailable">No session data</div></ha-card>`;
    }
    this._ensureCountdownTimer(sessionStatus, nextRace);
    this._ensureSessionClockTimer();

    if (nextRace) {
      const gpName = nextRace.race_name?.replace(' Grand Prix', ' GP') || nextRace.race_name || 'Next race';
      const countdown = this._getNextRaceCountdown(nextRace);
      const flagUrl = nextRace.country_flag_url;
      return html`
        <ha-card>
          <div class="ls-card">
            <div class="ls-header">
              ${this.config.show_flag !== false ? html`
                <div class="ls-session-info">
                  ${flagUrl ? html`<img class="ls-flag" src="${flagUrl}" alt="${nextRace.circuit_country || ''}" />` : null}
                  <div class="ls-gp-text">
                    <span class="ls-gp-name">${gpName}</span>
                    <span class="ls-session-type">
                      Next race
                      ${countdown ? html`<span class="ls-countdown">${countdown}</span>` : null}
                    </span>
                  </div>
                </div>
              ` : html`
                <div class="ls-session-info">
                  <div class="ls-gp-text">
                    <span class="ls-gp-name">${gpName}</span>
                    <span class="ls-session-type">
                      Next race
                      ${countdown ? html`<span class="ls-countdown">${countdown}</span>` : null}
                    </span>
                  </div>
                </div>
              `}
            </div>
          </div>
        </ha-card>
      `;
    }

    const data = session || sessionStatus;
    const lapData = this._getLapData();
    const trackStatus = this._getTrackStatus();
    const weather = this._getWeatherData();
    const clockData = this._getSessionClockData();
    const trackGripRaw = sessionStatus?.track_grip;
    const trackGrip = String(trackGripRaw || '').toLowerCase();
    const showGrip = trackGrip && trackGrip !== 'normal';
    const gripLabel = trackGrip ? `Grip ${trackGrip.toUpperCase()}` : '';

    const gpName = data.meeting_name?.replace(' Grand Prix', ' GP') || data.meeting_name || 'Unknown GP';
    const sessionName = session
      ? (data.name || data.type || '')
      : (data.session_name || data.name || data.type || '');
    const formationStart = this._getFormationStart();
    const sessionMeta = this._sessionStateMeta(sessionStatus, formationStart);
    const countdown = this._getCountdown(sessionStatus);
    const flagUrl = this._getCountryFlagUrl(data.meeting_country);

    const statusColor = TRACK_STATUS_COLORS[trackStatus] || TRACK_STATUS_COLORS.CLEAR;
    const statusLabel = TRACK_STATUS_LABELS[trackStatus] || 'Unknown';

    return html`
      <ha-card>
        <div class="ls-card">
          <div class="ls-header">
            ${this.config.show_flag !== false ? html`
              <div class="ls-session-info">
                ${flagUrl ? html`<img class="ls-flag" src="${flagUrl}" alt="${data.meeting_country || ''}" />` : null}
                <div class="ls-gp-text">
                  <span class="ls-gp-name">${gpName}</span>
                  ${(sessionName || sessionMeta.label) ? html`
                    <span class="ls-session-type">
                      ${sessionName || ''}
                      ${sessionMeta.label ? html`<span class="ls-session-state ${sessionMeta.state === 'live' ? 'state-live' : ''}" style="--session-state-color: ${sessionMeta.color};">${sessionMeta.label}</span>` : null}
                      ${countdown ? html`<span class="ls-countdown ${this._isCountdownImminent() ? 'imminent' : ''}">${countdown}</span>` : null}
                    </span>
                  ` : null}
                </div>
              </div>
            ` : html`
              <div class="ls-session-info">
                <div class="ls-gp-text">
                  <span class="ls-gp-name">${gpName}</span>
                  ${(sessionName || sessionMeta.label) ? html`
                    <span class="ls-session-type">
                      ${sessionName || ''}
                      ${sessionMeta.label ? html`<span class="ls-session-state ${sessionMeta.state === 'live' ? 'state-live' : ''}" style="--session-state-color: ${sessionMeta.color};">${sessionMeta.label}</span>` : null}
                      ${countdown ? html`<span class="ls-countdown ${this._isCountdownImminent() ? 'imminent' : ''}">${countdown}</span>` : null}
                    </span>
                  ` : null}
                </div>
              </div>
            `}

            ${this.config.show_lap_progress !== false && lapData ? html`
              <div class="ls-laps-group">
                <span class="ls-laps">${this._formatLapSummary(lapData.current, lapData.total, sessionMeta.state)}</span>
                ${Number.isFinite(lapData.total) && lapData.total > 0 ? html`
                  <div class="ls-lap-progress-container">
                    <div class="ls-lap-progress-bar" style="width: ${Math.min(100, (lapData.current / lapData.total) * 100)}%"></div>
                  </div>
                ` : null}
              </div>
            ` : null}

            ${(() => {
              const showRemaining = this.config.show_time_remaining && clockData.remaining;
              const showElapsed = this.config.show_time_elapsed && clockData.elapsed;
              return (showRemaining || showElapsed) ? html`
                <div class="ls-time-group">
                  ${showRemaining ? html`
                    <div class="ls-time-row">
                      <span class="ls-time-label">Remaining</span>
                      <span class="ls-time-value">${clockData.remaining}</span>
                    </div>
                  ` : null}
                  ${showElapsed ? html`
                    <div class="ls-time-row">
                      <span class="ls-time-label">Elapsed</span>
                      <span class="ls-time-value">${clockData.elapsed}</span>
                    </div>
                  ` : null}
                </div>
              ` : null;
            })()}

            ${this.config.show_track_status !== false && (trackStatus || showGrip) ? html`
              <div class="ls-status-group">
                ${showGrip ? html`
                  <div class="ls-status-pill ls-grip-pill">
                    ${gripLabel}
                  </div>
                ` : null}
                ${trackStatus ? html`
                  <div
                    class="ls-status-pill ${this._getStatusClass(trackStatus)}"
                    style="--status-color: ${statusColor}; --status-bg: ${statusColor}22;"
                  >
                    ${statusLabel}
                  </div>
                ` : null}
              </div>
            ` : null}
          </div>

          ${this.config.show_weather !== false && weather ? html`
            <div class="ls-weather">
              ${weather.wind_speed !== undefined ? html`
                <div class="ls-weather-col">
                  <span class="ls-weather-label">Wind</span>
                  <span class="ls-weather-value">${Number(weather.wind_speed).toFixed(1)} m/s ${this._windDirectionToCardinal(weather.wind_from_direction_degrees)}</span>
                </div>
              ` : null}
              ${weather.track_temperature !== undefined ? html`
                <div class="ls-weather-col">
                  <span class="ls-weather-label">Track</span>
                  <span class="ls-weather-value">${Number(weather.track_temperature).toFixed(1)} C</span>
                </div>
              ` : null}
              ${weather.air_temperature !== undefined ? html`
                <div class="ls-weather-col">
                  <span class="ls-weather-label">Air</span>
                  <span class="ls-weather-value">${Number(weather.air_temperature).toFixed(1)} C</span>
                </div>
              ` : null}
              ${weather.humidity !== undefined ? html`
                <div class="ls-weather-col">
                  <span class="ls-weather-label">Humidity</span>
                  <span class="ls-weather-value">${Number(weather.humidity).toFixed(0)}%</span>
                </div>
              ` : null}
              ${weather.pressure !== undefined ? html`
                <div class="ls-weather-col">
                  <span class="ls-weather-label">Pressure</span>
                  <span class="ls-weather-value">${Number(weather.pressure).toFixed(1)} mb</span>
                </div>
              ` : null}
              <div class="ls-weather-col">
                <span class="ls-weather-label">Rain</span>
                <span class="ls-weather-value">${weather.rainfall > 0 ? 'Yes' : 'No'}</span>
              </div>
            </div>
          ` : null}
        </div>
      </ha-card>
    `;
  }
}

class F1LiveSessionCardEditor extends LitElement {
  static properties = {
    hass: {},
    _config: {},
    _activeTab: { state: true },
  };

  static styles = css`
    .card-config {
      display: flex;
      flex-direction: column;
    }

    .tabs {
      display: flex;
      border-bottom: 1px solid var(--divider-color);
      margin-bottom: 16px;
    }

    .tabs button {
      flex: 1;
      padding: 12px;
      background: none;
      border: none;
      cursor: pointer;
      color: var(--primary-text-color);
      font-size: 14px;
      font-family: inherit;
      transition: color 0.2s;
    }

    .tabs button:hover {
      color: var(--primary-color);
    }

    .tabs button.active {
      color: var(--primary-color);
      border-bottom: 2px solid var(--primary-color);
      margin-bottom: -1px;
    }

    .section {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-bottom: 16px;
    }

    .section-header {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 0.5px;
      color: var(--secondary-text-color);
      text-transform: uppercase;
      margin-top: 8px;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .helper {
      font-size: 12px;
      color: var(--secondary-text-color);
      padding-left: 16px;
      line-height: 1.4;
    }

    .warning {
      font-size: 12px;
      color: var(--error-color);
      padding-left: 16px;
    }

    .display-section {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    ha-textfield {
      display: block;
      margin-bottom: 8px;
    }

    ha-formfield {
      display: flex;
      align-items: center;
      padding: 4px 0;
    }

    ha-select {
      width: 100%;
    }
  `;

  constructor() {
    super();
    this._activeTab = 'sources';
  }

  setConfig(config) {
    this._config = {
      session_entity: 'sensor.f1_session_current_session',
      session_status_entity: 'sensor.f1_session_session_status',
      lap_count_entity: 'sensor.f1_session_race_lap_count',
      track_status_entity: 'sensor.f1_session_track_status',
      weather_entity: 'sensor.f1_session_track_weather',
      next_race_entity: 'sensor.f1_race_next_race',
      session_time_remaining_entity: 'sensor.f1_session_session_time_remaining',
      session_time_elapsed_entity: 'sensor.f1_session_session_time_elapsed',
      show_flag: true,
      show_lap_progress: true,
      show_track_status: true,
      show_weather: true,
      show_time_remaining: false,
      show_time_elapsed: false,
      ...config,
    };
  }

  render() {
    if (!this.hass || !this._config) return html``;

    return html`
      <div class="card-config">
        <div class="tabs">
          <button
            class=${this._activeTab === 'sources' ? 'active' : ''}
            @click=${() => this._activeTab = 'sources'}
          >
            Data Sources
          </button>
          <button
            class=${this._activeTab === 'display' ? 'active' : ''}
            @click=${() => this._activeTab = 'display'}
          >
            Display
          </button>
        </div>

        ${this._activeTab === 'sources'
          ? this._renderDataSourcesTab()
          : this._renderDisplayTab()}
      </div>
    `;
  }

  _renderDataSourcesTab() {
    return html`
      <div class="section">
        <div class="section-header">REQUIRED SENSORS</div>
        ${this._renderEntityPicker(
          'session_entity',
          'Current Session Sensor',
          'Provides live session type and timing data',
          true,
          'sensor'
        )}
      </div>
      <div class="section">
        <div class="section-header">OPTIONAL SENSORS</div>
        ${this._renderEntityPicker(
          'session_status_entity',
          'Session Status Sensor',
          'Indicates pre-session or live status',
          false,
          'sensor'
        )}
        ${this._renderEntityPicker(
          'formation_start_entity',
          'Formation Lap Sensor',
          'Indicates formation lap in progress',
          false,
          'binary_sensor'
        )}
        ${this._renderEntityPicker(
          'lap_count_entity',
          'Lap Count Sensor',
          'Provides current and total lap counts. Enables lap progress display.',
          false,
          'sensor'
        )}
        ${this._renderEntityPicker(
          'track_status_entity',
          'Track Status Sensor',
          'Provides flag status (green, yellow, red, SC). Enables track status pill.',
          false,
          'sensor'
        )}
        ${this._renderEntityPicker(
          'weather_entity',
          'Weather Sensor',
          'Provides track and air temperature, conditions. Enables weather display.',
          false,
          'sensor'
        )}
        ${this._renderEntityPicker(
          'next_race_entity',
          'Next Race Sensor',
          'Provides upcoming race schedule information',
          false,
          'sensor'
        )}
        ${this._renderEntityPicker(
          'session_time_remaining_entity',
          'Session Time Remaining Sensor',
          'Provides official countdown for timed sessions. Enable display under Display tab.',
          false,
          'sensor'
        )}
        ${this._renderEntityPicker(
          'session_time_elapsed_entity',
          'Session Time Elapsed Sensor',
          'Provides elapsed session time. Enable display under Display tab.',
          false,
          'sensor'
        )}
      </div>
    `;
  }

  _renderDisplayTab() {
    return html`
      <div class="display-section">
        ${this._renderSwitch('show_flag', 'Show country flag')}
        ${this._renderSwitch('show_lap_progress', 'Show lap progress')}
        ${this._renderSwitch('show_track_status', 'Show track status pill')}
        ${this._renderSwitch('show_weather', 'Show weather data')}
        ${this._renderSwitch('show_time_remaining', 'Show time remaining')}
        ${this._renderSwitch('show_time_elapsed', 'Show time elapsed')}
      </div>
    `;
  }

  _renderEntityPicker(name, label, helper, required, domain) {
    const value = this._config[name];
    const showWarning = required && !value;
    const schema = [{ name, label, required, selector: { entity: { domain } } }];

    return html`
      <div class="field">
        <ha-form
          .hass=${this.hass}
          .data=${this._config}
          .schema=${schema}
          .computeLabel=${() => label}
          @value-changed=${this._formValueChanged}
        ></ha-form>
        <div class="helper">${helper}</div>
        ${showWarning ? html`
          <div class="warning">This sensor is required for the card to function</div>
        ` : ''}
      </div>
    `;
  }

  _renderSwitch(name, label, helper = null) {
    const schema = [{ name, label, selector: { boolean: {} } }];
    return html`
      <ha-form
        .hass=${this.hass}
        .data=${this._config}
        .schema=${schema}
        .computeLabel=${() => label}
        @value-changed=${this._formValueChanged}
      ></ha-form>
      ${helper ? html`<div class="helper">${helper}</div>` : ''}
    `;
  }

  _formValueChanged(ev) {
    if (!this._config) return;
    const value = ev.detail?.value || {};
    const newConfig = { ...this._config, ...value };
    this._config = newConfig;
    this.dispatchEvent(new CustomEvent('config-changed', { detail: { config: newConfig } }));
  }

  _valueChanged(name, value) {
    if (!this._config) return;
    const newConfig = { ...this._config, [name]: value };
    this._config = newConfig;
    this.dispatchEvent(new CustomEvent('config-changed', { detail: { config: newConfig } }));
  }
}

// ============================================================================
// F1 Race Control Card
// ============================================================================

class F1RaceControlCard extends LitElement {
  static properties = {
    hass: {},
    config: {},
    _currentMessage: { state: true },
  };

  static styles = css`
    /* Animation keyframes */
    @keyframes fadeSlideIn {
      from { opacity: 0; transform: translateX(-8px); }
      to { opacity: 1; transform: translateX(0); }
    }

    @keyframes glowPulse {
      0%, 100% { box-shadow: var(--rc-shadow), 0 0 0 0 rgba(var(--glow-color-rgb, 255, 59, 48), 0.4); }
      50% { box-shadow: var(--rc-shadow), 0 0 16px 4px rgba(var(--glow-color-rgb, 255, 59, 48), 0.5); }
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    :host {
      --rc-bg: #0b0b0d;
      --rc-bg-soft: #131315;
      --rc-border: rgba(255, 255, 255, 0.08);
      --rc-text: #f5f5f5;
      --rc-muted: rgba(255, 255, 255, 0.6);
      --rc-red: #ff3b30;
      --rc-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
    }

    ha-card {
      padding: 0;
      background: transparent;
      box-shadow: none;
      border: none;
    }

    .rc-card {
      font-family: 'Formula1 Display', 'Titillium Web', Arial, sans-serif;
      display: flex;
      align-items: center;
      gap: clamp(10px, 2vw, 16px);
      padding: clamp(8px, 1.2vw, 12px) clamp(12px, 2vw, 18px);
      border-radius: var(--ha-card-border-radius, 12px);
      background:
        radial-gradient(circle at 10% 20%, rgba(255, 255, 255, 0.04), transparent 40%),
        linear-gradient(160deg, var(--rc-bg) 0%, var(--rc-bg-soft) 100%);
      border: 1px solid var(--rc-border);
      box-shadow: var(--rc-shadow);
      color: var(--rc-text);
      transition: box-shadow 0.3s ease, border-color 0.3s ease;
    }

    .rc-card.critical {
      --glow-color-rgb: 255, 59, 48;
      animation: glowPulse 1.5s ease-in-out infinite;
      border-color: rgba(255, 59, 48, 0.4);
    }

    .rc-card.critical-sc {
      --glow-color-rgb: 255, 149, 0;
      animation: glowPulse 2s ease-in-out infinite;
      border-color: rgba(255, 149, 0, 0.4);
    }

    .rc-fia-logo {
      height: clamp(22px, 3.5vw, 28px);
      width: auto;
      flex-shrink: 0;
      object-fit: contain;
      padding-right: clamp(10px, 1.5vw, 14px);
      border-right: 1px solid rgba(255, 255, 255, 0.15);
    }

    .rc-content {
      flex: 1;
      min-width: 0;
      display: flex;
      align-items: center;
      gap: clamp(12px, 2vw, 20px);
    }

    .rc-message {
      flex: 1;
      font-weight: 700;
      font-size: clamp(11px, 1.6vw, 13px);
      line-height: 1.3;
      color: var(--rc-text);
      animation: fadeSlideIn 0.3s ease-out;
    }

    .rc-message.category-safetycar {
      color: #ff9500;
    }

    .rc-message.category-penalty {
      color: #f87171;
    }

    .rc-highlight {
      color: var(--rc-red);
    }

    .rc-icon {
      width: clamp(20px, 3vw, 26px);
      height: clamp(20px, 3vw, 26px);
      flex-shrink: 0;
      fill: var(--rc-muted);
    }

    .rc-icon.flag-red { fill: #ff3b30; }
    .rc-icon.flag-yellow { fill: #ffd60a; }
    .rc-icon.flag-blue { fill: #0a84ff; }
    .rc-icon.flag-green { fill: #34c759; }
    .rc-icon.category-sc { fill: #ff9500; }

    .rc-unavailable {
      font-size: clamp(11px, 1.6vw, 13px);
      color: var(--rc-muted);
      padding: clamp(8px, 1.5vw, 12px);
      text-align: center;
    }

    .rc-card.rc-unavailable {
      justify-content: flex-start;
      text-align: center;
      gap: clamp(10px, 2vw, 16px);
    }

    .rc-unavailable-text {
      flex: 1;
      font-weight: 600;
      text-align: center;
      color: var(--rc-muted);
    }

    .rc-queue-indicator {
      font-size: 9px;
      font-weight: 700;
      color: #1a1a1a;
      background: #ffd60a;
      padding: 2px 6px;
      border-radius: 8px;
      border: 1px solid #ffbf00;
      box-shadow: 0 0 8px rgba(255, 214, 10, 0.35);
      flex-shrink: 0;
      animation: pulse 1.5s ease-in-out infinite;
    }
  `;

  constructor() {
    super();
    this._currentMessage = null;
    this._messageQueue = [];
    this._historyQueue = [];
    this._historyIndex = 0;
    this._lastEventId = null;
    this._displayTimer = null;
    this._messageShownAt = 0;
  }

  connectedCallback() {
    super.connectedCallback();
    ensureF1Fonts();
  }

  disconnectedCallback() {
    super.disconnectedCallback();
    this._clearDisplayTimer();
  }

  _clearDisplayTimer() {
    if (this._displayTimer) {
      clearTimeout(this._displayTimer);
      this._displayTimer = null;
    }
  }

  updated(changedProps) {
    if (changedProps.has('hass')) {
      this._checkForNewMessage();
      const entity = this.hass?.states?.[this.config?.entity];
      if (!entity || entity.state === 'unavailable' || entity.state === 'unknown') {
        this._currentMessage = null;
        this._messageQueue = [];
        this._historyQueue = [];
        this._historyIndex = 0;
        this._lastEventId = null;
        this._clearDisplayTimer();
      }
    }
  }

  _checkForNewMessage() {
    const entity = this.hass?.states?.[this.config?.entity];
    if (!entity || entity.state === 'unavailable' || entity.state === 'unknown') return;

    const minDisplayTime = this.config?.min_display_time || 0;
    const queue = this._buildHistoryQueue(entity);

    if (minDisplayTime > 0 && queue.length > 0) {
      const changed = this._historyChanged(queue);
      if (changed) {
        this._historyQueue = queue;
        this._historyIndex = 0;
        this._currentMessage = queue[0];
        this._lastEventId = queue[0]?.id || null;
      } else if (!this._currentMessage && queue.length > 0) {
        this._historyQueue = queue;
        this._currentMessage = queue[this._historyIndex] || queue[0];
      }
      this._ensureQueueTimer(minDisplayTime, this._historyQueue.length);
      return;
    }

    this._historyQueue = queue;
    this._historyIndex = 0;
    this._clearDisplayTimer();
    if (queue.length > 0) {
      const latest = queue[queue.length - 1];
      this._currentMessage = latest;
      this._lastEventId = latest?.id || null;
    }
  }

  _showMessage(msg) {
    this._currentMessage = msg;
    this._messageShownAt = Date.now();
    this._clearDisplayTimer();

    const minDisplayTime = this.config?.min_display_time || 0;
    if (minDisplayTime > 0 && this._messageQueue.length > 0) {
      // Schedule next message
      this._displayTimer = setTimeout(() => {
        this._showNextFromQueue();
      }, minDisplayTime * 1000);
    }
  }

  _showNextFromQueue() {
    if (this._historyQueue.length === 0) {
      this._clearDisplayTimer();
      return;
    }
    const nextIndex = this._historyIndex + 1;
    if (nextIndex >= this._historyQueue.length) {
      this._clearDisplayTimer();
      return;
    }
    this._historyIndex = nextIndex;
    this._currentMessage = this._historyQueue[this._historyIndex];
    this.requestUpdate();
    const minDisplayTime = this.config?.min_display_time || 0;
    if (minDisplayTime > 0 && this._historyIndex < this._historyQueue.length - 1) {
      this._displayTimer = setTimeout(() => {
        this._showNextFromQueue();
      }, minDisplayTime * 1000);
    } else {
      this._clearDisplayTimer();
    }
  }

  setConfig(config) {
    this.config = {
      entity: 'sensor.f1_officials_race_control',
      show_fia_logo: true,
      min_display_time: 0,
      ...config,
    };
  }

  static getConfigElement() {
    return document.createElement('f1-race-control-card-editor');
  }

  static getStubConfig() {
    return {
      type: 'custom:f1-race-control-card',
      entity: 'sensor.f1_officials_race_control',
    };
  }

  getCardSize() {
    return 1;
  }

  _formatMessage(message) {
    if (!message) return '';
    return this._stripEmbeddedTime(String(message));
  }

  _buildHistoryQueue(entity) {
    const history = Array.isArray(entity?.attributes?.history)
      ? entity.attributes.history
      : [];
    const queue = history
      .map((item, index) => {
        if (!item) return null;
        const utc = item.utc || entity.attributes?.utc || null;
        const parsed = this._parseIncidentTime(utc);
        const id = item.event_id || `${item.utc || ''}|${item.message || ''}|${index}`;
        return {
          id,
          message: item.message || entity.attributes?.message || entity.state,
          category: item.category || null,
          flag: item.flag || null,
          car_number: null,
          utc,
          _time: parsed,
        };
      })
      .filter(Boolean);
    if (queue.length > 0) {
      const hasTime = queue.some((item) => Number.isFinite(item._time));
      if (hasTime) {
        queue.sort((a, b) => (a._time ?? Infinity) - (b._time ?? Infinity));
      } else {
        queue.reverse();
      }
      queue.forEach((item) => delete item._time);
      return queue;
    }
    const fallbackId = entity.attributes?.event_id || entity.attributes?.utc || entity.state;
    if (!fallbackId) return [];
    return [{
      id: fallbackId,
      message: entity.attributes?.message || entity.state,
      category: entity.attributes?.category || null,
      flag: entity.attributes?.flag || null,
      car_number: entity.attributes?.car_number || null,
      utc: entity.attributes?.utc || null,
    }];
  }

  _historyChanged(queue) {
    if (!Array.isArray(queue) || queue.length === 0) return this._historyQueue.length !== 0;
    if (queue.length !== this._historyQueue.length) return true;
    const currentLast = this._historyQueue[this._historyQueue.length - 1]?.id;
    return queue[queue.length - 1]?.id !== currentLast;
  }

  _ensureQueueTimer(minDisplayTime, queueLength) {
    if (minDisplayTime <= 0 || queueLength <= 1) {
      this._clearDisplayTimer();
      return;
    }
    if (this._historyIndex >= queueLength - 1) {
      this._clearDisplayTimer();
      return;
    }
    if (!this._displayTimer) {
      this._displayTimer = setTimeout(() => {
        this._showNextFromQueue();
      }, minDisplayTime * 1000);
    }
  }

  _stripEmbeddedTime(message) {
    // Remove trailing track-local time like "17:08:15" or "17.08.15" from race control text.
    let cleaned = message.replace(/\s\d{1,2}[:.]\d{2}[:.]\d{2}(?=\s*\(PIT\)$|\s*$)/, '');
    cleaned = cleaned.replace(/\s{2,}/g, ' ').trim();
    return cleaned;
  }

  render() {
    if (!this.hass || !this.config) {
      const showLogo = this.config?.show_fia_logo;
      return html`
        <ha-card>
          <div class="rc-card rc-unavailable">
            ${showLogo ? html`<img class="rc-fia-logo" src="https://www.fia.com/sites/all/themes/penceo_theme/images/fia-footer-logo.png" alt="FIA" />` : null}
            <span class="rc-unavailable-text">Loading...</span>
          </div>
        </ha-card>
      `;
    }

    const currentEntity = this.hass?.states?.[this.config.entity];
    if (!currentEntity || currentEntity.state === 'unavailable' || currentEntity.state === 'unknown') {
      const showLogo = this.config.show_fia_logo;
      return html`
        <ha-card>
          <div class="rc-card rc-unavailable">
            ${showLogo ? html`<img class="rc-fia-logo" src="https://www.fia.com/sites/all/themes/penceo_theme/images/fia-footer-logo.png" alt="FIA" />` : null}
            <span class="rc-unavailable-text">No session data</span>
          </div>
        </ha-card>
      `;
    }

    // Initialize from entity if no current message
    if (!this._currentMessage) {
      const entity = currentEntity;
      if (entity && entity.state !== 'unavailable' && entity.state !== 'unknown') {
        this._currentMessage = {
          message: entity.attributes?.message || entity.state,
          category: entity.attributes?.category || null,
          flag: entity.attributes?.flag || null,
          car_number: entity.attributes?.car_number || null,
          utc: entity.attributes?.utc || null,
        };
        this._lastEventId = entity.attributes?.event_id || entity.attributes?.utc || entity.state;
      }
    }

    if (!this._currentMessage) {
      const showLogo = this.config.show_fia_logo;
      return html`
        <ha-card>
          <div class="rc-card rc-unavailable">
            ${showLogo ? html`<img class="rc-fia-logo" src="https://www.fia.com/sites/all/themes/penceo_theme/images/fia-footer-logo.png" alt="FIA" />` : null}
            <span class="rc-unavailable-text">No session data</span>
          </div>
        </ha-card>
      `;
    }

    const msg = this._currentMessage;
    const formattedMessage = this._formatMessage(msg.message);
    const queueCount = (this.config?.min_display_time || 0) > 0
      ? Math.max(0, this._historyQueue.length - 1 - this._historyIndex)
      : 0;
    const criticalClass = this._getCriticalClass(msg);
    const messageClass = this._getMessageCategoryClass(msg);

    return html`
      <ha-card>
        <div class="rc-card ${criticalClass}">
          ${this.config.show_fia_logo ? html`
            <img class="rc-fia-logo" src="https://www.fia.com/sites/all/themes/penceo_theme/images/fia-footer-logo.png" alt="FIA" />
          ` : null}

          <div class="rc-content">
            <div class="rc-message ${messageClass}" .innerHTML=${formattedMessage}></div>
            ${queueCount > 0 ? html`
              <span class="rc-queue-indicator">+${queueCount}</span>
            ` : null}
          </div>

        </div>
      </ha-card>
    `;
  }

  _getCriticalClass(msg) {
    const cat = String(msg?.category || '').toUpperCase();
    const flag = String(msg?.flag || '').toUpperCase();
    if (flag === 'RED' || flag.includes('RED')) return 'critical';
    if (cat === 'SAFETYCAR' || cat === 'VSC' || cat.includes('SAFETY')) return 'critical-sc';
    return '';
  }

  _getMessageCategoryClass(msg) {
    const cat = String(msg?.category || '').toLowerCase();
    if (cat.includes('safety') || cat === 'vsc') return 'category-safetycar';
    if (cat.includes('penalty')) return 'category-penalty';
    return '';
  }
}

class F1RaceControlCardEditor extends LitElement {
  static properties = {
    hass: {},
    _config: {},
    _activeTab: { state: true },
  };

  static styles = css`
    .card-config {
      display: flex;
      flex-direction: column;
    }

    .tabs {
      display: flex;
      border-bottom: 1px solid var(--divider-color);
      margin-bottom: 16px;
    }

    .tabs button {
      flex: 1;
      padding: 12px;
      background: none;
      border: none;
      cursor: pointer;
      color: var(--primary-text-color);
      font-size: 14px;
      font-family: inherit;
      transition: color 0.2s;
    }

    .tabs button:hover {
      color: var(--primary-color);
    }

    .tabs button.active {
      color: var(--primary-color);
      border-bottom: 2px solid var(--primary-color);
      margin-bottom: -1px;
    }

    .section {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-bottom: 16px;
    }

    .section-header {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 0.5px;
      color: var(--secondary-text-color);
      text-transform: uppercase;
      margin-top: 8px;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .helper {
      font-size: 12px;
      color: var(--secondary-text-color);
      padding-left: 16px;
      line-height: 1.4;
    }

    .warning {
      font-size: 12px;
      color: var(--error-color);
      padding-left: 16px;
    }

    .display-section {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    ha-textfield {
      display: block;
      margin-bottom: 8px;
    }

    ha-formfield {
      display: flex;
      align-items: center;
      padding: 4px 0;
    }

    ha-select {
      width: 100%;
    }
  `;

  constructor() {
    super();
    this._activeTab = 'sources';
  }

  setConfig(config) {
    this._config = {
      entity: 'sensor.f1_officials_race_control',
      show_fia_logo: true,
      min_display_time: 0,
      ...config,
    };
  }

  render() {
    if (!this.hass || !this._config) return html``;

    return html`
      <div class="card-config">
        <div class="tabs">
          <button
            class=${this._activeTab === 'sources' ? 'active' : ''}
            @click=${() => this._activeTab = 'sources'}
          >
            Data Sources
          </button>
          <button
            class=${this._activeTab === 'display' ? 'active' : ''}
            @click=${() => this._activeTab = 'display'}
          >
            Display
          </button>
        </div>

        ${this._activeTab === 'sources'
          ? this._renderDataSourcesTab()
          : this._renderDisplayTab()}
      </div>
    `;
  }

  _renderDataSourcesTab() {
    return html`
      <div class="section">
        <div class="section-header">REQUIRED SENSORS</div>
        ${this._renderEntityPicker(
          'entity',
          'Race Control Sensor',
          'Provides race control messages and decisions',
          true,
          'sensor'
        )}
      </div>
    `;
  }

  _renderDisplayTab() {
    return html`
      <div class="display-section">
        ${this._renderSwitch('show_fia_logo', 'Show FIA logo')}

        <ha-textfield
          .label=${'Min display time per message (seconds)'}
          .value=${String(this._config.min_display_time || 0)}
          type="number"
          min="0"
          max="30"
          @input=${(e) => this._valueChanged('min_display_time', parseInt(e.target.value) || 0)}
        ></ha-textfield>
        <div class="helper">Set to 0 to disable minimum display time</div>
      </div>
    `;
  }

  _renderEntityPicker(name, label, helper, required, domain) {
    const value = this._config[name];
    const showWarning = required && !value;
    const schema = [{ name, label, required, selector: { entity: { domain } } }];

    return html`
      <div class="field">
        <ha-form
          .hass=${this.hass}
          .data=${this._config}
          .schema=${schema}
          .computeLabel=${() => label}
          @value-changed=${this._formValueChanged}
        ></ha-form>
        <div class="helper">${helper}</div>
        ${showWarning ? html`
          <div class="warning">This sensor is required for the card to function</div>
        ` : ''}
      </div>
    `;
  }

  _renderSwitch(name, label, helper = null) {
    const schema = [{ name, label, selector: { boolean: {} } }];
    return html`
      <ha-form
        .hass=${this.hass}
        .data=${this._config}
        .schema=${schema}
        .computeLabel=${() => label}
        @value-changed=${this._formValueChanged}
      ></ha-form>
      ${helper ? html`<div class="helper">${helper}</div>` : ''}
    `;
  }

  _formValueChanged(ev) {
    if (!this._config) return;
    const value = ev.detail?.value || {};
    const newConfig = { ...this._config, ...value };
    this._config = newConfig;
    this.dispatchEvent(new CustomEvent('config-changed', { detail: { config: newConfig } }));
  }

  _valueChanged(name, value) {
    if (!this._config) return;
    const newConfig = { ...this._config, [name]: value };
    this._config = newConfig;
    this.dispatchEvent(new CustomEvent('config-changed', { detail: { config: newConfig } }));
  }
}

if (!customElements.get('f1-sensor-live-data-card')) {
  customElements.define('f1-sensor-live-data-card', F1TyreStatisticsCard);
}

if (!customElements.get('f1-sensor-live-data-card-editor')) {
  customElements.define('f1-sensor-live-data-card-editor', F1TyreStatisticsCardEditor);
}

if (!customElements.get('f1-pitstop-overview-card')) {
  customElements.define('f1-pitstop-overview-card', F1PitStopOverviewCard);
}

if (!customElements.get('f1-pitstop-overview-card-editor')) {
  customElements.define('f1-pitstop-overview-card-editor', F1PitStopOverviewCardEditor);
}

if (!customElements.get('f1-driver-lap-times-card')) {
  customElements.define('f1-driver-lap-times-card', F1DriverLapTimesCard);
}

if (!customElements.get('f1-driver-lap-times-card-editor')) {
  customElements.define('f1-driver-lap-times-card-editor', F1DriverLapTimesCardEditor);
}

if (!customElements.get('f1-championship-prediction-drivers-card')) {
  customElements.define('f1-championship-prediction-drivers-card', F1ChampionshipPredictionDriversCard);
}

if (!customElements.get('f1-championship-prediction-drivers-card-editor')) {
  customElements.define('f1-championship-prediction-drivers-card-editor', F1ChampionshipPredictionDriversCardEditor);
}

if (!customElements.get('f1-championship-prediction-teams-card')) {
  customElements.define('f1-championship-prediction-teams-card', F1ChampionshipPredictionTeamsCard);
}

if (!customElements.get('f1-championship-prediction-teams-card-editor')) {
  customElements.define('f1-championship-prediction-teams-card-editor', F1ChampionshipPredictionTeamsCardEditor);
}

if (!customElements.get('f1-investigations-card')) {
  customElements.define('f1-investigations-card', F1InvestigationsCard);
}

if (!customElements.get('f1-investigations-card-editor')) {
  customElements.define('f1-investigations-card-editor', F1InvestigationsCardEditor);
}

if (!customElements.get('f1-track-limits-card')) {
  customElements.define('f1-track-limits-card', F1TrackLimitsCard);
}

if (!customElements.get('f1-track-limits-card-editor')) {
  customElements.define('f1-track-limits-card-editor', F1TrackLimitsCardEditor);
}

if (!customElements.get('f1-live-session-card')) {
  customElements.define('f1-live-session-card', F1LiveSessionCard);
}

if (!customElements.get('f1-live-session-card-editor')) {
  customElements.define('f1-live-session-card-editor', F1LiveSessionCardEditor);
}

if (!customElements.get('f1-race-control-card')) {
  customElements.define('f1-race-control-card', F1RaceControlCard);
}

if (!customElements.get('f1-race-control-card-editor')) {
  customElements.define('f1-race-control-card-editor', F1RaceControlCardEditor);
}

window.customCards = window.customCards || [];
window.customCards.push({
  type: 'f1-sensor-live-data-card',
  name: 'F1 Tyres Statistics',
  description: 'F1-style tyres statistics with top times and deltas',
  configurable: true,
  preview: true,
});

window.customCards.push({
  type: 'f1-pitstop-overview-card',
  name: 'F1 Pit Stops & Tyres',
  description: 'Live pit stop overview with tyre and stop timing columns',
  configurable: true,
  preview: true,
});

window.customCards.push({
  type: 'f1-driver-lap-times-card',
  name: 'F1 Driver Lap Times',
  description: 'Driver table focused on latest lap times',
  configurable: true,
  preview: true,
});

window.customCards.push({
  type: 'f1-championship-prediction-drivers-card',
  name: 'F1 Championship Prediction Drivers',
  description: 'Live predicted championship standings for drivers',
  configurable: true,
  preview: true,
});

window.customCards.push({
  type: 'f1-championship-prediction-teams-card',
  name: 'F1 Championship Prediction Teams',
  description: 'Live predicted championship standings for constructors',
  configurable: true,
  preview: true,
});

window.customCards.push({
  type: 'f1-investigations-card',
  name: 'F1 Investigations & Penalties',
  description: 'Investigation and penalty tracker grouped by driver',
  configurable: true,
  preview: true,
});

window.customCards.push({
  type: 'f1-track-limits-card',
  name: 'F1 Track Limits',
  description: 'Track limits violations with deletions, warnings, and penalties',
  configurable: true,
  preview: true,
});

window.customCards.push({
  type: 'f1-live-session-card',
  name: 'F1 Live Session Status',
  description: 'Live session status bar with weather, track status, and lap progress',
  configurable: true,
  preview: true,
});

window.customCards.push({
  type: 'f1-race-control-card',
  name: 'F1 Race Control',
  description: 'Race control message banner with FIA styling',
  configurable: true,
  preview: true,
});
